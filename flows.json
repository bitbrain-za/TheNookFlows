[
    {
        "id": "62f232c2.0dd08c",
        "type": "tab",
        "label": "General",
        "disabled": false,
        "info": ""
    },
    {
        "id": "152554cc.389edb",
        "type": "tab",
        "label": "Coffee Table",
        "disabled": false,
        "info": ""
    },
    {
        "id": "86a3c02f.3051a",
        "type": "tab",
        "label": "Bedroom",
        "disabled": false,
        "info": ""
    },
    {
        "id": "3788fae5.b038d6",
        "type": "tab",
        "label": "Lounge",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b50f3595.0e3a28",
        "type": "tab",
        "label": "Lights",
        "disabled": false,
        "info": ""
    },
    {
        "id": "ef54a0c2.e259d",
        "type": "tab",
        "label": "Spotify",
        "disabled": false,
        "info": ""
    },
    {
        "id": "5e97ea24.516424",
        "type": "tab",
        "label": "Garden",
        "disabled": false,
        "info": ""
    },
    {
        "id": "fa310ecb.c84eb",
        "type": "tab",
        "label": "Test",
        "disabled": false,
        "info": ""
    },
    {
        "id": "796da880.c06928",
        "type": "tab",
        "label": "Telegram",
        "disabled": false,
        "info": ""
    },
    {
        "id": "dfa48b6f.2ff088",
        "type": "tab",
        "label": "Printer",
        "disabled": false,
        "info": ""
    },
    {
        "id": "2c8f60c4.cfd28",
        "type": "tab",
        "label": "System",
        "disabled": false,
        "info": ""
    },
    {
        "id": "f2e45804.48caf8",
        "type": "tab",
        "label": "Cameras",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b2e43c1e.1d392",
        "type": "tab",
        "label": "Load shedding",
        "disabled": false,
        "info": ""
    },
    {
        "id": "838c179aeb2a8be9",
        "type": "tab",
        "label": "25B",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "8efb2399.f1af9",
        "type": "subflow",
        "name": "Play On Google Home",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 80,
                "y": 80,
                "wires": [
                    {
                        "id": "3a88dc46.74acb4"
                    }
                ]
            }
        ],
        "out": [],
        "env": []
    },
    {
        "id": "81d9975e.584f98",
        "type": "subflow",
        "name": "MES",
        "info": "",
        "category": "The Nook",
        "in": [],
        "out": [],
        "env": [],
        "icon": "node-red-contrib-cast/home.svg"
    },
    {
        "id": "4a06737d.008a7c",
        "type": "subflow",
        "name": "All AC Off",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 460,
                "y": 300,
                "wires": [
                    {
                        "id": "cff4a041.4964"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "icon": "font-awesome/fa-snowflake-o"
    },
    {
        "id": "8ed72877.93bc38",
        "type": "subflow",
        "name": "Peripheral Lights Off",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 220,
                "y": 200,
                "wires": [
                    {
                        "id": "757620d3.73d4"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "icon": "node-red/light.png"
    },
    {
        "id": "a436e8cb.527cf8",
        "type": "subflow",
        "name": "Toggle Lounge AC",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 180,
                "y": 160,
                "wires": [
                    {
                        "id": "b467c84c.4dc468"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "icon": "font-awesome/fa-snowflake-o"
    },
    {
        "id": "54c86189.6415",
        "type": "subflow",
        "name": "Brightness wrt Time",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 240,
                "y": 140,
                "wires": [
                    {
                        "id": "5dbcd079.75d08"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1020,
                "y": 140,
                "wires": [
                    {
                        "id": "6946092c.681c38",
                        "port": 0
                    },
                    {
                        "id": "5a591dcf.255824",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "icon": "node-red/light.png"
    },
    {
        "id": "34311fcd.cea24",
        "type": "subflow",
        "name": "Brightness Bedtime & Sun",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 240,
                "y": 240,
                "wires": [
                    {
                        "id": "5518df27.0ef46"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1360,
                "y": 340,
                "wires": [
                    {
                        "id": "9a09c277.b010d",
                        "port": 0
                    },
                    {
                        "id": "59476d48.5e9b54",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1360,
                "y": 440,
                "wires": [
                    {
                        "id": "a9f78513.321758",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "inputLabels": [
            "Trigger"
        ],
        "outputLabels": [
            "On",
            "Off"
        ],
        "icon": "node-red/light.png"
    },
    {
        "id": "ca5a8b67.211fb8",
        "type": "subflow",
        "name": "Bedtime Lights",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 260,
                "y": 300,
                "wires": [
                    {
                        "id": "101919ec.aec916"
                    },
                    {
                        "id": "c4d56b4d.33ac08"
                    },
                    {
                        "id": "b911b839.71bbe8"
                    },
                    {
                        "id": "e46c9b84.60b878"
                    },
                    {
                        "id": "2ba746ae.0bb31a"
                    },
                    {
                        "id": "9f797a10.cb3098"
                    },
                    {
                        "id": "ee2bfb22.e00998"
                    },
                    {
                        "id": "13bb130.00407ed"
                    },
                    {
                        "id": "b3b69e46.12a6d"
                    },
                    {
                        "id": "9a6bc8a0.24d868"
                    },
                    {
                        "id": "5bb0ed45.71d3d4"
                    },
                    {
                        "id": "25b91eb1.c45162"
                    },
                    {
                        "id": "23a6af63.ff153"
                    },
                    {
                        "id": "702628b4.c2b938"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 860,
                "y": 400,
                "wires": [
                    {
                        "id": "c22f4207.123ec",
                        "port": 0
                    },
                    {
                        "id": "5fece0df.00b57",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99",
        "icon": "font-awesome/fa-bed"
    },
    {
        "id": "8e0a986b.ca0ef8",
        "type": "subflow",
        "name": "Lounge Warm",
        "info": "",
        "category": "Scenes",
        "in": [
            {
                "x": 220,
                "y": 140,
                "wires": [
                    {
                        "id": "f7909cea.9905b"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "color": "#3FADB5",
        "icon": "font-awesome/fa-fire"
    },
    {
        "id": "8b2696b9.77c108",
        "type": "subflow",
        "name": "Lounge Bright",
        "info": "",
        "category": "Scenes",
        "in": [
            {
                "x": 160,
                "y": 200,
                "wires": [
                    {
                        "id": "e3169abf.7a4a98"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "color": "#3FADB5",
        "icon": "node-red/light.svg"
    },
    {
        "id": "f39f57bd.f82a58",
        "type": "subflow",
        "name": "Lounge Medium",
        "info": "",
        "category": "Scenes",
        "in": [
            {
                "x": 120,
                "y": 200,
                "wires": [
                    {
                        "id": "da8ae703.da5a18"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "color": "#3FADB5",
        "icon": "node-red/white-globe.svg"
    },
    {
        "id": "ecfae70d.6fd868",
        "type": "subflow",
        "name": "CR10S",
        "info": "# payload\r\n\r\n---\r\n\r\n\r\n## _light_\r\n\r\n### on\r\nTurns on the light\r\n### off\r\nTurns off the light\r\n### toggle\r\nToggles the light\r\n\r\n---\r\n\r\n## _printer_\r\n\r\n### on\r\nTurns on the light\r\n### off\r\nTurns off the light\r\n### toggle\r\nToggles the light",
        "category": "",
        "in": [
            {
                "x": 116,
                "y": 161,
                "wires": [
                    {
                        "id": "cefb4002.553d3"
                    }
                ]
            }
        ],
        "out": [],
        "env": [
            {
                "name": "api_key",
                "type": "str",
                "value": ""
            },
            {
                "name": "ip",
                "type": "str",
                "value": ""
            }
        ],
        "color": "#3FADB5",
        "icon": "font-awesome/fa-print"
    },
    {
        "id": "32fd502d52a4fa0c",
        "type": "subflow",
        "name": "Bedroom Light Toggle",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 200,
                "y": 280,
                "wires": [
                    {
                        "id": "b0b7897ef85f73ec"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#E6E0F8",
        "icon": "node-red/light.svg"
    },
    {
        "id": "a6ce77f172d194a1",
        "type": "subflow",
        "name": "Night Light Filter",
        "info": "",
        "category": "The Nook",
        "in": [
            {
                "x": 180,
                "y": 180,
                "wires": [
                    {
                        "id": "ba7ccfb8ae22e3c9"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 780,
                "y": 120,
                "wires": [
                    {
                        "id": "a9c7a6fd9ff4e4dd",
                        "port": 0
                    },
                    {
                        "id": "273ae82b51b225e8",
                        "port": 0
                    }
                ]
            },
            {
                "x": 780,
                "y": 240,
                "wires": [
                    {
                        "id": "1365cdbb003ada2b",
                        "port": 0
                    },
                    {
                        "id": "d34a803afefb9930",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#FFF0F0",
        "outputLabels": [
            "Tasmota",
            "Xiaomi"
        ]
    },
    {
        "id": "aacfc38c8117669a",
        "type": "subflow",
        "name": "Parse Discovery",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 180,
                "y": 180,
                "wires": [
                    {
                        "id": "5a2839ca1e326e49"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1060,
                "y": 160,
                "wires": [
                    {
                        "id": "437b63bc588263c9",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#8080FF",
        "inputLabels": [
            "Raw Buffer"
        ],
        "outputLabels": [
            "25B Discovery Info"
        ],
        "icon": "node-red/bridge.svg"
    },
    {
        "id": "e5bb55137891a2c8",
        "type": "subflow",
        "name": "Configuration Lookup",
        "info": "## Key Options:\n\n - mqtt\n - SYSTEM_CONFIGURATION\n - READER_MODE_AUTHENTICATION\n - FINGERPRINT_SENSOR\n - READER_SETTINGS\n - GLOBAL_M2M_TOPIC\n - SERVICES\n - LOCKDOWN\n - HOSTCONTROL\n - properties\n - version",
        "category": "25B",
        "in": [
            {
                "x": 360,
                "y": 200,
                "wires": [
                    {
                        "id": "6d4984a681107e87"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1080,
                "y": 200,
                "wires": [
                    {
                        "id": "d7f40d11886a23c1",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "key",
                "type": "str",
                "value": "SYSTEM_CONFIGURATION",
                "ui": {
                    "type": "select",
                    "opts": {
                        "opts": [
                            {
                                "l": {
                                    "en-US": "mqtt"
                                },
                                "v": "mqtt"
                            },
                            {
                                "l": {
                                    "en-US": "System"
                                },
                                "v": "SYSTEM_CONFIGURATION"
                            },
                            {
                                "l": {
                                    "en-US": "Authentication Mode"
                                },
                                "v": "READER_MODE_AUTHENTICATION"
                            },
                            {
                                "l": {
                                    "en-US": "Fingerprint Sensor"
                                },
                                "v": "FINGERPRINT_SENSOR"
                            },
                            {
                                "l": {
                                    "en-US": "Reader Settings"
                                },
                                "v": "READER_SETTINGS"
                            },
                            {
                                "l": {
                                    "en-US": "Global M2M topic"
                                },
                                "v": "GLOBAL_M2M_TOPIC"
                            },
                            {
                                "l": {
                                    "en-US": "Services"
                                },
                                "v": "SERVICES"
                            },
                            {
                                "l": {
                                    "en-US": "Lockdown"
                                },
                                "v": "LOCKDOWN"
                            },
                            {
                                "l": {
                                    "en-US": "Host Control"
                                },
                                "v": "HOSTCONTROL"
                            },
                            {
                                "l": {
                                    "en-US": "Properties"
                                },
                                "v": "properties"
                            },
                            {
                                "l": {
                                    "en-US": "Version"
                                },
                                "v": "version"
                            }
                        ]
                    }
                }
            },
            {
                "name": "response topic",
                "type": "str",
                "value": "response"
            }
        ],
        "meta": {
            "module": "Configuration Lookup",
            "author": "phil",
            "desc": "Lookups a key on the 25B"
        },
        "color": "#8080FF",
        "icon": "node-red/watch.svg"
    },
    {
        "id": "ada279a395cd9594",
        "type": "subflow",
        "name": "Set Auth Mode",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 200,
                "y": 160,
                "wires": [
                    {
                        "id": "88db07a2fd609dea"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 680,
                "y": 160,
                "wires": [
                    {
                        "id": "4dd0cae30fff9dc5",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "mode",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-unlock",
                    "type": "select",
                    "opts": {
                        "opts": [
                            {
                                "l": {
                                    "en-US": "Template on Card"
                                },
                                "v": "ONE_TO_ONE_TEMPLATE_ON_CARD"
                            },
                            {
                                "l": {
                                    "en-US": "Template on Device"
                                },
                                "v": "ONE_TO_ONE_TEMPLATE_ON_DEVICE"
                            },
                            {
                                "l": {
                                    "en-US": "Finger Only"
                                },
                                "v": "ONE_TO_N"
                            },
                            {
                                "l": {
                                    "en-US": "Card Only"
                                },
                                "v": "CARD_ONLY"
                            },
                            {
                                "l": {
                                    "en-US": "Card or Finger"
                                },
                                "v": "ONE_TO_N_OR_CARD_ONLY"
                            }
                        ]
                    }
                }
            }
        ],
        "meta": {},
        "color": "#8080FF",
        "icon": "font-awesome/fa-unlock"
    },
    {
        "id": "ef28203219c5f3e6",
        "type": "subflow",
        "name": "Write Config",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 320,
                "y": 280,
                "wires": [
                    {
                        "id": "ed17865cbbcb1f75"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1030,
                "y": 280,
                "wires": [
                    {
                        "id": "805a21bf6d823e10",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "key",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-key",
                    "type": "select",
                    "opts": {
                        "opts": [
                            {
                                "l": {
                                    "en-US": "MQTT"
                                },
                                "v": "mqtt"
                            },
                            {
                                "l": {
                                    "en-US": "System Config"
                                },
                                "v": "SYSTEM_CONFIGURATION"
                            },
                            {
                                "l": {
                                    "en-US": "Authentication Mode"
                                },
                                "v": "READER_MODE_AUTHENTICATION"
                            },
                            {
                                "l": {
                                    "en-US": "Fingerprint Sensor"
                                },
                                "v": "FINGERPRINT_SENSOR"
                            },
                            {
                                "l": {
                                    "en-US": "Reader Settings"
                                },
                                "v": "READER_SETTINGS"
                            },
                            {
                                "l": {
                                    "en-US": "Global M2M Topic"
                                },
                                "v": "GLOBAL_M2M_TOPIC"
                            },
                            {
                                "l": {
                                    "en-US": "Services"
                                },
                                "v": "SERVICES"
                            },
                            {
                                "l": {
                                    "en-US": "Lockdown"
                                },
                                "v": "LOCKDOWN"
                            },
                            {
                                "l": {
                                    "en-US": "Host Control"
                                },
                                "v": "HOSTCONTROL"
                            },
                            {
                                "l": {
                                    "en-US": "Properties"
                                },
                                "v": "properties"
                            },
                            {
                                "l": {
                                    "en-US": "Version"
                                },
                                "v": "version"
                            }
                        ]
                    }
                }
            },
            {
                "name": "value",
                "type": "json",
                "value": ""
            }
        ],
        "meta": {
            "module": "Write Config Message"
        },
        "color": "#8080FF"
    },
    {
        "id": "a7b7c383c56a3f2d",
        "type": "subflow",
        "name": "Reboot",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 140,
                "y": 260,
                "wires": [
                    {
                        "id": "2ea7d18b12b8529e"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 860,
                "y": 260,
                "wires": [
                    {
                        "id": "6dd32e673f1c4afd",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            }
        ],
        "meta": {},
        "color": "#8080FF",
        "icon": "font-awesome/fa-power-off"
    },
    {
        "id": "52270a6ff896cf61",
        "type": "subflow",
        "name": "Finger DB Reset",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 320,
                "y": 240,
                "wires": [
                    {
                        "id": "b67864742e7e6b70"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1040,
                "y": 240,
                "wires": [
                    {
                        "id": "9cebd1c31d2fe682",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "database",
                "type": "str",
                "value": "",
                "ui": {
                    "type": "select",
                    "opts": {
                        "opts": [
                            {
                                "l": {
                                    "en-US": "PACS"
                                },
                                "v": "PACS"
                            },
                            {
                                "l": {
                                    "en-US": "Master"
                                },
                                "v": "MASTER"
                            }
                        ]
                    }
                }
            }
        ],
        "meta": {},
        "color": "#8080FF",
        "icon": "font-awesome/fa-hand-o-up"
    },
    {
        "id": "27041614d0046a67",
        "type": "subflow",
        "name": "Capture",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 140,
                "y": 160,
                "wires": [
                    {
                        "id": "4e4394f28a2c9ffe"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 920,
                "y": 160,
                "wires": [
                    {
                        "id": "14f20d7a9cd4027e",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "response topic",
                "type": "str",
                "value": "response/template"
            },
            {
                "name": "id",
                "type": "str",
                "value": ""
            },
            {
                "name": "finger",
                "type": "str",
                "value": "",
                "ui": {
                    "type": "select",
                    "opts": {
                        "opts": [
                            {
                                "l": {
                                    "en-US": "Left Thumb"
                                },
                                "v": "LEFT_THUMB"
                            },
                            {
                                "l": {
                                    "en-US": "Left Index Finger"
                                },
                                "v": "LEFT_INDEX_FINGER"
                            },
                            {
                                "l": {
                                    "en-US": "Left Middle Finger"
                                },
                                "v": "LEFT_MIDDLE_FINGER"
                            },
                            {
                                "l": {
                                    "en-US": "Left Ring Finger"
                                },
                                "v": "LEFT_RING_FINGER"
                            },
                            {
                                "l": {
                                    "en-US": "Lefft Little Finger"
                                },
                                "v": "LEFT_LITTLE_FINGER"
                            },
                            {
                                "l": {
                                    "en-US": "Right Thumb"
                                },
                                "v": "RIGHT_THUMB"
                            },
                            {
                                "l": {
                                    "en-US": "Right Index Finger"
                                },
                                "v": "RIGHT_INDEX_FINGER"
                            },
                            {
                                "l": {
                                    "en-US": "Right Middle Finger"
                                },
                                "v": "RIGHT_MIDDLE_FINGER"
                            },
                            {
                                "l": {
                                    "en-US": "Right Ring Finger"
                                },
                                "v": "RIGHT_RING_FINGER"
                            },
                            {
                                "l": {
                                    "en-US": "Right Little Finger"
                                },
                                "v": "RIGHT_LITTLE_FINGER"
                            }
                        ]
                    }
                }
            }
        ],
        "meta": {},
        "color": "#8080FF",
        "icon": "font-awesome/fa-hand-o-down"
    },
    {
        "id": "3dbcea1231ae029d",
        "type": "subflow",
        "name": "Retrieve Events",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 160,
                "y": 260,
                "wires": [
                    {
                        "id": "84f24d56971a8a1f"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 840,
                "y": 260,
                "wires": [
                    {
                        "id": "7d1e3061ce3c7f9e",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "count",
                "type": "num",
                "value": "100"
            }
        ],
        "meta": {},
        "color": "#8080Ff",
        "icon": "node-red/comment.svg"
    },
    {
        "id": "eae3302d5c488f43",
        "type": "subflow",
        "name": "Delete Event",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 300,
                "y": 140,
                "wires": [
                    {
                        "id": "3f4646a1cbc978c0"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1000,
                "y": 140,
                "wires": [
                    {
                        "id": "9b17e5e05895274f",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "eventId",
                "type": "num",
                "value": "0"
            }
        ],
        "meta": {},
        "color": "#8080ff",
        "icon": "font-awesome/fa-trash"
    },
    {
        "id": "4cb55b245fd49718",
        "type": "subflow",
        "name": "Upload Template",
        "info": "# Template Format\n\n{\n  \"id\": \"user id\",\n  \"finger\": \"RIGHT_INDEX_FINGER\",\n  \"template\": []\n}\n\nFinger Options\n - RIGHT_THUMB\n - RIGHT_INDEX_FINGER\n - RIGHT_MIDDLE_FINGER\n - RIGHT_RING_FINGER\n - RIGHT_LITTLE_FINGER\n - LEFT_THUMB\n - LEFT_INDEX_FINGER\n - LEFT_MIDDLE_FINGER\n - LEFT_RING_FINGER\n - LEFT_LITTLE_FINGER",
        "category": "25B",
        "in": [
            {
                "x": 180,
                "y": 220,
                "wires": [
                    {
                        "id": "d8568e1440795f4e"
                    },
                    {
                        "id": "934a1c594e47a1be"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 800,
                "y": 200,
                "wires": [
                    {
                        "id": "4d467bdfd0caf350",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 240,
                "wires": [
                    {
                        "id": "e5a4e684eeafca46",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "response topic",
                "type": "str",
                "value": "response"
            },
            {
                "name": "duress",
                "type": "bool",
                "value": "false"
            }
        ],
        "meta": {},
        "color": "#8080FF",
        "outputLabels": [
            "Delete Template Message",
            "Upload Template Message"
        ],
        "icon": "font-awesome/fa-handshake-o"
    },
    {
        "id": "5fd2a5bb3c38e382",
        "type": "subflow",
        "name": "Read Card",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 180,
                "y": 220,
                "wires": [
                    {
                        "id": "53b61995886caad7"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 780,
                "y": 220,
                "wires": [
                    {
                        "id": "e52808d6315deed8",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "response topic",
                "type": "str",
                "value": "response/card/read"
            },
            {
                "name": "timeout",
                "type": "num",
                "value": "30"
            }
        ],
        "meta": {},
        "color": "#8080ff",
        "icon": "font-awesome/fa-address-card-o"
    },
    {
        "id": "2dc484a32dc07a73",
        "type": "subflow",
        "name": "Enroll User",
        "info": "\n{\n    \"id\":1,\n    \"surname\":\"Barlow\"\n    \"firstname\":\"Philip\",\n    \"cardNumber\":\"252\",\n    \"pacsData\":\"000004CB\",\n}",
        "category": "25B",
        "in": [
            {
                "x": 280,
                "y": 320,
                "wires": [
                    {
                        "id": "bc62b31070a30d04"
                    },
                    {
                        "id": "2998fa81f6a91a97"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 960,
                "y": 280,
                "wires": [
                    {
                        "id": "de6415e0c2e51726",
                        "port": 0
                    }
                ]
            },
            {
                "x": 960,
                "y": 380,
                "wires": [
                    {
                        "id": "6b920ef655c98526",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "id",
                "type": "num",
                "value": ""
            },
            {
                "name": "pacsData",
                "type": "str",
                "value": ""
            },
            {
                "name": "cardNumber",
                "type": "str",
                "value": ""
            },
            {
                "name": "response topic",
                "type": "str",
                "value": "response"
            }
        ],
        "meta": {},
        "color": "#8080ff",
        "outputLabels": [
            "Delete Card",
            "Enroll Card"
        ],
        "icon": "font-awesome/fa-vcard"
    },
    {
        "id": "fbc8c94e94125ace",
        "type": "subflow",
        "name": "Create User",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 380,
                "y": 280,
                "wires": [
                    {
                        "id": "059c3737bed8523a"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 960,
                "y": 280,
                "wires": [
                    {
                        "id": "1dc97a33c8f3c933",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": ""
            },
            {
                "name": "surname",
                "type": "str",
                "value": ""
            },
            {
                "name": "id",
                "type": "num",
                "value": "123"
            }
        ],
        "meta": {},
        "color": "#8080ff",
        "icon": "font-awesome/fa-user-o"
    },
    {
        "id": "4d21ef95f85fa8fe",
        "type": "subflow",
        "name": "Set Schedule",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 260,
                "y": 220,
                "wires": [
                    {
                        "id": "e949255cd98819e3"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 900,
                "y": 220,
                "wires": [
                    {
                        "id": "156033753981cf75",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "mac",
                "type": "str",
                "value": ""
            },
            {
                "name": "response topic",
                "type": "str",
                "value": "response"
            },
            {
                "name": "identifier",
                "type": "str",
                "value": "1"
            },
            {
                "name": "name",
                "type": "str",
                "value": "Default Schedule"
            },
            {
                "name": "monday",
                "type": "bool",
                "value": "true",
                "ui": {
                    "type": "checkbox"
                }
            },
            {
                "name": "tuesday",
                "type": "bool",
                "value": "true",
                "ui": {
                    "type": "checkbox"
                }
            },
            {
                "name": "wednesday",
                "type": "bool",
                "value": "true",
                "ui": {
                    "type": "checkbox"
                }
            },
            {
                "name": "thrusday",
                "type": "bool",
                "value": "true",
                "ui": {
                    "type": "checkbox"
                }
            },
            {
                "name": "friday",
                "type": "bool",
                "value": "true",
                "ui": {
                    "type": "checkbox"
                }
            },
            {
                "name": "saturday",
                "type": "bool",
                "value": "true",
                "ui": {
                    "type": "checkbox"
                }
            },
            {
                "name": "sunday",
                "type": "bool",
                "value": "true",
                "ui": {
                    "type": "checkbox"
                }
            },
            {
                "name": "start time",
                "type": "str",
                "value": "00:00"
            },
            {
                "name": "duration",
                "type": "num",
                "value": "1440"
            },
            {
                "name": "start date",
                "type": "str",
                "value": "01-01-21"
            },
            {
                "name": "end date",
                "type": "str",
                "value": "31-12-22"
            }
        ],
        "meta": {},
        "color": "#8080FF",
        "icon": "font-awesome/fa-calendar"
    },
    {
        "id": "9839085e54c4764c",
        "type": "subflow",
        "name": "Fetch Public Key",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 100,
                "y": 240,
                "wires": [
                    {
                        "id": "39e331dd928ff3bc"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1560,
                "y": 220,
                "wires": [
                    {
                        "id": "ddf9886f5e51b310",
                        "port": 0
                    }
                ]
            },
            {
                "x": 420,
                "y": 300,
                "wires": [
                    {
                        "id": "39e331dd928ff3bc",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "device",
                "type": "str",
                "value": "RB25F-00068E101063"
            }
        ],
        "meta": {},
        "color": "#8080ff",
        "icon": "font-awesome/fa-key"
    },
    {
        "id": "38e6f5c55d11c778",
        "type": "subflow",
        "name": "Fetch Device",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 420,
                "y": 260,
                "wires": [
                    {
                        "id": "80253ac3f55b3ed2"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1080,
                "y": 240,
                "wires": [
                    {
                        "id": "1851b53852c462e2",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1080,
                "y": 300,
                "wires": [
                    {
                        "id": "1851b53852c462e2",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "device",
                "type": "str",
                "value": "RB25F-00068E101063"
            }
        ],
        "meta": {},
        "color": "#00B0FF",
        "icon": "node-red-contrib-home-assistant-websocket/ha-call-service.svg"
    },
    {
        "id": "01e46596931945f1",
        "type": "subflow",
        "name": "Reset DB",
        "info": "",
        "category": "25B",
        "in": [
            {
                "x": 380,
                "y": 260,
                "wires": [
                    {
                        "id": "1d89dabb4e64cccb"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1560,
                "y": 260,
                "wires": [
                    {
                        "id": "cbf4105933dc0dac",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "device",
                "type": "str",
                "value": "RB25F-00068E101063"
            }
        ],
        "meta": {},
        "color": "#00B0FF",
        "icon": "node-red/db.svg"
    },
    {
        "id": "7d575fd3.be153",
        "type": "server",
        "name": "Home Assistant",
        "version": 2,
        "rejectUnauthorizedCerts": true,
        "ha_boolean": "y|yes|true|on|home|open",
        "connectionDelay": true,
        "cacheJson": true,
        "heartbeat": false,
        "heartbeatInterval": 30
    },
    {
        "id": "5bf8ed86.6f1f24",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "2eafe4c0.b7da5c",
        "type": "mqtt-broker",
        "name": "hassio",
        "broker": "192.168.1.32",
        "port": "10883",
        "clientid": "node_red",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "f9e8d117.9aabc",
        "type": "ui_group",
        "name": "Group 1",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "4938713b.f73e5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "f9e8d117.9aabc",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "7bee2da5.7b1c14",
        "type": "eiscp-controller",
        "name": "Onkyo",
        "host": "192.168.1.31",
        "port": "60128",
        "model": "TX-NR575E"
    },
    {
        "id": "b2774519.2ee368",
        "type": "telegrambot-config",
        "botname": "Home",
        "usernames": "",
        "chatIds": "-257391012",
        "pollInterval": "300"
    },
    {
        "id": "b5dd546c.68b1b8",
        "type": "telegrambot-config",
        "botname": "Test Bot",
        "usernames": "",
        "chatIds": "-257391012",
        "pollInterval": "300"
    },
    {
        "id": "997ea59b.693238",
        "type": "telegrambot-config",
        "botname": "Garden Bot",
        "usernames": "",
        "chatIds": "-257391012",
        "pollInterval": "300"
    },
    {
        "id": "cf16b2fa.ceee4",
        "type": "telegrambot-config",
        "botname": "BatteryBot",
        "usernames": "",
        "chatIds": "-257391012",
        "pollInterval": "300"
    },
    {
        "id": "43bf985d.fa0f08",
        "type": "spotify-auth",
        "name": "Spotify OAuth2",
        "scope": "ugc-image-upload\nuser-read-recently-played\nuser-read-playback-state\nuser-top-read\napp-remote-control\nplaylist-modify-public\nuser-modify-playback-state\nplaylist-modify-private\nuser-follow-modify\nuser-read-currently-playing\nuser-follow-read\nuser-library-modify\nuser-read-playback-position\nplaylist-read-private\nuser-read-email\nuser-read-private\nuser-library-read\nplaylist-read-collaborative\nstreaming"
    },
    {
        "id": "e51ac803.94beb8",
        "type": "telegrambot-config",
        "botname": "Pritner Bot",
        "usernames": "",
        "chatIds": "532693134",
        "pollInterval": "300"
    },
    {
        "id": "9f763d6f05105379",
        "type": "firebaseCertificate",
        "firebaseurl": "thenook-14c17-default-rtdb",
        "loginType": "jwt"
    },
    {
        "id": "cb698e84.66564",
        "type": "cast-to-client",
        "z": "8efb2399.f1af9",
        "name": "",
        "url": "",
        "contentType": "",
        "message": "",
        "language": "en",
        "ip": "",
        "port": "",
        "volume": "100",
        "x": 550,
        "y": 80,
        "wires": [
            [
                "936fad8c.17f24"
            ]
        ],
        "icon": "node-red-contrib-cast/home.png"
    },
    {
        "id": "545f3a7e.cf5f84",
        "type": "change",
        "z": "8efb2399.f1af9",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "ip",
                "pt": "msg",
                "to": "192.168.1.27",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "message",
                "pt": "msg",
                "to": "music",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "language",
                "pt": "msg",
                "to": "En-gb",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 80,
        "wires": [
            [
                "cb698e84.66564"
            ]
        ]
    },
    {
        "id": "a796fca6.d858c",
        "type": "api-call-service",
        "z": "8efb2399.f1af9",
        "name": "Select Source",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "select_source",
        "entityId": "media_player.spotify",
        "data": "{\"source\":\"bedroom_speaker\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 940,
        "y": 80,
        "wires": [
            [
                "21aad61.9a6152a"
            ]
        ]
    },
    {
        "id": "778151c5.49c37",
        "type": "api-call-service",
        "z": "8efb2399.f1af9",
        "name": "Play Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "play_media",
        "entityId": "media_player.spotify",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1290,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "936fad8c.17f24",
        "type": "change",
        "z": "8efb2399.f1af9",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 80,
        "wires": [
            [
                "a796fca6.d858c"
            ]
        ]
    },
    {
        "id": "21aad61.9a6152a",
        "type": "function",
        "z": "8efb2399.f1af9",
        "name": "Format",
        "func": "var uri = flow.get(\"uri\")\n\nmsg.payload = \n{\n    data:\n    {\n        \"media_content_type\":\"playlist\",\n        \"media_content_id\":uri\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1120,
        "y": 80,
        "wires": [
            [
                "778151c5.49c37"
            ]
        ]
    },
    {
        "id": "3a88dc46.74acb4",
        "type": "function",
        "z": "8efb2399.f1af9",
        "name": "Save URI",
        "func": "flow.set(\"uri\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "545f3a7e.cf5f84"
            ]
        ]
    },
    {
        "id": "56cec2d4.56edfc",
        "type": "server-state-changed",
        "z": "81d9975e.584f98",
        "name": "MES Light",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "light.mes",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 160,
        "wires": [
            [
                "861ac36d.9e22e",
                "444dffde.77514"
            ],
            [
                "a8804900.221418",
                "b512568f.0c0e38"
            ]
        ]
    },
    {
        "id": "861ac36d.9e22e",
        "type": "stoptimer",
        "z": "81d9975e.584f98",
        "duration": "150",
        "units": "Second",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 450,
        "y": 60,
        "wires": [
            [
                "ebae9abe.517ec8"
            ],
            []
        ]
    },
    {
        "id": "32aa9536.b7091a",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_on",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 850,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "ebae9abe.517ec8",
        "type": "api-current-state",
        "z": "81d9975e.584f98",
        "name": "Light On?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.mes",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 640,
        "y": 60,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "a8804900.221418",
        "type": "stoptimer",
        "z": "81d9975e.584f98",
        "duration": "3",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 440,
        "y": 260,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "9073ec08.dfc67",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_off",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 650,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "b512568f.0c0e38",
        "type": "function",
        "z": "81d9975e.584f98",
        "name": "Stop",
        "func": "msg.payload = \"STOP\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 370,
        "y": 140,
        "wires": [
            [
                "861ac36d.9e22e"
            ]
        ]
    },
    {
        "id": "444dffde.77514",
        "type": "function",
        "z": "81d9975e.584f98",
        "name": "Stop",
        "func": "msg.payload = \"STOP\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 370,
        "y": 180,
        "wires": [
            [
                "a8804900.221418"
            ]
        ]
    },
    {
        "id": "60108002.8a7e4",
        "type": "api-current-state",
        "z": "81d9975e.584f98",
        "name": "Extractor On?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "switch.mes_extractor",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1000,
        "y": 640,
        "wires": [
            [
                "8253368b.5fc958",
                "296317f9.c2a588"
            ],
            [
                "88a41310.4cc51",
                "f6a195f64e0f6cb2"
            ]
        ]
    },
    {
        "id": "8253368b.5fc958",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.mes",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1360,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "296317f9.c2a588",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_off",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1350,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "5ca54b22.c636c4",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Light On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.mes",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1540,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "88a41310.4cc51",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_on",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1350,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "51d13bad.2e4d14",
        "type": "stoptimer",
        "z": "81d9975e.584f98",
        "duration": "2",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 740,
        "y": 500,
        "wires": [
            [
                "19d4c63a.ced0da"
            ],
            []
        ]
    },
    {
        "id": "19d4c63a.ced0da",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.mes",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 980,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "ae9b0c69.199fe",
        "type": "change",
        "z": "81d9975e.584f98",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 440,
        "wires": [
            [
                "e37f2af487703149"
            ]
        ]
    },
    {
        "id": "fd7516e6.d64e58",
        "type": "change",
        "z": "81d9975e.584f98",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 640,
        "wires": [
            [
                "60108002.8a7e4"
            ]
        ]
    },
    {
        "id": "76546b79.0445d4",
        "type": "api-current-state",
        "z": "81d9975e.584f98",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "75",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.mes_humidity",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 560,
        "y": 960,
        "wires": [
            [
                "4275ecf.81b4714"
            ],
            [
                "5aeb9299.b8c6fc"
            ]
        ]
    },
    {
        "id": "71209cbd.723804",
        "type": "inject",
        "z": "81d9975e.584f98",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "240",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 960,
        "wires": [
            [
                "76546b79.0445d4"
            ]
        ]
    },
    {
        "id": "4275ecf.81b4714",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_on",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 820,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "5aeb9299.b8c6fc",
        "type": "api-current-state",
        "z": "81d9975e.584f98",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "70",
        "halt_if_type": "num",
        "halt_if_compare": "lt",
        "entity_id": "sensor.mes_humidity",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 890,
        "y": 1000,
        "wires": [
            [
                "5e9aac01.4e0394"
            ],
            []
        ]
    },
    {
        "id": "5e9aac01.4e0394",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_off",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1140,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "73f43e95f8b57cf6",
        "type": "api-current-state",
        "z": "81d9975e.584f98",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "75",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.bedroom_climate_humidity",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 580,
        "y": 1060,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "0f1de6d6e400f66f",
        "type": "inject",
        "z": "81d9975e.584f98",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "240",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 210,
        "y": 1160,
        "wires": [
            [
                "28490f9ed8a41069"
            ]
        ]
    },
    {
        "id": "28490f9ed8a41069",
        "type": "api-current-state",
        "z": "81d9975e.584f98",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "75",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.bedroom_climate_humidity",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "bedroom",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 500,
        "y": 1160,
        "wires": [
            [
                "3b978ddb9e5b438e"
            ],
            []
        ]
    },
    {
        "id": "3b978ddb9e5b438e",
        "type": "api-current-state",
        "z": "81d9975e.584f98",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "75",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.mes_humidity",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "mes",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 860,
        "y": 1160,
        "wires": [
            [
                "c4e3752881bd2062"
            ],
            []
        ]
    },
    {
        "id": "c4e3752881bd2062",
        "type": "function",
        "z": "81d9975e.584f98",
        "name": "",
        "func": "if((parseFloat(msg.bedroom) + 5) < parseFloat(msg.mes))\n{\n    msg.state = \"on\";\n    return [msg, null];\n}\n\nmsg.state = \"off\"\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1110,
        "y": 1160,
        "wires": [
            [
                "8b5ac6d81ac546b1"
            ],
            [
                "ec58b2dc6a08301c"
            ]
        ]
    },
    {
        "id": "8b5ac6d81ac546b1",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_on",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1270,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "579a4052810e2e27",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Extractor Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "switch",
        "service": "turn_off",
        "entityId": "switch.mes_extractor",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1470,
        "y": 1240,
        "wires": [
            []
        ]
    },
    {
        "id": "ec58b2dc6a08301c",
        "type": "function",
        "z": "81d9975e.584f98",
        "name": "",
        "func": "if((parseFloat(msg.bedroom) + 4) < parseFloat(msg.mes))\n{\n    msg.state = \"on\";\n    return [msg, null];\n}\n\nmsg.state = \"off\"\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 1200,
        "wires": [
            [],
            [
                "579a4052810e2e27"
            ]
        ]
    },
    {
        "id": "e37f2af487703149",
        "type": "subflow:a6ce77f172d194a1",
        "z": "81d9975e.584f98",
        "name": "",
        "x": 1040,
        "y": 440,
        "wires": [
            [
                "18d2107faaeaa741"
            ],
            []
        ]
    },
    {
        "id": "18d2107faaeaa741",
        "type": "api-call-service",
        "z": "81d9975e.584f98",
        "name": "Light",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.mes",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1250,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "f6a195f64e0f6cb2",
        "type": "subflow:a6ce77f172d194a1",
        "z": "81d9975e.584f98",
        "name": "",
        "x": 1360,
        "y": 640,
        "wires": [
            [
                "5ca54b22.c636c4"
            ],
            []
        ]
    },
    {
        "id": "f11d6d8ebc6c254d",
        "type": "server-state-changed",
        "z": "81d9975e.584f98",
        "name": "MES Single",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.mes_button_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 510,
        "y": 460,
        "wires": [
            [
                "ae9b0c69.199fe"
            ],
            []
        ]
    },
    {
        "id": "8b51f9ab226ddf95",
        "type": "server-state-changed",
        "z": "81d9975e.584f98",
        "name": "MES Double",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.mes_button_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "double",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 570,
        "y": 640,
        "wires": [
            [
                "fd7516e6.d64e58"
            ],
            []
        ]
    },
    {
        "id": "49cf40e3113fdc3b",
        "type": "server-state-changed",
        "z": "81d9975e.584f98",
        "name": "MES Long",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.mes_button_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "long",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 520,
        "y": 500,
        "wires": [
            [
                "51d13bad.2e4d14",
                "ae9b0c69.199fe"
            ],
            []
        ]
    },
    {
        "id": "219f16bd.25cbca",
        "type": "api-call-service",
        "z": "4a06737d.008a7c",
        "name": "Bedroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 780,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "d56d58e6.cb90c8",
        "type": "api-call-service",
        "z": "4a06737d.008a7c",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 780,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "5d5860c4.f0506",
        "type": "api-call-service",
        "z": "4a06737d.008a7c",
        "name": "Study",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 770,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "cff4a041.4964",
        "type": "change",
        "z": "4a06737d.008a7c",
        "name": "Del payload",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 300,
        "wires": [
            [
                "219f16bd.25cbca",
                "d56d58e6.cb90c8",
                "5d5860c4.f0506"
            ]
        ]
    },
    {
        "id": "bd07ea84.78f3c8",
        "type": "api-call-service",
        "z": "8ed72877.93bc38",
        "name": "Kitchen Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.sonoff_kitchen",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 650,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "d9334fa0.38208",
        "type": "api-call-service",
        "z": "8ed72877.93bc38",
        "name": "Entrance Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 650,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "275772ae.eaabde",
        "type": "api-call-service",
        "z": "8ed72877.93bc38",
        "name": "Passsage Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.passage",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 660,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "52d7095a.13bfc8",
        "type": "api-call-service",
        "z": "8ed72877.93bc38",
        "name": "Lab Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.lab",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 640,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "22807ad5.545076",
        "type": "function",
        "z": "8ed72877.93bc38",
        "name": "Dim",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":20,\n        \"color_temp\":333\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 280,
        "wires": [
            [
                "57fb48a3.ed0348"
            ]
        ]
    },
    {
        "id": "57fb48a3.ed0348",
        "type": "api-call-service",
        "z": "8ed72877.93bc38",
        "name": "Outside",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 920,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "d0accc36.33341",
        "type": "api-current-state",
        "z": "8ed72877.93bc38",
        "name": "Sun",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "below_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 630,
        "y": 280,
        "wires": [
            [
                "22807ad5.545076"
            ],
            [
                "fca2e757.f77478"
            ]
        ]
    },
    {
        "id": "fca2e757.f77478",
        "type": "api-call-service",
        "z": "8ed72877.93bc38",
        "name": "Outside",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 780,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "757620d3.73d4",
        "type": "change",
        "z": "8ed72877.93bc38",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 200,
        "wires": [
            [
                "bd07ea84.78f3c8",
                "d9334fa0.38208",
                "275772ae.eaabde",
                "52d7095a.13bfc8",
                "d0accc36.33341"
            ]
        ]
    },
    {
        "id": "18360cce.e565e3",
        "type": "api-current-state",
        "z": "a436e8cb.527cf8",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.lounge_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 610,
        "y": 160,
        "wires": [
            [
                "48c60189.2b274"
            ],
            [
                "c6530cf1.a2f1d"
            ]
        ]
    },
    {
        "id": "48c60189.2b274",
        "type": "api-call-service",
        "z": "a436e8cb.527cf8",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 900,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "c6530cf1.a2f1d",
        "type": "api-call-service",
        "z": "a436e8cb.527cf8",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 900,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "b467c84c.4dc468",
        "type": "change",
        "z": "a436e8cb.527cf8",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 160,
        "wires": [
            [
                "18360cce.e565e3"
            ]
        ]
    },
    {
        "id": "df556151.d8c22",
        "type": "api-current-state",
        "z": "54c86189.6415",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 640,
        "y": 140,
        "wires": [
            [
                "6946092c.681c38"
            ],
            [
                "5a591dcf.255824"
            ]
        ]
    },
    {
        "id": "6946092c.681c38",
        "type": "function",
        "z": "54c86189.6415",
        "name": "Dim",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":20,\n        \"color_temp\":333\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "5a591dcf.255824",
        "type": "function",
        "z": "54c86189.6415",
        "name": "Bright",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":200\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "5dbcd079.75d08",
        "type": "change",
        "z": "54c86189.6415",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 140,
        "wires": [
            [
                "df556151.d8c22"
            ]
        ]
    },
    {
        "id": "5518df27.0ef46",
        "type": "change",
        "z": "34311fcd.cea24",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 240,
        "wires": [
            [
                "c139bcd0.3b1bc"
            ]
        ]
    },
    {
        "id": "c139bcd0.3b1bc",
        "type": "api-current-state",
        "z": "34311fcd.cea24",
        "name": "Sun Down",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 690,
        "y": 360,
        "wires": [
            [
                "60952339.5f863c"
            ],
            [
                "a9f78513.321758"
            ]
        ]
    },
    {
        "id": "60952339.5f863c",
        "type": "api-current-state",
        "z": "34311fcd.cea24",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 980,
        "y": 340,
        "wires": [
            [
                "9a09c277.b010d"
            ],
            [
                "59476d48.5e9b54"
            ]
        ]
    },
    {
        "id": "9a09c277.b010d",
        "type": "function",
        "z": "34311fcd.cea24",
        "name": "Dim",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":20,\n        \"color_temp\":333\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1190,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "59476d48.5e9b54",
        "type": "function",
        "z": "34311fcd.cea24",
        "name": "Bright",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":200\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1190,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "a9f78513.321758",
        "type": "function",
        "z": "34311fcd.cea24",
        "name": "Off",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":0,\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1190,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "101919ec.aec916",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Study AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 500,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "c4d56b4d.33ac08",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Lounge AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 510,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "b911b839.71bbe8",
        "type": "api-current-state",
        "z": "ca5a8b67.211fb8",
        "name": "Back Door",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.back_door_contact",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 510,
        "y": 380,
        "wires": [
            [
                "c22f4207.123ec"
            ],
            []
        ]
    },
    {
        "id": "e46c9b84.60b878",
        "type": "api-current-state",
        "z": "ca5a8b67.211fb8",
        "name": "Front Door",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.entrance_door_contact",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 510,
        "y": 420,
        "wires": [
            [
                "5fece0df.00b57"
            ],
            []
        ]
    },
    {
        "id": "c22f4207.123ec",
        "type": "function",
        "z": "ca5a8b67.211fb8",
        "name": "Opened",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Back door is still open\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 680,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "5fece0df.00b57",
        "type": "function",
        "z": "ca5a8b67.211fb8",
        "name": "Opened",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Front door is still open\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 680,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "2ba746ae.0bb31a",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Receiver",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "turn_off",
        "entityId": "media_player.receiver",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 500,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "9f797a10.cb3098",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Storeroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.storeroom_light",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 510,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "ee2bfb22.e00998",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Bathroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bathroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 500,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "13bb130.00407ed",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 500,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "b3b69e46.12a6d",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Study",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.study",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 490,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "9a6bc8a0.24d868",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Entrance",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.sonoff_entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 500,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "25b91eb1.c45162",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Kitchen",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.sonoff_kitchen",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 660,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "5bb0ed45.71d3d4",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Lab",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.lab",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 650,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "23a6af63.ff153",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Bathroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bathroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 840,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "702628b4.c2b938",
        "type": "api-call-service",
        "z": "ca5a8b67.211fb8",
        "name": "Passage",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.passage",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 840,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "6a6a0e19.a5346",
        "type": "api-call-service",
        "z": "8e0a986b.ca0ef8",
        "name": "Kitchen",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.sonoff_kitchen",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 620,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "33d5124b.5dd8fe",
        "type": "api-call-service",
        "z": "8e0a986b.ca0ef8",
        "name": "Entrance",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 620,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "f7909cea.9905b",
        "type": "change",
        "z": "8e0a986b.ca0ef8",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 140,
        "wires": [
            [
                "6a6a0e19.a5346",
                "33d5124b.5dd8fe",
                "9690509e.ea3f3"
            ]
        ]
    },
    {
        "id": "9690509e.ea3f3",
        "type": "function",
        "z": "8e0a986b.ca0ef8",
        "name": "2500K",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\": 2500\n    }\n};\n\nglobal.set(\"lounge_scene\", \"warm\");\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 610,
        "y": 160,
        "wires": [
            [
                "18c0dbc8.d34c14"
            ]
        ]
    },
    {
        "id": "18c0dbc8.d34c14",
        "type": "api-call-service",
        "z": "8e0a986b.ca0ef8",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 760,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "a0e8685a.8e3108",
        "type": "api-call-service",
        "z": "8b2696b9.77c108",
        "name": "Entrance",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 580,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "e3169abf.7a4a98",
        "type": "change",
        "z": "8b2696b9.77c108",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 200,
        "wires": [
            [
                "a0e8685a.8e3108",
                "e1d810db.48261"
            ]
        ]
    },
    {
        "id": "ca24d037.3188c",
        "type": "api-call-service",
        "z": "8b2696b9.77c108",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 720,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "e1d810db.48261",
        "type": "function",
        "z": "8b2696b9.77c108",
        "name": "250K",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":250\n    }\n};\nglobal.set(\"lounge_scene\", \"bright\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 570,
        "y": 220,
        "wires": [
            [
                "ca24d037.3188c"
            ]
        ]
    },
    {
        "id": "69303f76.a7109",
        "type": "api-call-service",
        "z": "f39f57bd.f82a58",
        "name": "Kitchen",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.sonoff_kitchen",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 540,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "32608752.6ce518",
        "type": "api-call-service",
        "z": "f39f57bd.f82a58",
        "name": "Entrance",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 540,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "da8ae703.da5a18",
        "type": "change",
        "z": "f39f57bd.f82a58",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 290,
        "y": 200,
        "wires": [
            [
                "69303f76.a7109",
                "32608752.6ce518",
                "8bdb5cc6.d6b64"
            ]
        ]
    },
    {
        "id": "8bdb5cc6.d6b64",
        "type": "function",
        "z": "f39f57bd.f82a58",
        "name": "1800K",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\": 1800\n    }\n};\nglobal.set(\"lounge_scene\", \"medium\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 530,
        "y": 220,
        "wires": [
            [
                "ec67d17a.801c9"
            ]
        ]
    },
    {
        "id": "ec67d17a.801c9",
        "type": "api-call-service",
        "z": "f39f57bd.f82a58",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 680,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "67a655cb.c8e24c",
        "type": "http request",
        "z": "ecfae70d.6fd868",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1690,
        "y": 140,
        "wires": [
            [
                "b0aa1eff.75651"
            ]
        ]
    },
    {
        "id": "eb4fd9f6.da3a28",
        "type": "function",
        "z": "ecfae70d.6fd868",
        "name": "Prepare Request",
        "func": "msg.url = flow.get(\"setIO\") + \"&index_id=2&status=\";\n\nif(msg.light == \"on\")\n    msg.url += \"true\"\nelse if(msg.light == \"off\")    \n    msg.url += \"false\"\nelse\n    return\n\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1410,
        "y": 140,
        "wires": [
            [
                "67a655cb.c8e24c",
                "616f2f65.1800e"
            ]
        ]
    },
    {
        "id": "c98e2e82.738a6",
        "type": "http request",
        "z": "ecfae70d.6fd868",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 890,
        "y": 220,
        "wires": [
            [
                "c28aabc4.fde6f8"
            ]
        ]
    },
    {
        "id": "c28aabc4.fde6f8",
        "type": "json",
        "z": "ecfae70d.6fd868",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1060,
        "y": 220,
        "wires": [
            [
                "93a07f39.78bd8"
            ]
        ]
    },
    {
        "id": "6f6d535e.459b4c",
        "type": "switch",
        "z": "ecfae70d.6fd868",
        "name": "",
        "property": "light",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "toggle",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "toggle",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 550,
        "y": 140,
        "wires": [
            [
                "eb4fd9f6.da3a28"
            ],
            [
                "298391da.b3be7e"
            ]
        ]
    },
    {
        "id": "93a07f39.78bd8",
        "type": "function",
        "z": "ecfae70d.6fd868",
        "name": "Switch",
        "func": "if(msg.payload[1].status === true)\n    msg.light = \"off\"\nelse\n    msg.light = \"on\"\n    \nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1230,
        "y": 220,
        "wires": [
            [
                "eb4fd9f6.da3a28"
            ]
        ]
    },
    {
        "id": "6b4f288b.bbc2f8",
        "type": "http request",
        "z": "ecfae70d.6fd868",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1532,
        "y": 405,
        "wires": [
            [
                "dc3fecd7.0151f"
            ]
        ]
    },
    {
        "id": "e78dace6.2c0bd",
        "type": "function",
        "z": "ecfae70d.6fd868",
        "name": "Prepare Request",
        "func": "msg.url = flow.get(\"setIO\") + \"&index_id=1&status=\";\n\nif(msg.printer == \"on\")\n    msg.url += \"true\"\nelse if(msg.printer == \"off\")    \n    msg.url += \"false\"\nelse\n    return\n\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1252,
        "y": 405,
        "wires": [
            [
                "6b4f288b.bbc2f8",
                "c8c21fa8.04ac7"
            ]
        ]
    },
    {
        "id": "7fabf17.68ff81",
        "type": "http request",
        "z": "ecfae70d.6fd868",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 712,
        "y": 525,
        "wires": [
            [
                "42d6f746.005218"
            ]
        ]
    },
    {
        "id": "42d6f746.005218",
        "type": "json",
        "z": "ecfae70d.6fd868",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 882,
        "y": 525,
        "wires": [
            [
                "c67a4d7e.ac628"
            ]
        ]
    },
    {
        "id": "3b95e8fe.376e68",
        "type": "switch",
        "z": "ecfae70d.6fd868",
        "name": "",
        "property": "printer",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "toggle",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "toggle",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 552,
        "y": 405,
        "wires": [
            [
                "e78dace6.2c0bd"
            ],
            [
                "7c552a47.c9c2a4"
            ]
        ]
    },
    {
        "id": "c67a4d7e.ac628",
        "type": "function",
        "z": "ecfae70d.6fd868",
        "name": "Switch",
        "func": "if(msg.payload[0].status === true)\n    msg.printer = \"off\"\nelse\n    msg.printer = \"on\"\n    \nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1052,
        "y": 525,
        "wires": [
            [
                "e78dace6.2c0bd"
            ]
        ]
    },
    {
        "id": "616f2f65.1800e",
        "type": "debug",
        "z": "ecfae70d.6fd868",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1594,
        "y": 79,
        "wires": []
    },
    {
        "id": "c8c21fa8.04ac7",
        "type": "debug",
        "z": "ecfae70d.6fd868",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1416,
        "y": 344,
        "wires": []
    },
    {
        "id": "b0aa1eff.75651",
        "type": "debug",
        "z": "ecfae70d.6fd868",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1874,
        "y": 99,
        "wires": []
    },
    {
        "id": "dc3fecd7.0151f",
        "type": "debug",
        "z": "ecfae70d.6fd868",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1716,
        "y": 364,
        "wires": []
    },
    {
        "id": "cefb4002.553d3",
        "type": "function",
        "z": "ecfae70d.6fd868",
        "name": "",
        "func": "let key = \"apikey=\" + env.get(\"api_key\");\nlet ip = \"http://\" + env.get(\"ip\");\n\nurl = ip + \"/plugin/enclosure/\";\ncmdRequestOutput = \"getOutputStatus?\";\ncmdSetOutput = \"setIO?\";\n\noutputStatus = url + cmdRequestOutput + key;\nsetIO = url + cmdSetOutput + key;\n\nflow.set(\"outputStatus\", outputStatus);\nflow.set(\"setIO\", setIO);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 200,
        "wires": [
            [
                "6f6d535e.459b4c",
                "3b95e8fe.376e68"
            ]
        ]
    },
    {
        "id": "298391da.b3be7e",
        "type": "function",
        "z": "ecfae70d.6fd868",
        "name": "",
        "func": "msg.url = flow.get(\"outputStatus\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 220,
        "wires": [
            [
                "c98e2e82.738a6"
            ]
        ]
    },
    {
        "id": "7c552a47.c9c2a4",
        "type": "function",
        "z": "ecfae70d.6fd868",
        "name": "",
        "func": "msg.url = flow.get(\"outputStatus\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 560,
        "y": 520,
        "wires": [
            [
                "7fabf17.68ff81"
            ]
        ]
    },
    {
        "id": "b0b7897ef85f73ec",
        "type": "api-current-state",
        "z": "32fd502d52a4fa0c",
        "name": "Lights on?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.bedside",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 370,
        "y": 280,
        "wires": [
            [
                "4cbc3443032a898f"
            ],
            [
                "3f06427fdcba9961"
            ]
        ]
    },
    {
        "id": "4cbc3443032a898f",
        "type": "api-call-service",
        "z": "32fd502d52a4fa0c",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 600,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "df01eab2cc6d90d4",
        "type": "function",
        "z": "32fd502d52a4fa0c",
        "name": "Red",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness_pct\":20,\n        \"rgb_color\":[255,0,0]\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1070,
        "y": 260,
        "wires": [
            [
                "8234c2b0f9913b16"
            ]
        ]
    },
    {
        "id": "8234c2b0f9913b16",
        "type": "api-call-service",
        "z": "32fd502d52a4fa0c",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1240,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "9ed6bd81589dc7c4",
        "type": "function",
        "z": "32fd502d52a4fa0c",
        "name": "White",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":268\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 890,
        "y": 400,
        "wires": [
            [
                "8234c2b0f9913b16"
            ]
        ]
    },
    {
        "id": "a2617c55f3f9efa9",
        "type": "api-current-state",
        "z": "32fd502d52a4fa0c",
        "name": "Jen is home",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "device_tracker.janice",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 890,
        "y": 220,
        "wires": [
            [
                "faee27714b118e5b"
            ],
            [
                "df01eab2cc6d90d4"
            ]
        ]
    },
    {
        "id": "faee27714b118e5b",
        "type": "function",
        "z": "32fd502d52a4fa0c",
        "name": "2500K",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":10,\n        \"color_temp\": 2500\n    }\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1070,
        "y": 180,
        "wires": [
            [
                "fe4b981b2a7ce306"
            ]
        ]
    },
    {
        "id": "fe4b981b2a7ce306",
        "type": "api-call-service",
        "z": "32fd502d52a4fa0c",
        "name": "Bedside light",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedside",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1270,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "3f06427fdcba9961",
        "type": "api-current-state",
        "z": "32fd502d52a4fa0c",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 600,
        "y": 320,
        "wires": [
            [
                "a2617c55f3f9efa9"
            ],
            [
                "9ed6bd81589dc7c4"
            ]
        ]
    },
    {
        "id": "ba7ccfb8ae22e3c9",
        "type": "api-current-state",
        "z": "a6ce77f172d194a1",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 340,
        "y": 180,
        "wires": [
            [
                "a9c7a6fd9ff4e4dd",
                "d34a803afefb9930"
            ],
            [
                "1365cdbb003ada2b",
                "273ae82b51b225e8"
            ]
        ]
    },
    {
        "id": "a9c7a6fd9ff4e4dd",
        "type": "function",
        "z": "a6ce77f172d194a1",
        "name": "Night Light Tasmota",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":100,\n        \"color_temp\": 500\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "1365cdbb003ada2b",
        "type": "function",
        "z": "a6ce77f172d194a1",
        "name": "Day Light Xiaomi",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":268\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "d34a803afefb9930",
        "type": "function",
        "z": "a6ce77f172d194a1",
        "name": "Night Light Xiaomi",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":50,\n        \"color_temp\": 2500\n    }\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "273ae82b51b225e8",
        "type": "function",
        "z": "a6ce77f172d194a1",
        "name": "Day Light Tasmota",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":340\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "94a3e1a2770bdde5",
        "type": "string",
        "z": "aacfc38c8117669a",
        "name": "Format",
        "methods": [
            {
                "name": "replaceAll",
                "params": [
                    {
                        "type": "str",
                        "value": "="
                    },
                    {
                        "type": "str",
                        "value": ":"
                    }
                ]
            },
            {
                "name": "chompLeft",
                "params": [
                    {
                        "type": "str",
                        "value": "1,"
                    }
                ]
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 460,
        "y": 180,
        "wires": [
            [
                "c2193ea06f807311"
            ]
        ]
    },
    {
        "id": "c2193ea06f807311",
        "type": "string",
        "z": "aacfc38c8117669a",
        "name": "split",
        "methods": [
            {
                "name": "split",
                "params": [
                    {
                        "type": "str",
                        "value": ","
                    },
                    {
                        "type": "num",
                        "value": "1000"
                    }
                ]
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 610,
        "y": 180,
        "wires": [
            [
                "50909e69592ac377"
            ]
        ]
    },
    {
        "id": "50909e69592ac377",
        "type": "function",
        "z": "aacfc38c8117669a",
        "name": "JSON",
        "func": "obj = {};\nvar res;\n\nmsg.payload.forEach(function(item) {\n    res = item.split(\":\");\n    obj[res[0]] = res[1];\n})\nmsg.payload = obj;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 180,
        "wires": [
            [
                "437b63bc588263c9"
            ]
        ]
    },
    {
        "id": "5a2839ca1e326e49",
        "type": "function",
        "z": "aacfc38c8117669a",
        "name": "toString",
        "func": "var b=Buffer.from(msg.payload);\nvar s=b.toString();\nvar out=s;\nmsg.payload= out;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 180,
        "wires": [
            [
                "94a3e1a2770bdde5"
            ]
        ]
    },
    {
        "id": "437b63bc588263c9",
        "type": "function",
        "z": "aacfc38c8117669a",
        "name": "",
        "func": "if (msg.payload.hasOwnProperty('hostname'))\n{\n    return [msg, null];\n}\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 180,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "c387e2d6fbc6c3c1",
        "type": "function",
        "z": "e5bb55137891a2c8",
        "name": "lookup",
        "func": "let mac = msg.payload.mac;\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"configuration/lookup\";\nm2m.version={ major:0, minor:1 };\nm2m.key = {name:msg.payload.key};\n\nmsg.payload = m2m;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 200,
        "wires": [
            [
                "d7f40d11886a23c1"
            ]
        ]
    },
    {
        "id": "d7f40d11886a23c1",
        "type": "json",
        "z": "e5bb55137891a2c8",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 940,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "cf2697ad4d730d92",
        "type": "uuid",
        "z": "e5bb55137891a2c8",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 640,
        "y": 200,
        "wires": [
            [
                "c387e2d6fbc6c3c1"
            ]
        ]
    },
    {
        "id": "6d4984a681107e87",
        "type": "function",
        "z": "e5bb55137891a2c8",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('key'))\n{\n    let key = env.get(\"key\") || 0;\n    if(0 == key)\n    {\n        throw \"key not defined\";    \n    }\n    payload.key = key;\n}\nelse payload.key = msg.payload.key;\n    \nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 480,
        "y": 200,
        "wires": [
            [
                "cf2697ad4d730d92"
            ]
        ]
    },
    {
        "id": "4dd0cae30fff9dc5",
        "type": "subflow:ef28203219c5f3e6",
        "z": "ada279a395cd9594",
        "name": "",
        "env": [
            {
                "name": "key",
                "value": "READER_MODE_AUTHENTICATION",
                "type": "str"
            }
        ],
        "x": 520,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "88db07a2fd609dea",
        "type": "function",
        "z": "ada279a395cd9594",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\nif (!msg.payload.hasOwnProperty('mode'))\n{\n    let mode = env.get(\"mode\") || 0;\n    if(0 == mode)\n    {\n        throw \"mode not defined\";    \n    }\n    payload.value = {\"modeName\":[mode]}\n}\nelse payload.value = {\"modeName\":[msg.payload.mode]}\n\nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 160,
        "wires": [
            [
                "4dd0cae30fff9dc5"
            ]
        ]
    },
    {
        "id": "7ea5611c6d202f67",
        "type": "function",
        "z": "ef28203219c5f3e6",
        "name": "write",
        "func": "let mac = msg.payload.mac;\nlet val = msg.payload.value;\nlet key = msg.payload.key\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/response\";\nm2m.command=\"configuration/write\";\nm2m.version={ major:0, minor:1 };\nm2m.key = {name:key};\nm2m.attributes = {};\nm2m.attributes.value = val;\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 280,
        "wires": [
            [
                "805a21bf6d823e10"
            ]
        ]
    },
    {
        "id": "805a21bf6d823e10",
        "type": "json",
        "z": "ef28203219c5f3e6",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 900,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "efbf1c2c8ee35fd2",
        "type": "uuid",
        "z": "ef28203219c5f3e6",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 600,
        "y": 280,
        "wires": [
            [
                "7ea5611c6d202f67"
            ]
        ]
    },
    {
        "id": "ed17865cbbcb1f75",
        "type": "function",
        "z": "ef28203219c5f3e6",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('key'))\n{\n    let key = env.get(\"key\") || 0;\n    if(0 == key)\n    {\n        throw \"key not defined\";    \n    }\n    payload.key = key;\n}\nelse payload.key = msg.payload.key;\n    \nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\nif (!msg.payload.hasOwnProperty('value'))\n{\n    let val = env.get(\"value\") || 0;\n    if(0 == val)\n    {\n        throw \"value not defined\";    \n    }\n    payload.value = val;\n}\nelse payload.value = msg.payload.value;\n    \nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 280,
        "wires": [
            [
                "efbf1c2c8ee35fd2"
            ]
        ]
    },
    {
        "id": "b1b5f15da275d58d",
        "type": "function",
        "z": "a7b7c383c56a3f2d",
        "name": "write",
        "func": "let mac = msg.payload.mac;\nlet val = msg.payload.value;\nlet key = msg.payload.key\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/response\";\nm2m.command=\"system/reboot\";\nm2m.version={ major:0, minor:1 };\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 260,
        "wires": [
            [
                "6dd32e673f1c4afd"
            ]
        ]
    },
    {
        "id": "6dd32e673f1c4afd",
        "type": "json",
        "z": "a7b7c383c56a3f2d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 740,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "9af1cb8cc212a626",
        "type": "uuid",
        "z": "a7b7c383c56a3f2d",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 440,
        "y": 260,
        "wires": [
            [
                "b1b5f15da275d58d"
            ]
        ]
    },
    {
        "id": "2ea7d18b12b8529e",
        "type": "function",
        "z": "a7b7c383c56a3f2d",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 260,
        "wires": [
            [
                "9af1cb8cc212a626"
            ]
        ]
    },
    {
        "id": "c6b3deb9a0ec93e5",
        "type": "function",
        "z": "52270a6ff896cf61",
        "name": "write",
        "func": "let mac = msg.payload.mac;\nlet key = msg.payload.key\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/response\";\nm2m.command=\"finger/database/reset\";\nm2m.version={ major:0, minor:1 };\nm2m.key = {database:key};\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 240,
        "wires": [
            [
                "9cebd1c31d2fe682"
            ]
        ]
    },
    {
        "id": "9cebd1c31d2fe682",
        "type": "json",
        "z": "52270a6ff896cf61",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 920,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "79b79bd5274d0e33",
        "type": "uuid",
        "z": "52270a6ff896cf61",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 620,
        "y": 240,
        "wires": [
            [
                "c6b3deb9a0ec93e5"
            ]
        ]
    },
    {
        "id": "b67864742e7e6b70",
        "type": "function",
        "z": "52270a6ff896cf61",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\nif (!msg.payload.hasOwnProperty('database'))\n{\n    let db = env.get(\"database\") || 0;\n    if(0 == db)\n    {\n        throw \"Database not defined\";    \n    }\n    payload.key = db;\n}\nelse payload.key = msg.payload.database;\n\nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 240,
        "wires": [
            [
                "79b79bd5274d0e33"
            ]
        ]
    },
    {
        "id": "69ddfb37c6e75a14",
        "type": "function",
        "z": "27041614d0046a67",
        "name": "write",
        "func": "let mac = msg.payload.mac;\nlet val = msg.payload.value;\nlet key = msg.payload.key\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"finger/capture\";\nm2m.version={ major:0, minor:1 };\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 160,
        "wires": [
            [
                "14f20d7a9cd4027e"
            ]
        ]
    },
    {
        "id": "14f20d7a9cd4027e",
        "type": "json",
        "z": "27041614d0046a67",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 760,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "df8575db68f17b7a",
        "type": "uuid",
        "z": "27041614d0046a67",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 460,
        "y": 160,
        "wires": [
            [
                "69ddfb37c6e75a14"
            ]
        ]
    },
    {
        "id": "4e4394f28a2c9ffe",
        "type": "function",
        "z": "27041614d0046a67",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\nif (!msg.payload.hasOwnProperty('id'))\n{\n    let id = env.get(\"id\") || 0;\n    if(0 == id)\n    {\n        throw \"ID not defined\";    \n    }\n    global.set(\"capture_id\", id);\n}\nelse global.set(\"capture_id\", msg.payload.id);\n\nif (!msg.payload.hasOwnProperty('finger'))\n{\n    let finger = env.get(\"finger\") || 0;\n    if(0 == finger)\n    {\n        throw \"Finger not defined\";    \n    }\n    global.set(\"capture_finger\", finger);\n}\nelse global.set(\"capture_finger\", msg.payload.finger);\n\nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 160,
        "wires": [
            [
                "df8575db68f17b7a"
            ]
        ]
    },
    {
        "id": "6924a982bfa91ae3",
        "type": "function",
        "z": "3dbcea1231ae029d",
        "name": "write",
        "func": "let mac = msg.payload.mac;\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/response\";\nm2m.command=\"event/retrieve\";\nm2m.version={ major:0, minor:1 };\nm2m.attributes={ count:env.get(\"count\") }\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 260,
        "wires": [
            [
                "7d1e3061ce3c7f9e"
            ]
        ]
    },
    {
        "id": "7d1e3061ce3c7f9e",
        "type": "json",
        "z": "3dbcea1231ae029d",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 740,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "826e891764ee66a6",
        "type": "uuid",
        "z": "3dbcea1231ae029d",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 440,
        "y": 260,
        "wires": [
            [
                "6924a982bfa91ae3"
            ]
        ]
    },
    {
        "id": "84f24d56971a8a1f",
        "type": "function",
        "z": "3dbcea1231ae029d",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\n    \nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 260,
        "wires": [
            [
                "826e891764ee66a6"
            ]
        ]
    },
    {
        "id": "503e8d305a631ba3",
        "type": "function",
        "z": "eae3302d5c488f43",
        "name": "write",
        "func": "let mac = msg.payload.mac;\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/response\";\nm2m.command=\"event/delete\";\nm2m.version={ major:0, minor:1 };\n\nif (msg.payload.hasOwnProperty('ids'))\n{\n    m2m.attributes={ ids:msg.payload.ids }\n}\nelse\n{\n    m2m.attributes={ ids:[env.get(\"eventId\")] }\n}\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 140,
        "wires": [
            [
                "9b17e5e05895274f"
            ]
        ]
    },
    {
        "id": "9b17e5e05895274f",
        "type": "json",
        "z": "eae3302d5c488f43",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 880,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "9717eef84b82bd19",
        "type": "uuid",
        "z": "eae3302d5c488f43",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 580,
        "y": 140,
        "wires": [
            [
                "503e8d305a631ba3"
            ]
        ]
    },
    {
        "id": "3f4646a1cbc978c0",
        "type": "function",
        "z": "eae3302d5c488f43",
        "name": "set vars",
        "func": "payload = {}\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    let mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n    payload.mac = mac;\n}\nelse payload.mac = msg.payload.mac;\n\nif (msg.payload.hasOwnProperty('ids'))\n{\n    payload.ids = msg.payload.ids;\n}\n\nmsg.payload = payload;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 140,
        "wires": [
            [
                "9717eef84b82bd19"
            ]
        ]
    },
    {
        "id": "6237ad4f9d8db079",
        "type": "function",
        "z": "4cb55b245fd49718",
        "name": "upload",
        "func": "var mac;\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n}\nelse mac = msg.payload.mac;\n\nif (!msg.payload.hasOwnProperty('finger'))\n{\n    throw \"Finger not defined\";\n}\nif (!msg.payload.hasOwnProperty('id'))\n{\n    throw \"ID not defined\";\n}\nif (!msg.payload.hasOwnProperty('template'))\n{\n    throw \"Template not defined\";\n}\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"finger/upload\";\nm2m.version={ major:0, minor:1 };\nm2m.key={ database:\"PACS\", userId:msg.payload.id.toString() };\nm2m.attributes={};\nm2m.attributes.finger=msg.payload.finger;\nm2m.attributes.template=msg.payload.template;\nm2m.attributes.type=\"Lumidigm 6K\";\nm2m.attributes.duress=env.get(\"duress\") || false;\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 240,
        "wires": [
            [
                "e5a4e684eeafca46"
            ]
        ]
    },
    {
        "id": "e5a4e684eeafca46",
        "type": "json",
        "z": "4cb55b245fd49718",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 690,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "d8568e1440795f4e",
        "type": "uuid",
        "z": "4cb55b245fd49718",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 350,
        "y": 240,
        "wires": [
            [
                "6237ad4f9d8db079"
            ]
        ]
    },
    {
        "id": "934a1c594e47a1be",
        "type": "uuid",
        "z": "4cb55b245fd49718",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 350,
        "y": 200,
        "wires": [
            [
                "5c94a60b567a6375"
            ]
        ]
    },
    {
        "id": "5c94a60b567a6375",
        "type": "function",
        "z": "4cb55b245fd49718",
        "name": "delete template",
        "func": "var mac;\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n}\nelse mac = msg.payload.mac;\n\nif (!msg.payload.hasOwnProperty('finger'))\n{\n    throw \"Finger not defined\";\n}\nif (!msg.payload.hasOwnProperty('id'))\n{\n    throw \"ID not defined\";\n}\nif (!msg.payload.hasOwnProperty('template'))\n{\n    throw \"Template not defined\";\n}\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"finger/delete\";\nm2m.version={ major:0, minor:1 };\nm2m.key={ database:\"PACS\", userId:msg.payload.id.toString(), finger:msg.payload.finger };\nm2m.attributes={ deleteAllFingers:false };\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 200,
        "wires": [
            [
                "4d467bdfd0caf350"
            ]
        ]
    },
    {
        "id": "4d467bdfd0caf350",
        "type": "json",
        "z": "4cb55b245fd49718",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 690,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "e68e4d40b6b3c29d",
        "type": "function",
        "z": "5fd2a5bb3c38e382",
        "name": "write",
        "func": "var mac;\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n}\nelse mac = msg.payload.mac;\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"card/read\";\nm2m.version={ major:0, minor:1 };\nm2m.attributes={timeout:env.get(\"timeout\")};\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 220,
        "wires": [
            [
                "e52808d6315deed8"
            ]
        ]
    },
    {
        "id": "e52808d6315deed8",
        "type": "json",
        "z": "5fd2a5bb3c38e382",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 620,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "53b61995886caad7",
        "type": "uuid",
        "z": "5fd2a5bb3c38e382",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 320,
        "y": 220,
        "wires": [
            [
                "e68e4d40b6b3c29d"
            ]
        ]
    },
    {
        "id": "6b920ef655c98526",
        "type": "json",
        "z": "2dc484a32dc07a73",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "2998fa81f6a91a97",
        "type": "uuid",
        "z": "2dc484a32dc07a73",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 450,
        "y": 340,
        "wires": [
            [
                "7756049b13c042e4"
            ]
        ]
    },
    {
        "id": "bc62b31070a30d04",
        "type": "uuid",
        "z": "2dc484a32dc07a73",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 450,
        "y": 300,
        "wires": [
            [
                "9771f79383a5562a"
            ]
        ]
    },
    {
        "id": "9771f79383a5562a",
        "type": "function",
        "z": "2dc484a32dc07a73",
        "name": "delete card",
        "func": "var mac;\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n}\nelse mac = msg.payload.mac;\n\nvar id;\nvar card;\nvar pacs;\n\nif (!msg.payload.hasOwnProperty('id'))\n    id = env.get(\"id\") || 0;\nelse\n    id = msg.payload.id;\n\nif (!msg.payload.hasOwnProperty('cardNumber'))\n    card = env.get(\"cardNumber\") || 0;\nelse\n    card = msg.payload.cardNumber;\n\nif (!msg.payload.hasOwnProperty('pacsData'))\n    pacs = env.get(\"pacsData\") || 0;\nelse\n    pacs = msg.payload.pacsData;\n\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"card/delete\";\nm2m.version={ major:0, minor:1 };\nm2m.key={ \n    userId:id.toString(), \n    cardNumber:card,\n    recognitionType:\"CREDENTIAL_DATA\",\n    pacsData:pacs,\n    pacsBits:26,\n    format:\"RAW\"\n};\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 300,
        "wires": [
            [
                "de6415e0c2e51726"
            ]
        ]
    },
    {
        "id": "de6415e0c2e51726",
        "type": "json",
        "z": "2dc484a32dc07a73",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "7756049b13c042e4",
        "type": "function",
        "z": "2dc484a32dc07a73",
        "name": "enroll card",
        "func": "var mac;\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n}\nelse mac = msg.payload.mac;\n\nvar id;\nvar card;\nvar pacs;\n\nif (!msg.payload.hasOwnProperty('id'))\n    id = env.get(\"id\") || 0;\nelse\n    id = msg.payload.id;\n\nif (!msg.payload.hasOwnProperty('cardNumber'))\n    card = env.get(\"cardNumber\") || 0;\nelse\n    card = msg.payload.cardNumber;\n\nif (!msg.payload.hasOwnProperty('pacsData'))\n    pacs = env.get(\"pacsData\") || 0;\nelse\n    pacs = msg.payload.pacsData;\n\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"card/enroll\";\nm2m.version={ major:0, minor:1 };\nm2m.key={ \n    userId:id.toString(), \n    cardNumber:card,\n    recognitionType:\"CREDENTIAL_DATA\",\n    pacsData:pacs,\n    pacsBits:26,\n    format:\"RAW\"\n};\nm2m.attributes = {primaryOutput:true};\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 340,
        "wires": [
            [
                "6b920ef655c98526"
            ]
        ]
    },
    {
        "id": "1dc97a33c8f3c933",
        "type": "function",
        "z": "fbc8c94e94125ace",
        "name": "Make them",
        "func": "var name;\n\nif (!msg.payload.hasOwnProperty('name'))\n{\n    name = env.get(\"name\") || 0;\n    if(0 == name)\n    {\n        throw \"Name not defined\";    \n    }\n}\nelse name = msg.payload.name;\n\nvar id;\nif (!msg.payload.hasOwnProperty('id'))\n{\n    id = env.get(\"id\") || 0;\n    if(0 == id)\n    {\n        throw \"No ID defined\";    \n    }\n}\nelse id = msg.payload.id;\n\nvar user = {};\nuser.id = id;\nuser.firstname = name;\nuser.surname = env.get(\"surname\");\nuser.pacsData = ('00000000' + msg.pacs.toString(16).toUpperCase()).slice(-8);\nuser.cardNumber=msg.card.toString();\n\nmsg.payload = user;\n\ndelete msg.card;\ndelete msg.pacs;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "059c3737bed8523a",
        "type": "random",
        "z": "fbc8c94e94125ace",
        "name": "PACS",
        "low": 1,
        "high": "4095",
        "inte": "true",
        "property": "pacs",
        "x": 490,
        "y": 280,
        "wires": [
            [
                "ceaaf2b43a36b5d1"
            ]
        ]
    },
    {
        "id": "ceaaf2b43a36b5d1",
        "type": "random",
        "z": "fbc8c94e94125ace",
        "name": "CARD",
        "low": 1,
        "high": "4095",
        "inte": "true",
        "property": "card",
        "x": 650,
        "y": 280,
        "wires": [
            [
                "1dc97a33c8f3c933"
            ]
        ]
    },
    {
        "id": "3ff4847155f58105",
        "type": "function",
        "z": "4d21ef95f85fa8fe",
        "name": "upload",
        "func": "var mac;\n\nif (!msg.payload.hasOwnProperty('mac'))\n{\n    mac = env.get(\"mac\") || 0;\n    if(0 == mac)\n    {\n        throw \"MAC not defined\";    \n    }\n}\nelse mac = msg.payload.mac;\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = msg.uuid;\nm2m.replyTo=\"m2m/\"+mac+\"/\" + env.get(\"response topic\");\nm2m.command=\"schedule/writeOrUpdate\";\nm2m.version={ major:0, minor:1 };\nm2m.key={ scheduleKey:env.get(\"identifier\") };\n\nm2m.attributes={};\n\nm2m.attributes.name=env.get(\"name\");\nm2m.attributes.days={\n    monday:env.get(\"monday\"),\n    tuesday:env.get(\"tuesday\"),\n    wednesday:env.get(\"wednesday\"),\n    thursday:env.get(\"thursday\"),\n    friday:env.get(\"friday\"),\n    saturday:env.get(\"saturday\"),\n    sunday:env.get(\"sunday\")\n};\n\nm2m.attributes.time={\n    startHour:Number(env.get(\"start time\").split(':')[0]),\n    startMinute:Number(env.get(\"start time\").split(':')[1]),\n    duration:env.get(\"duration\")\n};\n\nlet startDate = env.get(\"start date\") || 0;\nlet endDate = env.get(\"end date\") || 0;\nvar start = {};\nvar end = {};\nif((0 != startDate) && (0 != endtDate))\n{\n    const s = Date.parse(startDate);\n    const e = Date.parse(startDate);\n\n    start.month = '' + (s.getMonth() + 1);\n    start.dayOfMonth = '' + s.getDate()\n    start.year = s.getFullYear(); \n    \n    end.month = '' + (s.getMonth() + 1);\n    end.dayOfMonth = '' + s.getDate()\n    end.year = s.getFullYear(); \n\n    m2m.attributes.activeDates=[{start:start, end:end}];\n}\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 570,
        "y": 220,
        "wires": [
            [
                "156033753981cf75"
            ]
        ]
    },
    {
        "id": "156033753981cf75",
        "type": "json",
        "z": "4d21ef95f85fa8fe",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 750,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "e949255cd98819e3",
        "type": "uuid",
        "z": "4d21ef95f85fa8fe",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "msg",
        "x": 410,
        "y": 220,
        "wires": [
            [
                "3ff4847155f58105"
            ]
        ]
    },
    {
        "id": "9a208cabf4505024",
        "type": "http request",
        "z": "9839085e54c4764c",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://192.168.1.155:3000/security/publicKey",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 650,
        "y": 220,
        "wires": [
            [
                "581bc2d1b47c804b"
            ]
        ]
    },
    {
        "id": "581bc2d1b47c804b",
        "type": "function",
        "z": "9839085e54c4764c",
        "name": "Format Key",
        "func": "msg.payload = msg.payload.replaceAll(\"\\n\",\"\");\nmsg.payload = msg.payload.replaceAll(\"\\r\",\"\");\nmsg.payload = msg.payload.replace(\"-----BEGIN PUBLIC KEY-----\", \"-----BEGIN PUBLIC KEY-----\" + \"\\r\\n\");\nmsg.payload = msg.payload.replace(\"-----END PUBLIC KEY-----\", \"\\r\\n\" + \"-----END PUBLIC KEY-----\" + \"\\r\\n\"); \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 870,
        "y": 220,
        "wires": [
            [
                "72aae68e2b47b0a7"
            ]
        ]
    },
    {
        "id": "39e331dd928ff3bc",
        "type": "subflow:38e6f5c55d11c778",
        "z": "9839085e54c4764c",
        "name": "",
        "x": 230,
        "y": 240,
        "wires": [
            [
                "0d144c752ecf3a09"
            ],
            []
        ]
    },
    {
        "id": "0d144c752ecf3a09",
        "type": "function",
        "z": "9839085e54c4764c",
        "name": "",
        "func": "let device = msg.payload;\n\nmsg.device = device;\nmsg.url = \"http://\" + device.ipAddr + \":3000/security/publicKey\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 220,
        "wires": [
            [
                "9a208cabf4505024"
            ]
        ]
    },
    {
        "id": "72aae68e2b47b0a7",
        "type": "function",
        "z": "9839085e54c4764c",
        "name": "Add to device",
        "func": "msg.device.key = msg.payload;\nmsg.payload = msg.device;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1060,
        "y": 220,
        "wires": [
            [
                "203a9468d7363b7d"
            ]
        ]
    },
    {
        "id": "ddf9886f5e51b310",
        "type": "addFirebase",
        "z": "9839085e54c4764c",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "",
        "childpath": "childpath",
        "propertyType": "msg",
        "method": "update",
        "newchildpath": "",
        "x": 1430,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "203a9468d7363b7d",
        "type": "function",
        "z": "9839085e54c4764c",
        "name": "modify path",
        "func": "msg.childpath = \"devices/\" + msg.payload.hostname;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 220,
        "wires": [
            [
                "ddf9886f5e51b310"
            ]
        ]
    },
    {
        "id": "3cab0ddf6290f1ec",
        "type": "addFirebase",
        "z": "38e6f5c55d11c778",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "",
        "childpath": "devices",
        "propertyType": "str",
        "method": "get",
        "newchildpath": "",
        "x": 750,
        "y": 260,
        "wires": [
            [
                "1851b53852c462e2"
            ]
        ]
    },
    {
        "id": "1851b53852c462e2",
        "type": "function",
        "z": "38e6f5c55d11c778",
        "name": "find device",
        "func": "let match = msg.meta.hostname;\ndelete msg.meta;\nvar device = {};\nlet found = false;\n\nObject.keys(msg.payload).forEach(function(key) {\n    \n    if(msg.payload[key].hostname == match)\n    {\n        msg.payload = msg.payload[key];\n        found = true;\n    }\n});\n\nif(found)\n{\n    return [msg, null];\n}\n\nmsg.payload = \"Device not found\";\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 260,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "80253ac3f55b3ed2",
        "type": "function",
        "z": "38e6f5c55d11c778",
        "name": "init device name",
        "func": "var device;\n\nif (!msg.payload.hasOwnProperty('device'))\n{\n    device = env.get(\"device\") || 0;\n    if(0 == device)\n    {\n        throw \"device not defined\";    \n    }\n}\nelse device = msg.payload.device;\n\nmsg.meta = {hostname:device};\n\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 260,
        "wires": [
            [
                "3cab0ddf6290f1ec"
            ]
        ]
    },
    {
        "id": "3c65fb60d5c10be6",
        "type": "function",
        "z": "01e46596931945f1",
        "name": "write",
        "func": "let mac = msg.device.macAddr.replaceAll(\"-\", \":\").toLowerCase();\n\nvar m2m={};\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nm2m.correlationId = flow.get(\"uuid\");\nm2m.replyTo=\"m2m/\" + mac +\"/response/db_reset\";\nm2m.command=\"finger/database/reset\";\nm2m.version={ major:0, minor:1 };\nm2m.key = {database:\"PACS\"};\n\nmsg.payload = m2m;\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1310,
        "y": 260,
        "wires": [
            [
                "cbf4105933dc0dac"
            ]
        ]
    },
    {
        "id": "cbf4105933dc0dac",
        "type": "json",
        "z": "01e46596931945f1",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1460,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "7d752d02cc2eae0a",
        "type": "uuid",
        "z": "01e46596931945f1",
        "uuidVersion": "v4",
        "namespaceType": "",
        "namespace": "",
        "namespaceCustom": "",
        "name": "",
        "field": "uuid",
        "fieldType": "flow",
        "x": 1160,
        "y": 260,
        "wires": [
            [
                "3c65fb60d5c10be6"
            ]
        ]
    },
    {
        "id": "1d89dabb4e64cccb",
        "type": "function",
        "z": "01e46596931945f1",
        "name": "check payload",
        "func": "payload = {}\n\nlet host = env.get(\"device\") || 0;\nif((0 == host) && (!msg.payload.hasOwnProperty('deviceType')))\n{\n    throw \"Either enter a devicename or payload must be a device object\";\n}\n\nif (msg.payload.hasOwnProperty('deviceType'))\n{\n    return [msg, null];\n}\n\nmsg.delay = env.get(\"timeout\")*1000 || 40000;\n\n\nmsg.payload = {device:env.get(\"device\")};\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 260,
        "wires": [
            [
                "929c91a32e59badc"
            ],
            [
                "220eb30d0b85266b"
            ]
        ]
    },
    {
        "id": "220eb30d0b85266b",
        "type": "subflow:38e6f5c55d11c778",
        "z": "01e46596931945f1",
        "name": "",
        "x": 770,
        "y": 320,
        "wires": [
            [
                "929c91a32e59badc"
            ],
            []
        ]
    },
    {
        "id": "929c91a32e59badc",
        "type": "function",
        "z": "01e46596931945f1",
        "name": "move device",
        "func": "msg.device = msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 970,
        "y": 260,
        "wires": [
            [
                "7d752d02cc2eae0a"
            ]
        ]
    },
    {
        "id": "d7c42c52.4c3e",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "MQTT Pair",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "input_boolean.zigbee_permit_join",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 240,
        "wires": [
            [
                "c9ef9198.2a334"
            ],
            [
                "aa68a33b.3692"
            ]
        ]
    },
    {
        "id": "1fe49938.52d287",
        "type": "mqtt out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 690,
        "y": 240,
        "wires": []
    },
    {
        "id": "5ea20869.b1c748",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Join on",
        "func": "msg.topic = \"zigbee2mqtt/bridge/config/permit_join\"\nmsg.payload = \"true\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 520,
        "y": 200,
        "wires": [
            [
                "1fe49938.52d287"
            ]
        ]
    },
    {
        "id": "c9ef9198.2a334",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Start Timer",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "timer",
        "service": "start",
        "entityId": "timer.zigbee_permit_join",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 350,
        "y": 200,
        "wires": [
            [
                "5ea20869.b1c748"
            ]
        ]
    },
    {
        "id": "aa68a33b.3692",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Stop Timer",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "timer",
        "service": "cancel",
        "entityId": "timer.zigbee_permit_join",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 350,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "cdf5e2d6.f8e5f",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Join off",
        "func": "msg.topic = \"zigbee2mqtt/bridge/config/permit_join\"\nmsg.payload = \"false\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 520,
        "y": 280,
        "wires": [
            [
                "1fe49938.52d287"
            ]
        ]
    },
    {
        "id": "54c2f5a5.aff98c",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Pair Timer Expired",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "timer.zigbee_permit_join",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "idle",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 170,
        "y": 340,
        "wires": [
            [
                "741a1712.015708"
            ],
            []
        ]
    },
    {
        "id": "741a1712.015708",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "clear bool",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.zigbee_permit_join",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 360,
        "y": 340,
        "wires": [
            [
                "cdf5e2d6.f8e5f"
            ]
        ]
    },
    {
        "id": "66f9c23a.75febc",
        "type": "comment",
        "z": "62f232c2.0dd08c",
        "name": "Zigbee Pairing",
        "info": "",
        "x": 150,
        "y": 180,
        "wires": []
    },
    {
        "id": "4e8e5e9a.35431",
        "type": "status",
        "z": "62f232c2.0dd08c",
        "name": "HASSIO Boot",
        "scope": [
            "d7c42c52.4c3e"
        ],
        "x": 230,
        "y": 500,
        "wires": [
            [
                "2cc991c7.0b963e"
            ]
        ]
    },
    {
        "id": "2cc991c7.0b963e",
        "type": "switch",
        "z": "62f232c2.0dd08c",
        "name": "",
        "property": "status.text",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "connected",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 390,
        "y": 500,
        "wires": [
            [
                "b211aafc.28b0d8"
            ]
        ]
    },
    {
        "id": "30ac7365.37ee4c",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Sun Down",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1390,
        "y": 720,
        "wires": [
            [
                "e23b1f5e.78b27",
                "30b14c5c.eabb14"
            ],
            [
                "e5b48f60.58d56"
            ]
        ]
    },
    {
        "id": "e5b48f60.58d56",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Entrance Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1610,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "e23b1f5e.78b27",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "15",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 1580,
        "y": 720,
        "wires": [
            [
                "1b488cc2.349313"
            ],
            []
        ]
    },
    {
        "id": "1b488cc2.349313",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Entrance Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1790,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "c71179cb.80bf68",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Come Home",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "device_tracker.philip",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1130,
        "y": 640,
        "wires": [
            [
                "30ac7365.37ee4c"
            ],
            []
        ]
    },
    {
        "id": "23c17bb2.43d894",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Inside Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "group.inside_lights",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 730,
        "y": 720,
        "wires": [
            [
                "30ac7365.37ee4c"
            ]
        ]
    },
    {
        "id": "2e80644e.db870c",
        "type": "subflow:4a06737d.008a7c",
        "z": "62f232c2.0dd08c",
        "name": "",
        "x": 720,
        "y": 780,
        "wires": []
    },
    {
        "id": "a1d64bcd.5a5a58",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Toggle Lab",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.lab",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1670,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "9a6f96a7.0f4878",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "1",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 360,
        "y": 1120,
        "wires": [
            [
                "5bb1c918.a79778"
            ],
            []
        ]
    },
    {
        "id": "8308a91a.284bd8",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Passage",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.passage",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 680,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "5bb1c918.a79778",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Passage Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.passage",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 550,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "8b4677ab.406cf8",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Toggle Entrance",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 740,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "4015f510.e1850c",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "5",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 740,
        "y": 860,
        "wires": [
            [
                "ecbd4f25.1a057"
            ],
            []
        ]
    },
    {
        "id": "ecbd4f25.1a057",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Entrance Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 930,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "30b14c5c.eabb14",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Entrance Light On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.entrance",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1610,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "8824ebf4.df7668",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Opened",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Back door opened\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 300,
        "y": 1360,
        "wires": [
            [
                "a5bbbd59.3562d",
                "543bd5c9.d60d2c"
            ]
        ]
    },
    {
        "id": "16215a4f.2396a6",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Closed",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Back door closed\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 300,
        "y": 1280,
        "wires": [
            [
                "dcf088e0.722e08",
                "543bd5c9.d60d2c"
            ]
        ]
    },
    {
        "id": "e8b48634.c449f8",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Opened",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Front door opened\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 360,
        "y": 1720,
        "wires": [
            [
                "21ff3a8b.1ea676"
            ]
        ]
    },
    {
        "id": "5ed83a0.b9856c8",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Closed",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Front door closed\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 360,
        "y": 1640,
        "wires": [
            [
                "21ff3a8b.1ea676"
            ]
        ]
    },
    {
        "id": "d9924072.9bf18",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Is it after sunset?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 390,
        "y": 1820,
        "wires": [
            [
                "97695a79.486c98"
            ],
            [
                "5cd14205.7e73bc"
            ]
        ]
    },
    {
        "id": "5cd14205.7e73bc",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Front light off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.front",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 610,
        "y": 1860,
        "wires": [
            []
        ]
    },
    {
        "id": "718dfbea.2be854",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Is it still dark?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 580,
        "y": 1580,
        "wires": [
            [
                "f086f313.1eee3"
            ],
            [
                "ee682f5e.434f5"
            ]
        ]
    },
    {
        "id": "41e1e53.8143f1c",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "5",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 380,
        "y": 1580,
        "wires": [
            [
                "718dfbea.2be854"
            ],
            []
        ]
    },
    {
        "id": "456eca62.b4bb54",
        "type": "comment",
        "z": "62f232c2.0dd08c",
        "name": "Front Door and Light",
        "info": "",
        "x": 150,
        "y": 1580,
        "wires": []
    },
    {
        "id": "ee682f5e.434f5",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Front light off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.front",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 770,
        "y": 1620,
        "wires": [
            []
        ]
    },
    {
        "id": "97695a79.486c98",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Front Light 100%",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.front",
        "data": "{\"brightness\":255}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 630,
        "y": 1780,
        "wires": [
            []
        ]
    },
    {
        "id": "f086f313.1eee3",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Front Light 30%",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.front",
        "data": "{\"brightness\":80}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 780,
        "y": 1560,
        "wires": [
            []
        ]
    },
    {
        "id": "a5bbbd59.3562d",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Is it after sunset?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 621,
        "y": 1398,
        "wires": [
            [
                "ea1ccc18.d23f7"
            ],
            [
                "47c88411.97dcec"
            ]
        ]
    },
    {
        "id": "ea1ccc18.d23f7",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Back to full brightness",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.back",
        "data": "{\"brightness\":255}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 871,
        "y": 1358,
        "wires": [
            []
        ]
    },
    {
        "id": "47c88411.97dcec",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Back light off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 841,
        "y": 1438,
        "wires": [
            []
        ]
    },
    {
        "id": "aaa6ce0f.3afb2",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Is it still dark?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 708,
        "y": 1244,
        "wires": [
            [
                "1f8f87e6.a3e738"
            ],
            [
                "b358d60d.303208"
            ]
        ]
    },
    {
        "id": "1f8f87e6.a3e738",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Back light 30%",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.back",
        "data": "{\"brightness\":80}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 908,
        "y": 1224,
        "wires": [
            []
        ]
    },
    {
        "id": "b358d60d.303208",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Back Light off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 908,
        "y": 1264,
        "wires": [
            []
        ]
    },
    {
        "id": "dcf088e0.722e08",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "15",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 508,
        "y": 1244,
        "wires": [
            [
                "aaa6ce0f.3afb2"
            ],
            []
        ]
    },
    {
        "id": "8fb231c0.a4ff6",
        "type": "comment",
        "z": "62f232c2.0dd08c",
        "name": "Back Door and Light",
        "info": "",
        "x": 204,
        "y": 1236,
        "wires": []
    },
    {
        "id": "6b2c77d3.56ba88",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Is back open?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.back_door_contact",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1420,
        "y": 1080,
        "wires": [
            [
                "344ed565.be6dca"
            ],
            [
                "282678ef.61c548"
            ]
        ]
    },
    {
        "id": "344ed565.be6dca",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Back Light 100%",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.back",
        "data": "{\"brightness\":255}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1630,
        "y": 1060,
        "wires": [
            []
        ]
    },
    {
        "id": "282678ef.61c548",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Back Light 30%",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.back",
        "data": "{\"brightness\":80}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1620,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "142daa11.75e596",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Is front open?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.entrance_door_contact",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1420,
        "y": 1180,
        "wires": [
            [
                "1f8afa47.e2e276"
            ],
            [
                "98959526.cceba8"
            ]
        ]
    },
    {
        "id": "1f8afa47.e2e276",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Front Light 100%",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.front",
        "data": "{\"brightness\":255}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1630,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "98959526.cceba8",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Front Light 30%",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.front",
        "data": "{\"brightness\":80}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1620,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "a5aa1a45.c4c2f8",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Front light off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.front",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1390,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "d20251de.a97dc",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Back Light off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1400,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "4fda19db.d163b8",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Back Door",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.back_door_contact",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 114,
        "y": 1316,
        "wires": [
            [
                "16215a4f.2396a6"
            ],
            [
                "8824ebf4.df7668"
            ]
        ]
    },
    {
        "id": "8e3c9ae9.a7d0b8",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Front Door",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.entrance_door_contact",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 1680,
        "wires": [
            [
                "41e1e53.8143f1c",
                "5ed83a0.b9856c8"
            ],
            [
                "e8b48634.c449f8",
                "d9924072.9bf18"
            ]
        ]
    },
    {
        "id": "f09e6d4e.78de2",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Freezer",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "binary_sensor.contact_freezer",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1150,
        "y": 1320,
        "wires": [
            [
                "ee974eb.fb57db"
            ],
            []
        ]
    },
    {
        "id": "484c4cf5.4d98b4",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Freezer",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Freezer left open\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1630,
        "y": 1320,
        "wires": [
            [
                "1e436d78.92e373"
            ]
        ]
    },
    {
        "id": "ee974eb.fb57db",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "1",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 1310,
        "y": 1320,
        "wires": [
            [
                "ed17f40b.d61e08"
            ],
            []
        ]
    },
    {
        "id": "ed17f40b.d61e08",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Check",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.contact_freezer",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1480,
        "y": 1320,
        "wires": [
            [
                "484c4cf5.4d98b4"
            ],
            []
        ]
    },
    {
        "id": "e51bf764.54a428",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "TV",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "turn_off",
        "entityId": "media_player.smart_ir_tv",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 710,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "42a51188.cc05d",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "No-one Home",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "device_tracker.philip",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1090,
        "y": 1520,
        "wires": [
            [
                "348b1a7b.8b62a6",
                "bf6d2520.836408",
                "6808a9a8.92e298"
            ],
            []
        ]
    },
    {
        "id": "348b1a7b.8b62a6",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "Inside Lights",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "group.inside_lights",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1280,
        "y": 1480,
        "wires": [
            [
                "75618fa4.97d98"
            ],
            []
        ]
    },
    {
        "id": "75618fa4.97d98",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Notice",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"No one home but there are lights on\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1460,
        "y": 1440,
        "wires": [
            [
                "11ad200e.773aa"
            ]
        ]
    },
    {
        "id": "bf6d2520.836408",
        "type": "ha-get-entities",
        "z": "62f232c2.0dd08c",
        "name": "Aircons",
        "server": "7d575fd3.be153",
        "version": 0,
        "rules": [
            {
                "property": "entity_id",
                "logic": "starts_with",
                "value": "climate",
                "valueType": "str"
            }
        ],
        "output_type": "array",
        "output_empty_results": false,
        "output_location_type": "msg",
        "output_location": "payload",
        "output_results_count": 1,
        "x": 1270,
        "y": 1540,
        "wires": [
            [
                "54ef2619.9458a8"
            ]
        ]
    },
    {
        "id": "54ef2619.9458a8",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Notice",
        "func": "var count = 0\n\nvar message = \"The following aircons are on:\\n\"\n\nfor(i = 0 ; i < msg.payload.length; i++)\n{\n    if(msg.payload[i].state != \"off\")\n    {\n        message += \"\\n\" + msg.payload[i].attributes.friendly_name;\n        count++;\n    }\n}\n\nif(count === 0)\n    return null;\n\nmsg.topic = \"boss\"\nmsg.payload = message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1460,
        "y": 1540,
        "wires": [
            [
                "11ad200e.773aa"
            ]
        ]
    },
    {
        "id": "11c67e09.3ec552",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Notice",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Home Assistant booted\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 270,
        "y": 700,
        "wires": [
            [
                "f8882e97.4f3ab"
            ]
        ]
    },
    {
        "id": "b211aafc.28b0d8",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "30",
        "units": "Second",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 550,
        "y": 500,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "e5db0d64.7af64",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Booted",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "input_boolean.booted",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "habool",
        "haltifstate": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 110,
        "y": 700,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "f3a92c00.1afde",
        "type": "mqtt in",
        "z": "62f232c2.0dd08c",
        "name": "Kitchen Click",
        "topic": "zigbee2mqtt/0x00158d000183ad5c",
        "qos": "2",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "inputs": 0,
        "x": 130,
        "y": 1960,
        "wires": [
            [
                "1cd2b1c7.3c7bee"
            ]
        ]
    },
    {
        "id": "c574569.601b8a8",
        "type": "switch",
        "z": "62f232c2.0dd08c",
        "name": "Message",
        "property": "payload.click",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "single",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 460,
        "y": 1960,
        "wires": [
            [
                "30fc886a.f5ee08"
            ]
        ]
    },
    {
        "id": "1cd2b1c7.3c7bee",
        "type": "json",
        "z": "62f232c2.0dd08c",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 310,
        "y": 1960,
        "wires": [
            [
                "c574569.601b8a8"
            ]
        ]
    },
    {
        "id": "30fc886a.f5ee08",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Toggle",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.sonoff_kitchen",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 610,
        "y": 1960,
        "wires": [
            []
        ]
    },
    {
        "id": "8d9a243a.78f098",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Sunset",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "sun.sun",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1210,
        "y": 960,
        "wires": [
            [
                "a5aa1a45.c4c2f8",
                "d20251de.a97dc"
            ],
            [
                "6b2c77d3.56ba88",
                "142daa11.75e596"
            ]
        ]
    },
    {
        "id": "8c5ee2e5.c1a16",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Bathroom Door",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "binary_sensor.bathroom_door_contact",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1320,
        "y": 300,
        "wires": [
            [
                "8d5a2aab.f58118"
            ],
            [
                "84351b2ef939f679"
            ]
        ]
    },
    {
        "id": "b4363b8d.521108",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Bathroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.bathroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1720,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "4a0f0678.e98488",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Bathroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bathroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1720,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "9e30e220.211ce",
        "type": "inject",
        "z": "62f232c2.0dd08c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 640,
        "wires": [
            [
                "11c67e09.3ec552"
            ]
        ]
    },
    {
        "id": "543bd5c9.d60d2c",
        "type": "link out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 480,
        "y": 1320,
        "wires": []
    },
    {
        "id": "f8882e97.4f3ab",
        "type": "link out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 375,
        "y": 700,
        "wires": []
    },
    {
        "id": "21ff3a8b.1ea676",
        "type": "link out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 495,
        "y": 1680,
        "wires": []
    },
    {
        "id": "11ad200e.773aa",
        "type": "link out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 1635,
        "y": 1480,
        "wires": []
    },
    {
        "id": "1e436d78.92e373",
        "type": "link out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 1755,
        "y": 1320,
        "wires": []
    },
    {
        "id": "e2d1f061.2c3d7",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Receiver",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "turn_off",
        "entityId": "media_player.receiver",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 720,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "8d5a2aab.f58118",
        "type": "delay",
        "z": "62f232c2.0dd08c",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1560,
        "y": 280,
        "wires": [
            [
                "4a0f0678.e98488"
            ]
        ]
    },
    {
        "id": "b74f8104.b143f",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.study_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1630,
        "y": 1760,
        "wires": [
            [
                "9fb16122.5d43"
            ],
            [
                "61d4b492.f2ad1c"
            ]
        ]
    },
    {
        "id": "9fb16122.5d43",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1920,
        "y": 1740,
        "wires": [
            []
        ]
    },
    {
        "id": "61d4b492.f2ad1c",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1920,
        "y": 1800,
        "wires": [
            []
        ]
    },
    {
        "id": "cc51f123.3ce62",
        "type": "inject",
        "z": "62f232c2.0dd08c",
        "name": "",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 2260,
        "wires": [
            [
                "a6407012.169c1"
            ]
        ]
    },
    {
        "id": "24c5da64.6925a6",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Geyser Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "switch",
        "service": "turn_off",
        "entityId": "switch.geyser",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1050,
        "y": 2280,
        "wires": [
            []
        ]
    },
    {
        "id": "70276796.233f58",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Geyser On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "switch",
        "service": "turn_on",
        "entityId": "switch.geyser",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1050,
        "y": 2200,
        "wires": [
            []
        ]
    },
    {
        "id": "b270e6b0.984808",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "switch.geyser",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 820,
        "y": 2200,
        "wires": [
            [
                "70276796.233f58"
            ],
            []
        ]
    },
    {
        "id": "281dcc89.88ab94",
        "type": "time-range-switch",
        "z": "62f232c2.0dd08c",
        "name": "",
        "lat": "-29.83346",
        "lon": "30.91393",
        "startTime": "04:00",
        "endTime": "06:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 590,
        "y": 2260,
        "wires": [
            [
                "b270e6b0.984808"
            ],
            [
                "30b9c29e.e5e1ce"
            ]
        ]
    },
    {
        "id": "30b9c29e.e5e1ce",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "switch.geyser",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 820,
        "y": 2300,
        "wires": [
            [
                "24c5da64.6925a6"
            ],
            []
        ]
    },
    {
        "id": "a6407012.169c1",
        "type": "time-range-switch",
        "z": "62f232c2.0dd08c",
        "name": "",
        "lat": "-29.83346",
        "lon": "30.91393",
        "startTime": "18:00",
        "endTime": "20:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 370,
        "y": 2260,
        "wires": [
            [
                "b270e6b0.984808"
            ],
            [
                "281dcc89.88ab94"
            ]
        ]
    },
    {
        "id": "4e5263a4.04d8fc",
        "type": "mqtt out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 530,
        "y": 2500,
        "wires": []
    },
    {
        "id": "9284d4a4.bd7d88",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Reset Energy",
        "func": "msg.topic = \"cmnd/tasmota_488F91/EnergyReset3\"\nmsg.payload = \"0\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 360,
        "y": 2500,
        "wires": [
            [
                "4e5263a4.04d8fc"
            ]
        ]
    },
    {
        "id": "57713887.1c4798",
        "type": "inject",
        "z": "62f232c2.0dd08c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 900,
        "y": 2440,
        "wires": [
            [
                "24c5da64.6925a6"
            ]
        ]
    },
    {
        "id": "7cb51cde.f241c4",
        "type": "inject",
        "z": "62f232c2.0dd08c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 2500,
        "wires": [
            [
                "9284d4a4.bd7d88"
            ]
        ]
    },
    {
        "id": "71f6dcdf.a11794",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Opened",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Back door opened\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 380,
        "y": 2720,
        "wires": [
            [
                "bc8b0426.df7ee8"
            ]
        ]
    },
    {
        "id": "961e7241.791bf",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Closed",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Back door closed\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 380,
        "y": 2640,
        "wires": [
            [
                "ad41f953.64d508"
            ]
        ]
    },
    {
        "id": "9d899af5.2505d8",
        "type": "comment",
        "z": "62f232c2.0dd08c",
        "name": "Store Room Light",
        "info": "",
        "x": 274,
        "y": 2596,
        "wires": []
    },
    {
        "id": "643912df.f9c5ec",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Store Door",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.storeroom_contact",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 194,
        "y": 2676,
        "wires": [
            [
                "961e7241.791bf"
            ],
            [
                "71f6dcdf.a11794"
            ]
        ]
    },
    {
        "id": "ad41f953.64d508",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Store light off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.storeroom_light",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 550,
        "y": 2640,
        "wires": [
            []
        ]
    },
    {
        "id": "bc8b0426.df7ee8",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Store light on",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.storeroom_light",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 550,
        "y": 2720,
        "wires": [
            []
        ]
    },
    {
        "id": "18034796.49ea88",
        "type": "inject",
        "z": "62f232c2.0dd08c",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 880,
        "y": 2080,
        "wires": [
            [
                "70276796.233f58"
            ]
        ]
    },
    {
        "id": "6808a9a8.92e298",
        "type": "stoptimer",
        "z": "62f232c2.0dd08c",
        "duration": "3",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 1320,
        "y": 1640,
        "wires": [
            [
                "92654bb0.b7aaa8"
            ],
            []
        ]
    },
    {
        "id": "e4527337.68a9d",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Bedroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1680,
        "y": 1660,
        "wires": [
            []
        ]
    },
    {
        "id": "9462e28.ef9c02",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Study",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1670,
        "y": 1580,
        "wires": [
            []
        ]
    },
    {
        "id": "4306475c.e1d338",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1680,
        "y": 1620,
        "wires": [
            []
        ]
    },
    {
        "id": "92654bb0.b7aaa8",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "still away",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "device_tracker.philip",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1500,
        "y": 1620,
        "wires": [
            [
                "9462e28.ef9c02",
                "4306475c.e1d338",
                "e4527337.68a9d"
            ],
            []
        ]
    },
    {
        "id": "9f0812a.644f5f",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Study",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.study",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1750,
        "y": 1920,
        "wires": [
            []
        ]
    },
    {
        "id": "9f98ba1b.dc0dc8",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.study",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1520,
        "y": 2040,
        "wires": [
            []
        ]
    },
    {
        "id": "fa18c598.8d9758",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Study Motion",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.study_pir_occupancy",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1330,
        "y": 1940,
        "wires": [
            [
                "457bcfe6287f589f"
            ],
            []
        ]
    },
    {
        "id": "11e93ca2.1127f3",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "AC On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1630,
        "y": 1960,
        "wires": [
            []
        ]
    },
    {
        "id": "a68c6e52.1f39d",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "AC off?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.study_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1500,
        "y": 1960,
        "wires": [
            [
                "11e93ca2.1127f3"
            ],
            []
        ]
    },
    {
        "id": "9117a63c.aad4d8",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Study No Motion",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.study_pir_occupancy",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "30",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1340,
        "y": 2080,
        "wires": [
            [
                "9f98ba1b.dc0dc8",
                "5fd5de3d.76d8d"
            ],
            []
        ]
    },
    {
        "id": "5fd5de3d.76d8d",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "AC on?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.study_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1520,
        "y": 2100,
        "wires": [
            [
                "b44b05aa.459478"
            ],
            []
        ]
    },
    {
        "id": "b44b05aa.459478",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "AC On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1650,
        "y": 2100,
        "wires": [
            []
        ]
    },
    {
        "id": "e0209050.d1c04",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Jen visits",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "device_tracker.janice",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 310,
        "y": 2860,
        "wires": [
            [
                "195f8b99.7d57e4"
            ],
            []
        ]
    },
    {
        "id": "195f8b99.7d57e4",
        "type": "function",
        "z": "62f232c2.0dd08c",
        "name": "Notice",
        "func": "msg.topic = \"boss\"\nmsg.payload = \"Janice is at your house\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 2860,
        "wires": [
            [
                "6a3feee7.e3f45"
            ]
        ]
    },
    {
        "id": "6a3feee7.e3f45",
        "type": "link out",
        "z": "62f232c2.0dd08c",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 595,
        "y": 2860,
        "wires": []
    },
    {
        "id": "9b339980.ae4a38",
        "type": "api-call-service",
        "z": "62f232c2.0dd08c",
        "name": "Toggle Study",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.study",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1670,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "f7f4317681fc4f67",
        "type": "subflow:a6ce77f172d194a1",
        "z": "62f232c2.0dd08c",
        "name": "",
        "x": 1460,
        "y": 100,
        "wires": [
            [
                "9b339980.ae4a38"
            ],
            []
        ]
    },
    {
        "id": "4703763a51e18e32",
        "type": "subflow:a6ce77f172d194a1",
        "z": "62f232c2.0dd08c",
        "name": "",
        "x": 1460,
        "y": 160,
        "wires": [
            [
                "a1d64bcd.5a5a58"
            ],
            []
        ]
    },
    {
        "id": "84351b2ef939f679",
        "type": "subflow:a6ce77f172d194a1",
        "z": "62f232c2.0dd08c",
        "name": "",
        "x": 1560,
        "y": 340,
        "wires": [
            [],
            [
                "b4363b8d.521108"
            ]
        ]
    },
    {
        "id": "92d5a4a3cfdee9cc",
        "type": "subflow:a6ce77f172d194a1",
        "z": "62f232c2.0dd08c",
        "name": "",
        "x": 500,
        "y": 1040,
        "wires": [
            [
                "8308a91a.284bd8"
            ],
            []
        ]
    },
    {
        "id": "457bcfe6287f589f",
        "type": "subflow:a6ce77f172d194a1",
        "z": "62f232c2.0dd08c",
        "name": "",
        "x": 1520,
        "y": 1920,
        "wires": [
            [
                "9f0812a.644f5f"
            ],
            []
        ]
    },
    {
        "id": "64287bfb081e4b1a",
        "type": "api-current-state",
        "z": "62f232c2.0dd08c",
        "name": "sun",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 1040,
        "wires": [
            [
                "92d5a4a3cfdee9cc"
            ],
            []
        ]
    },
    {
        "id": "837c3773099b5801",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "PIR passage",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.passage_pir_occupancy",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 1080,
        "wires": [
            [
                "64287bfb081e4b1a",
                "9a6f96a7.0f4878"
            ],
            []
        ]
    },
    {
        "id": "a84603fc02857d4d",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Study Switch",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.study_switch_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1250,
        "y": 100,
        "wires": [
            [
                "f7f4317681fc4f67"
            ],
            []
        ]
    },
    {
        "id": "88ab57d3bb0b834e",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Lab Switch",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lab_switch_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1260,
        "y": 160,
        "wires": [
            [
                "4703763a51e18e32"
            ],
            []
        ]
    },
    {
        "id": "9908c40853cf294d",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Bathroom Switch",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bathroom_switch_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1320,
        "y": 360,
        "wires": [
            [
                "84351b2ef939f679"
            ],
            []
        ]
    },
    {
        "id": "e35e8909740abb14",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Entrance Button Single",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.entrance_button_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 460,
        "y": 780,
        "wires": [
            [
                "e2d1f061.2c3d7",
                "23c17bb2.43d894",
                "2e80644e.db870c",
                "e51bf764.54a428"
            ],
            []
        ]
    },
    {
        "id": "6bf7a473e05e858f",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Entrance Button Double",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.entrance_button_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 480,
        "y": 880,
        "wires": [
            [
                "4015f510.e1850c",
                "8b4677ab.406cf8"
            ],
            []
        ]
    },
    {
        "id": "5aa397c589e28cfc",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Study Button",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.study_button_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1330,
        "y": 1760,
        "wires": [
            [
                "b74f8104.b143f"
            ],
            []
        ]
    },
    {
        "id": "9ff27a48b5d9e4ac",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Study Button Long",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.study_button_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "long",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1350,
        "y": 1840,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "8d7e85b092d06154",
        "type": "server-state-changed",
        "z": "62f232c2.0dd08c",
        "name": "Study Button Double",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.study_button_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "double",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1150,
        "y": 1840,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "3585a77d.6fe258",
        "type": "mqtt out",
        "z": "152554cc.389edb",
        "name": "Publish",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 980,
        "y": 300,
        "wires": []
    },
    {
        "id": "d82b898d.8d2e48",
        "type": "mqtt in",
        "z": "152554cc.389edb",
        "name": "tags",
        "topic": "coffee_table/tags",
        "qos": "0",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "inputs": 0,
        "x": 190,
        "y": 300,
        "wires": [
            [
                "aa02c509.209398",
                "deabd4b3.5c5048"
            ]
        ]
    },
    {
        "id": "bba7a822.6dd958",
        "type": "stoptimer",
        "z": "152554cc.389edb",
        "duration": "5",
        "units": "Second",
        "payloadtype": "num",
        "payloadval": "lock",
        "name": "",
        "x": 680,
        "y": 260,
        "wires": [
            [
                "a8851025.063b3"
            ],
            []
        ]
    },
    {
        "id": "45f0144b.39d25c",
        "type": "switch",
        "z": "152554cc.389edb",
        "name": "Check",
        "property": "unlock",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 490,
        "y": 300,
        "wires": [
            [
                "bba7a822.6dd958",
                "3678f3ed.0183bc"
            ],
            []
        ]
    },
    {
        "id": "3678f3ed.0183bc",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "unlock",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"unlock\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 300,
        "wires": [
            [
                "3585a77d.6fe258"
            ]
        ]
    },
    {
        "id": "a8851025.063b3",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Lock",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"lock\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 260,
        "wires": [
            [
                "3585a77d.6fe258"
            ]
        ]
    },
    {
        "id": "cb1f7bed.cb9da8",
        "type": "inject",
        "z": "152554cc.389edb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 680,
        "y": 380,
        "wires": [
            [
                "3678f3ed.0183bc"
            ]
        ]
    },
    {
        "id": "d6cfdf6e.27fd6",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Temperature",
        "func": "msg.topic = \"coffee_table/ac/temp\"\nmsg.payload = msg.data.event.new_state.attributes.temperature\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 830,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "ba183189.07697",
        "type": "trigger-state",
        "z": "152554cc.389edb",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 1,
        "entityid": "climate.lounge_ac",
        "entityidfiltertype": "exact",
        "debugenabled": false,
        "constraints": [
            {
                "id": "e8hf5wc5cau",
                "targetType": "this_entity",
                "targetValue": "",
                "propertyType": "property",
                "propertyValue": "new_state.attributes.temperature",
                "comparatorType": ">",
                "comparatorValueDatatype": "num",
                "comparatorValue": "17"
            }
        ],
        "inputs": 1,
        "outputs": 2,
        "customoutputs": [],
        "outputinitially": true,
        "state_type": "str",
        "enableInput": true,
        "x": 430,
        "y": 780,
        "wires": [
            [
                "7c54558e.35644c"
            ],
            []
        ]
    },
    {
        "id": "45f389d6.4a0148",
        "type": "mqtt in",
        "z": "152554cc.389edb",
        "name": "Coffee Table Rebooted",
        "topic": "coffee_table/boot",
        "qos": "0",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "inputs": 0,
        "x": 120,
        "y": 960,
        "wires": [
            [
                "3fd50609.42b72a",
                "e28a7b90.cf96e8"
            ]
        ]
    },
    {
        "id": "3fd50609.42b72a",
        "type": "api-current-state",
        "z": "152554cc.389edb",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.lounge_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 430,
        "y": 840,
        "wires": [
            [
                "6eb0a296.32c9cc"
            ],
            [
                "d78eeb07.5b06e8"
            ]
        ]
    },
    {
        "id": "7c54558e.35644c",
        "type": "switch",
        "z": "152554cc.389edb",
        "name": "Is Off",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 650,
        "y": 780,
        "wires": [
            [
                "d6cfdf6e.27fd6"
            ],
            [
                "6eb0a296.32c9cc"
            ]
        ]
    },
    {
        "id": "6eb0a296.32c9cc",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Off",
        "func": "msg.topic = \"coffee_table/ac/temp\"\nmsg.payload = 0\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 810,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "d480b019.5e823",
        "type": "inject",
        "z": "152554cc.389edb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Trigger",
        "payloadType": "str",
        "x": 170,
        "y": 840,
        "wires": [
            [
                "3fd50609.42b72a"
            ]
        ]
    },
    {
        "id": "d78eeb07.5b06e8",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Temperature",
        "func": "msg.topic = \"coffee_table/ac/temp\"\nmsg.payload = msg.data.attributes.temperature\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 830,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "c0562d16.6a6",
        "type": "inject",
        "z": "152554cc.389edb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Trigger",
        "payloadType": "str",
        "x": 170,
        "y": 1120,
        "wires": [
            [
                "e28a7b90.cf96e8"
            ]
        ]
    },
    {
        "id": "e28a7b90.cf96e8",
        "type": "api-current-state",
        "z": "152554cc.389edb",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.lounge",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 440,
        "y": 1120,
        "wires": [
            [
                "ee29ecbf.be8cd"
            ],
            [
                "8fe0276f.d1b7a8"
            ]
        ]
    },
    {
        "id": "e7b9101a.4eb1",
        "type": "trigger-state",
        "z": "152554cc.389edb",
        "name": "Lounge Light Changed",
        "server": "7d575fd3.be153",
        "version": 1,
        "entityid": "light.lounge",
        "entityidfiltertype": "exact",
        "debugenabled": false,
        "constraints": [
            {
                "id": "x37cdsadl1",
                "targetType": "this_entity",
                "targetValue": "",
                "propertyType": "current_state",
                "propertyValue": "new_state.state",
                "comparatorType": "is",
                "comparatorValueDatatype": "str",
                "comparatorValue": "on"
            }
        ],
        "inputs": 1,
        "outputs": 2,
        "customoutputs": [],
        "outputinitially": true,
        "state_type": "str",
        "enableInput": true,
        "x": 480,
        "y": 1060,
        "wires": [
            [
                "4f5232e3.6d956c",
                "a6cac5fd.85bd78"
            ],
            [
                "ee29ecbf.be8cd",
                "a6cac5fd.85bd78"
            ]
        ]
    },
    {
        "id": "ee29ecbf.be8cd",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Off",
        "func": "msg.topic = \"coffee_table/rgb\"\nmsg.payload = \"0,0,0\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 1060,
        "wires": [
            []
        ]
    },
    {
        "id": "8fe0276f.d1b7a8",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Colour",
        "func": "msg.topic = \"coffee_table/rgb\"\nmsg.payload = msg.data.attributes.rgb_color.join(\",\");\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "4f5232e3.6d956c",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Colour",
        "func": "msg.topic = \"coffee_table/rgb\"\nmsg.payload = msg.data.event.new_state.attributes.rgb_color.join(\",\");\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "d8b87a2c.f84318",
        "type": "comment",
        "z": "152554cc.389edb",
        "name": "Update Values",
        "info": "Update the state variable on the coffee table",
        "x": 140,
        "y": 720,
        "wires": []
    },
    {
        "id": "52d19d76.808bf4",
        "type": "comment",
        "z": "152554cc.389edb",
        "name": "Handle Tag",
        "info": "",
        "x": 170,
        "y": 240,
        "wires": []
    },
    {
        "id": "e011d35a.1d8b1",
        "type": "file in",
        "z": "152554cc.389edb",
        "name": "Read Access Tags",
        "filename": "/share/authorized_tags",
        "format": "lines",
        "chunk": false,
        "sendError": false,
        "encoding": "utf8",
        "x": 830,
        "y": 80,
        "wires": [
            [
                "48d45ac0.ec5f84"
            ]
        ]
    },
    {
        "id": "53992fe7.40b8e",
        "type": "debug",
        "z": "152554cc.389edb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 1310,
        "y": 80,
        "wires": []
    },
    {
        "id": "6f4b6a83.b251e4",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Load into global",
        "func": "var count=global.get('tag_count') || 0;\n\nif (global.tag_count===undefined)//test exists\n{\n  global.tag_count=0;\n}\n\nglobal.set(\"Tags[\"+count+\"]\", msg.payload);\nglobal.set('tag_count', count + 1);\n\nmsg.payload = count\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1140,
        "y": 80,
        "wires": [
            [
                "53992fe7.40b8e"
            ]
        ]
    },
    {
        "id": "f11098a2.4b88f8",
        "type": "change",
        "z": "152554cc.389edb",
        "name": "Flush tags",
        "rules": [
            {
                "t": "delete",
                "p": "Tags",
                "pt": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 160,
        "wires": [
            [
                "28d375f9.d4d47a"
            ]
        ]
    },
    {
        "id": "28d375f9.d4d47a",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Reset Index",
        "func": "global.set(\"tag_count\", 0)\nglobal.set(\"spotify_tag_count\", 0)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 590,
        "y": 160,
        "wires": [
            [
                "e011d35a.1d8b1"
            ]
        ]
    },
    {
        "id": "d0249aa5.14afc8",
        "type": "inject",
        "z": "152554cc.389edb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "",
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 200,
        "y": 120,
        "wires": [
            [
                "f11098a2.4b88f8",
                "464e3e5d.1a4b5"
            ]
        ]
    },
    {
        "id": "aa02c509.209398",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Lock?",
        "func": "var count=global.get('tag_count') || 0;\nvar tag;\n\nfor(i=0; i<count; i++)\n{\n    tag = global.get(\"Tags[\"+i+\"]\");\n    if (tag==msg.payload)\n    {\n        msg.unlock = true\n        return msg;\n    }\n}\nmsg.unlock = false\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 330,
        "y": 300,
        "wires": [
            [
                "45f0144b.39d25c"
            ]
        ]
    },
    {
        "id": "deabd4b3.5c5048",
        "type": "debug",
        "z": "152554cc.389edb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 390,
        "y": 240,
        "wires": []
    },
    {
        "id": "48d45ac0.ec5f84",
        "type": "string",
        "z": "152554cc.389edb",
        "name": "strip",
        "methods": [
            {
                "name": "trim",
                "params": []
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 990,
        "y": 80,
        "wires": [
            [
                "6f4b6a83.b251e4"
            ]
        ]
    },
    {
        "id": "b386a47d.b53228",
        "type": "comment",
        "z": "152554cc.389edb",
        "name": "Load Tag table",
        "info": "",
        "x": 200,
        "y": 60,
        "wires": []
    },
    {
        "id": "fe74ad6.afe5a5",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Album?",
        "func": "var tags = global.get(\"SpotifyTags\");\n\nvar current_tag = flow.get(\"current_tag\")||0;\n\nnode.warn(\"Current tag: \" + current_tag);\nnode.warn(\"New tag: \" + msg.payload);\n\nif(current_tag > 0)\n{\n    if(current_tag==msg.payload)\n        return [null, msg]\n}\n\nfor(var i=0; i<tags.length; i++)\n{\n    // node.warn(tags[i].tag);\n    // node.warn(tags[i].uri);\n    if (tags[i].tag==msg.payload)\n    {\n        flow.set(\"current_tag\", msg.payload);\n        msg.payload = \n        {\n            data:\n            {\n                \"media_content_type\":tags[i].type,\n                \"media_content_id\":tags[i].uri\n            }\n        };\n        node.warn(\"Match\");\n        msg.uri_attached = true\n        return [msg, null];\n    }\n}\nnode.warn(\"No match\");\nmsg.uri_attached = false\nreturn [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "x": 360,
        "y": 480,
        "wires": [
            [
                "a2d03719.e5c5a8"
            ],
            []
        ]
    },
    {
        "id": "a2d03719.e5c5a8",
        "type": "switch",
        "z": "152554cc.389edb",
        "name": "Check",
        "property": "uri_attached",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 530,
        "y": 480,
        "wires": [
            [],
            [
                "cb97531.f1c1cb",
                "ab7054af.900578"
            ]
        ]
    },
    {
        "id": "a6cac5fd.85bd78",
        "type": "debug",
        "z": "152554cc.389edb",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 670,
        "y": 960,
        "wires": []
    },
    {
        "id": "16dd58a7.09dac7",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "persistent_notification",
        "service": "create",
        "entityId": "philip",
        "data": "{\"message\":\"Test\",\"title\":\"Test Message\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 960,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "cb97531.f1c1cb",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Show Tag",
        "func": "var tag = msg.payload\n\nmsg.payload = \n{\n    data:\n    {\n        \"message\": msg.payload,\n        \"title\": \"Unrecognised Tag\"\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 700,
        "y": 560,
        "wires": [
            [
                "16dd58a7.09dac7"
            ]
        ]
    },
    {
        "id": "ab7054af.900578",
        "type": "file",
        "z": "152554cc.389edb",
        "name": "save tag",
        "filename": "/share/unhandled_tags.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 720,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "fe90a99e.6e4dd8",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Next Track",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "media_next_track",
        "entityId": "media_player.spotify_phil",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 390,
        "y": 1740,
        "wires": [
            []
        ]
    },
    {
        "id": "464e3e5d.1a4b5",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Clear",
        "func": "flow.set(\"current_tag\", 0);",
        "outputs": 0,
        "noerr": 0,
        "x": 390,
        "y": 100,
        "wires": []
    },
    {
        "id": "a2c76ab5.966668",
        "type": "change",
        "z": "152554cc.389edb",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 419,
        "y": 1981,
        "wires": [
            [
                "22e23120.3afb9e",
                "41cf0984.925558"
            ]
        ]
    },
    {
        "id": "22e23120.3afb9e",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Select Source",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "media_player",
        "service": "select_source",
        "entityId": "media_player.spotify_phil",
        "data": "{\"source\":\"Onkyo TX-NR575E F3F71F\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 669,
        "y": 1961,
        "wires": [
            []
        ]
    },
    {
        "id": "cf41b9b3.0990f8",
        "type": "album-picker",
        "z": "152554cc.389edb",
        "name": "Coffee Table",
        "broker": "2eafe4c0.b7da5c",
        "qos": "0",
        "topic": "coffee_table/tags",
        "path": "/share/music_tags.json",
        "x": 210,
        "y": 1900,
        "wires": [
            [
                "a2c76ab5.966668",
                "8048bee3.1bf02"
            ]
        ]
    },
    {
        "id": "eba74ce6.1d2f6",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Play Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "play_media",
        "entityId": "media_player.spotify_phil",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 659,
        "y": 1881,
        "wires": [
            []
        ]
    },
    {
        "id": "41cf0984.925558",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Select Net",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "media_player",
        "service": "select_source",
        "entityId": "media_player.receiver",
        "data": "{\"source\": \"net\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 659,
        "y": 2021,
        "wires": [
            []
        ]
    },
    {
        "id": "8048bee3.1bf02",
        "type": "delay",
        "z": "152554cc.389edb",
        "name": "",
        "pauseType": "delay",
        "timeout": "600",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 419,
        "y": 1881,
        "wires": [
            [
                "eba74ce6.1d2f6"
            ]
        ]
    },
    {
        "id": "35dc5215.9bafde",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Btn1",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.btn1",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 1260,
        "wires": [
            [
                "cad2bc83.cdb2f",
                "ed698534.cb1608"
            ],
            []
        ]
    },
    {
        "id": "cad2bc83.cdb2f",
        "type": "subflow:8ed72877.93bc38",
        "z": "152554cc.389edb",
        "name": "",
        "env": [],
        "x": 370,
        "y": 1280,
        "wires": []
    },
    {
        "id": "ed698534.cb1608",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Low",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\": 128,\n        \"color_temp\": 367\n    }\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1220,
        "wires": [
            [
                "58371faa.d8a9"
            ]
        ]
    },
    {
        "id": "58371faa.d8a9",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 470,
        "y": 1220,
        "wires": [
            []
        ]
    },
    {
        "id": "9651055b.89f9c8",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Btn2",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.btn2",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 250,
        "y": 2440,
        "wires": [
            [
                "690fd1b7.62168"
            ],
            []
        ]
    },
    {
        "id": "690fd1b7.62168",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Toggle Receiver",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "media_player",
        "service": "toggle",
        "entityId": "media_player.receiver",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 440,
        "y": 2420,
        "wires": [
            []
        ]
    },
    {
        "id": "62b64030.40d47",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Btn3",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.btn3",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 250,
        "y": 2600,
        "wires": [
            [
                "51a0f78f.530378"
            ],
            []
        ]
    },
    {
        "id": "31a26218.a3289e",
        "type": "inject",
        "z": "152554cc.389edb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 2540,
        "wires": [
            [
                "51a0f78f.530378"
            ]
        ]
    },
    {
        "id": "51a0f78f.530378",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "",
        "func": "msg.raw = \"SLI12\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 630,
        "y": 2560,
        "wires": [
            [
                "c82a3854.7a4258"
            ]
        ]
    },
    {
        "id": "9976e6f9.e68648",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Brightness",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.encoder1",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "256",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 1360,
        "wires": [
            [],
            [
                "31af4df.af31ab2"
            ]
        ]
    },
    {
        "id": "31af4df.af31ab2",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Brightness",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":msg.payload\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 330,
        "y": 1360,
        "wires": [
            [
                "e6576337.4b9d1"
            ]
        ]
    },
    {
        "id": "e6576337.4b9d1",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Set Brightness",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 520,
        "y": 1360,
        "wires": [
            []
        ]
    },
    {
        "id": "305213fe.8c4a5c",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Temperature",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.encoder3",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "256",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 170,
        "y": 1460,
        "wires": [
            [],
            [
                "59484d13.56c084"
            ]
        ]
    },
    {
        "id": "59484d13.56c084",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "Brightness",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"temperature\": msg.payload, \n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 330,
        "y": 1460,
        "wires": [
            [
                "31f37eb.b25b282"
            ]
        ]
    },
    {
        "id": "31f37eb.b25b282",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Set Temperature",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "set_temperature",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 520,
        "y": 1460,
        "wires": [
            []
        ]
    },
    {
        "id": "eb5c6bf5.6dc988",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "AC Button",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.btn6",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 1540,
        "wires": [
            [
                "95f692d8.1290b"
            ],
            []
        ]
    },
    {
        "id": "95f692d8.1290b",
        "type": "subflow:a436e8cb.527cf8",
        "z": "152554cc.389edb",
        "name": "",
        "env": [],
        "x": 350,
        "y": 1540,
        "wires": []
    },
    {
        "id": "65d4f5f7.78aeec",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Lights Button",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.btne1",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 170,
        "y": 1620,
        "wires": [
            [
                "eb1a7660.99fb68"
            ],
            []
        ]
    },
    {
        "id": "eb1a7660.99fb68",
        "type": "api-call-service",
        "z": "152554cc.389edb",
        "name": "Lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 360,
        "y": 1620,
        "wires": [
            []
        ]
    },
    {
        "id": "c82a3854.7a4258",
        "type": "eiscp-out",
        "z": "152554cc.389edb",
        "name": "Send",
        "controller": "7bee2da5.7b1c14",
        "x": 770,
        "y": 2560,
        "wires": []
    },
    {
        "id": "f2000e8.6ed0bf",
        "type": "eiscp-in",
        "z": "152554cc.389edb",
        "name": "",
        "controller": "7bee2da5.7b1c14",
        "x": 790,
        "y": 2480,
        "wires": [
            [
                "efbdfd5c.af58c"
            ]
        ]
    },
    {
        "id": "efbdfd5c.af58c",
        "type": "debug",
        "z": "152554cc.389edb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 2480,
        "wires": []
    },
    {
        "id": "9b55d77d.867258",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Next Track Button",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.btn4",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 190,
        "y": 1740,
        "wires": [
            [
                "fe90a99e.6e4dd8"
            ],
            []
        ]
    },
    {
        "id": "9ddc3a34.980d38",
        "type": "function",
        "z": "152554cc.389edb",
        "name": "FSM",
        "func": "var state = global.get(\"lounge_scene\") || \"off\";\n\nswitch(state)\n{\n    default:\n    case \"off\":\n        return[msg, null, null, null];\n\n    case \"warm\":\n        return[null, msg, null, null];\n\n    case \"medium\":\n        return[null, null, msg, null];\n\n    case \"bright\":\n        return[null, null, null, msg];\n}\n",
        "outputs": 4,
        "noerr": 0,
        "x": 930,
        "y": 1640,
        "wires": [
            [
                "d5b7a2be.50455"
            ],
            [
                "100320b1.c1354f"
            ],
            [
                "952d92a1.9db75"
            ],
            [
                "a12a8448.67bf48"
            ]
        ]
    },
    {
        "id": "d5b7a2be.50455",
        "type": "subflow:8e0a986b.ca0ef8",
        "z": "152554cc.389edb",
        "name": "",
        "env": [],
        "x": 1140,
        "y": 1600,
        "wires": []
    },
    {
        "id": "100320b1.c1354f",
        "type": "subflow:f39f57bd.f82a58",
        "z": "152554cc.389edb",
        "name": "",
        "env": [],
        "x": 1150,
        "y": 1640,
        "wires": []
    },
    {
        "id": "952d92a1.9db75",
        "type": "subflow:8b2696b9.77c108",
        "z": "152554cc.389edb",
        "name": "",
        "x": 1140,
        "y": 1680,
        "wires": []
    },
    {
        "id": "a12a8448.67bf48",
        "type": "subflow:8e0a986b.ca0ef8",
        "z": "152554cc.389edb",
        "name": "",
        "env": [],
        "x": 1140,
        "y": 1720,
        "wires": []
    },
    {
        "id": "2122a6d.283b25a",
        "type": "server-state-changed",
        "z": "152554cc.389edb",
        "name": "Scene Button",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.btn5",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 770,
        "y": 1640,
        "wires": [
            [
                "9ddc3a34.980d38"
            ],
            []
        ]
    },
    {
        "id": "951ebb1b.aedb38",
        "type": "comment",
        "z": "86a3c02f.3051a",
        "name": "TRIGGER ALARM CLOCK",
        "info": "",
        "x": 230,
        "y": 120,
        "wires": []
    },
    {
        "id": "21a768bf.736828",
        "type": "join",
        "z": "86a3c02f.3051a",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "2",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 1170,
        "y": 140,
        "wires": [
            [
                "72ba238c.949acc"
            ]
        ]
    },
    {
        "id": "72ba238c.949acc",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Compare Times",
        "func": "newmsg = {};\nif (msg.payload[0] == msg.payload[1]) {\n    newmsg.payload = \"True\";\n} else {\n    newmsg.payload = \"False\";\n}\n\nreturn newmsg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1180,
        "y": 200,
        "wires": [
            [
                "f1ba2345.5cc9a"
            ]
        ]
    },
    {
        "id": "f1ba2345.5cc9a",
        "type": "switch",
        "z": "86a3c02f.3051a",
        "name": "Is it Time?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "True",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1190,
        "y": 260,
        "wires": [
            [
                "49b0602e.96e57",
                "e7230f88.15f9e"
            ]
        ]
    },
    {
        "id": "617433c5.87712c",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Alarm Clock ON?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.alarm_clock_enabled",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 610,
        "y": 180,
        "wires": [
            [
                "a31fd267.fff56",
                "66f16d49.ceea74"
            ],
            []
        ]
    },
    {
        "id": "a31fd267.fff56",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Get Alarm Time",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 1,
        "halt_if": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_datetime.alarmclock_time",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 920,
        "y": 260,
        "wires": [
            [
                "1197e274.51606e"
            ]
        ]
    },
    {
        "id": "66f16d49.ceea74",
        "type": "moment",
        "z": "86a3c02f.3051a",
        "name": "Current Time",
        "topic": "",
        "input": "",
        "inputType": "date",
        "inTz": "Africa/Johannesburg",
        "adjAmount": "0",
        "adjType": "minutes",
        "adjDir": "add",
        "format": "H:mm",
        "locale": "C",
        "output": "payload",
        "outputType": "msg",
        "outTz": "Africa/Johannesburg",
        "x": 930,
        "y": 140,
        "wires": [
            [
                "21a768bf.736828"
            ]
        ]
    },
    {
        "id": "4ed7e717.239db8",
        "type": "inject",
        "z": "86a3c02f.3051a",
        "name": "",
        "repeat": "60",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 210,
        "y": 180,
        "wires": [
            [
                "801b6b718dab920c"
            ]
        ]
    },
    {
        "id": "1197e274.51606e",
        "type": "moment",
        "z": "86a3c02f.3051a",
        "name": "Alarm - 10min",
        "topic": "",
        "input": "payload",
        "inputType": "msg",
        "inTz": "Africa/Johannesburg",
        "adjAmount": "10",
        "adjType": "minutes",
        "adjDir": "subtract",
        "format": "H:mm",
        "locale": "C",
        "output": "payload",
        "outputType": "msg",
        "outTz": "Africa/Johannesburg",
        "x": 920,
        "y": 200,
        "wires": [
            [
                "21a768bf.736828"
            ]
        ]
    },
    {
        "id": "49b0602e.96e57",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Activate Alarm",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "input_boolean",
        "service": "turn_on",
        "entityId": "input_boolean.alarm_clock_active",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 1440,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "f261c354.9a785",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Alarm Start",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "input_boolean.alarm_clock_active",
        "entityidfiltertype": "substring",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 220,
        "y": 440,
        "wires": [
            [
                "3dea446c.b5e58c",
                "9299d151.36775",
                "f5a1195c.b49328"
            ],
            []
        ]
    },
    {
        "id": "b37f9998.3759e8",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Sunrise Effect",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"effect\": \"Sunrise\"\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 740,
        "y": 440,
        "wires": [
            [
                "4d54e0ea.338b1"
            ]
        ]
    },
    {
        "id": "4d54e0ea.338b1",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 960,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "45474777.933ac8",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Music Enabled",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.alarm_clock_music",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 720,
        "y": 520,
        "wires": [
            [
                "749d4018.ec617"
            ],
            []
        ]
    },
    {
        "id": "3dea446c.b5e58c",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Lights Enabled",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.alarm_clock_lights",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 520,
        "y": 440,
        "wires": [
            [
                "b37f9998.3759e8"
            ],
            []
        ]
    },
    {
        "id": "749d4018.ec617",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Load Playlist",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"device_name\":\"Bedroom speaker\",\n        \"uri\":\"spotify:playlist:37i9dQZF1DX1rVvRgjX59F\",\n        \"random_song\": true\n    }\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 970,
        "y": 520,
        "wires": [
            [
                "e2c10bbd.552c28"
            ]
        ]
    },
    {
        "id": "dea0e52f.d0eb08",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Spotcast",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "spotcast",
        "service": "start",
        "entityId": "bitbrain-za",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1360,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "777251bb.27d0f",
        "type": "delay",
        "z": "86a3c02f.3051a",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 580,
        "y": 640,
        "wires": [
            [
                "209f25f6.5060ea"
            ]
        ]
    },
    {
        "id": "9e7d566f.c0eeb8",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "Snooze",
        "links": [
            "e06d236.84368e",
            "82945f71.39555"
        ],
        "x": 135,
        "y": 700,
        "wires": [
            [
                "6ac50ad7.b3eb24"
            ]
        ]
    },
    {
        "id": "a2dbb7bf.7abb28",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "House State - Waking Up",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "turn_on",
        "entityId": "input_boolean.alarm_clock_active",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 1030,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "8e96267b.55e438",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Alarm Deactivate",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.alarm_clock_active",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 570,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "6ac50ad7.b3eb24",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Alarm Active?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.alarm_clock_active",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 300,
        "y": 700,
        "wires": [
            [
                "777251bb.27d0f",
                "8e96267b.55e438",
                "fd44a722.43ea38",
                "d2ec98c7.e44a18",
                "bbb99ab7.14d918"
            ],
            []
        ]
    },
    {
        "id": "e7230f88.15f9e",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Turn Off AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1410,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "4d7464c1.e964ec",
        "type": "inject",
        "z": "86a3c02f.3051a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 600,
        "wires": [
            [
                "6ac50ad7.b3eb24"
            ]
        ]
    },
    {
        "id": "209f25f6.5060ea",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Snooze Still On",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.alarm_clock_snooze",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 760,
        "y": 640,
        "wires": [
            [
                "a2dbb7bf.7abb28"
            ],
            []
        ]
    },
    {
        "id": "bbb99ab7.14d918",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Snooze On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "turn_on",
        "entityId": "input_boolean.alarm_clock_snooze",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 550,
        "y": 840,
        "wires": [
            []
        ]
    },
    {
        "id": "d2ec98c7.e44a18",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Pause Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "media_pause",
        "entityId": "media_player.spotify_phil",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 550,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "fd44a722.43ea38",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "80d3f246.1704d",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "links": [
            "d9a5db38.3dd488"
        ],
        "x": 495,
        "y": 1460,
        "wires": [
            [
                "5b454d26.040844"
            ]
        ]
    },
    {
        "id": "5b454d26.040844",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Lights on?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.bedside",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 650,
        "y": 1460,
        "wires": [
            [
                "885c2d4.b0f47d"
            ],
            [
                "fdf37a8d.98bfc8"
            ]
        ]
    },
    {
        "id": "885c2d4.b0f47d",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 880,
        "y": 1420,
        "wires": [
            []
        ]
    },
    {
        "id": "fdf37a8d.98bfc8",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 880,
        "y": 1500,
        "wires": [
            [
                "2b5d7415.f3b63c"
            ],
            [
                "cf2d2127.960e"
            ]
        ]
    },
    {
        "id": "380edbd6.9993a4",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Red",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness_pct\":20,\n        \"rgb_color\":[255,0,0]\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1350,
        "y": 1440,
        "wires": [
            [
                "64914934.088278"
            ]
        ]
    },
    {
        "id": "64914934.088278",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1520,
        "y": 1520,
        "wires": [
            []
        ]
    },
    {
        "id": "cf2d2127.960e",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "White",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":268\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1090,
        "y": 1540,
        "wires": [
            [
                "64914934.088278"
            ]
        ]
    },
    {
        "id": "9299d151.36775",
        "type": "stoptimer",
        "z": "86a3c02f.3051a",
        "duration": "40",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 640,
        "y": 340,
        "wires": [
            [
                "bf9efdec.52f43",
                "3fc373d6.eae9fc"
            ],
            []
        ]
    },
    {
        "id": "bf9efdec.52f43",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "House State - Awake",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.alarm_clock_active",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 900,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "3fc373d6.eae9fc",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Snooze Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.alarm_clock_snooze",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 870,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "8a4be04.d03a02",
        "type": "comment",
        "z": "86a3c02f.3051a",
        "name": "end alarm",
        "info": "",
        "x": 800,
        "y": 760,
        "wires": []
    },
    {
        "id": "8212694c.b17548",
        "type": "comment",
        "z": "86a3c02f.3051a",
        "name": "Click, no alarm. Toggle Lights",
        "info": "",
        "x": 260,
        "y": 1380,
        "wires": []
    },
    {
        "id": "e50adb11.c46a18",
        "type": "comment",
        "z": "86a3c02f.3051a",
        "name": "Click - Snooze",
        "info": "",
        "x": 350,
        "y": 640,
        "wires": []
    },
    {
        "id": "1e21be76.0fb3d2",
        "type": "inject",
        "z": "86a3c02f.3051a",
        "name": "",
        "repeat": "",
        "crontab": "30 21 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 1940,
        "wires": [
            [
                "e0c82f7a.cbcf2"
            ]
        ]
    },
    {
        "id": "4e000c83.7f4064",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": ">21C",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "21",
        "halt_if_type": "num",
        "halt_if_compare": "gte",
        "entity_id": "sensor.bedroom_climate_temperature",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 630,
        "y": 1940,
        "wires": [
            [
                "c0cacb9.4e5fe38"
            ],
            []
        ]
    },
    {
        "id": "c0cacb9.4e5fe38",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Turn on Bedroom AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 820,
        "y": 1940,
        "wires": [
            []
        ]
    },
    {
        "id": "d435cd2c.9e625",
        "type": "inject",
        "z": "86a3c02f.3051a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 1900,
        "wires": [
            [
                "4fec6130.5aecc"
            ]
        ]
    },
    {
        "id": "4fec6130.5aecc",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "<20C",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "19",
        "halt_if_type": "num",
        "halt_if_compare": "lt",
        "entity_id": "sensor.bedroom_climate_temperature",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 290,
        "y": 1900,
        "wires": [
            [
                "c003dc92.b56e2"
            ],
            []
        ]
    },
    {
        "id": "ade9b26c.b2bd7",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Turn off Bedroom AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 820,
        "y": 1880,
        "wires": [
            []
        ]
    },
    {
        "id": "8da65476.5ce448",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Door",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "binary_sensor.bedroom_door_contact",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 180,
        "y": 2380,
        "wires": [
            [
                "121d2ade.800e85"
            ],
            [
                "a4fe8742.4259b8"
            ]
        ]
    },
    {
        "id": "18e4dbe1.07c2c4",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": ">21C",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "21",
        "halt_if_type": "num",
        "halt_if_compare": "gte",
        "entity_id": "sensor.bedroom_climate_temperature",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 770,
        "y": 2320,
        "wires": [
            [
                "bc3a00b9.8ba51"
            ],
            []
        ]
    },
    {
        "id": "bc3a00b9.8ba51",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Turn on Bedroom AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1000,
        "y": 2320,
        "wires": [
            []
        ]
    },
    {
        "id": "30a3034b.ccd10c",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Turn off Bedroom AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 940,
        "y": 2440,
        "wires": [
            []
        ]
    },
    {
        "id": "d8f42877.d8c0f8",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Red",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness_pct\":20,\n        \"rgb_color\":[255,0,0]\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 790,
        "y": 2160,
        "wires": [
            [
                "75dd0ebf.d22e4"
            ]
        ]
    },
    {
        "id": "75dd0ebf.d22e4",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 980,
        "y": 2200,
        "wires": [
            []
        ]
    },
    {
        "id": "dea95ee7.21b3e",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "White",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":268\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 790,
        "y": 2240,
        "wires": [
            [
                "75dd0ebf.d22e4"
            ]
        ]
    },
    {
        "id": "396f8727.f1fb08",
        "type": "delay",
        "z": "86a3c02f.3051a",
        "name": "",
        "pauseType": "delay",
        "timeout": "60",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 580,
        "y": 2440,
        "wires": [
            [
                "2e946082.437e7"
            ]
        ]
    },
    {
        "id": "2e946082.437e7",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Still Open?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.bedroom_door_contact",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 750,
        "y": 2440,
        "wires": [
            [
                "30a3034b.ccd10c"
            ],
            []
        ]
    },
    {
        "id": "e0c82f7a.cbcf2",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Philip is home",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "device_tracker.philip",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 300,
        "y": 1940,
        "wires": [
            [
                "179f204a.a7659"
            ],
            []
        ]
    },
    {
        "id": "e2c10bbd.552c28",
        "type": "delay",
        "z": "86a3c02f.3051a",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1170,
        "y": 520,
        "wires": [
            [
                "dea0e52f.d0eb08"
            ]
        ]
    },
    {
        "id": "179f204a.a7659",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "AC Off?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.bedroom_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 480,
        "y": 1940,
        "wires": [
            [
                "4e000c83.7f4064"
            ],
            []
        ]
    },
    {
        "id": "35b114f7.13131c",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "AC Off?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.bedroom_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 600,
        "y": 2320,
        "wires": [
            [
                "18e4dbe1.07c2c4"
            ],
            []
        ]
    },
    {
        "id": "121d2ade.800e85",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Jen isn't home",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "device_tracker.janice",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 360,
        "y": 2220,
        "wires": [
            [
                "35b114f7.13131c",
                "f28d3668.2bb1a8"
            ],
            []
        ]
    },
    {
        "id": "a4fe8742.4259b8",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Jen isn't home",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "device_tracker.janice",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 380,
        "y": 2440,
        "wires": [
            [
                "396f8727.f1fb08"
            ],
            []
        ]
    },
    {
        "id": "f5a1195c.b49328",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Jen isn't home",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "device_tracker.janice",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 500,
        "y": 520,
        "wires": [
            [
                "45474777.933ac8"
            ],
            []
        ]
    },
    {
        "id": "2b5d7415.f3b63c",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Jen is home",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "device_tracker.janice",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1170,
        "y": 1400,
        "wires": [
            [
                "b182682b.28ec88"
            ],
            [
                "380edbd6.9993a4"
            ]
        ]
    },
    {
        "id": "b182682b.28ec88",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "2500K",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\": 2500\n    }\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1350,
        "y": 1360,
        "wires": [
            [
                "7af7964b.fff728"
            ]
        ]
    },
    {
        "id": "7af7964b.fff728",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedside light",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedside",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1510,
        "y": 1360,
        "wires": [
            []
        ]
    },
    {
        "id": "1918ffef.e49bc",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bedroom_opple_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 250,
        "y": 2701,
        "wires": [
            [
                "2067f03.eeeff1"
            ]
        ]
    },
    {
        "id": "2067f03.eeeff1",
        "type": "switch",
        "z": "86a3c02f.3051a",
        "name": "single",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_single",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 450,
        "y": 2700,
        "wires": [
            [
                "d9a5db38.3dd488"
            ],
            [
                "a4349205.4f416"
            ],
            [
                "ecb65bc.88b81a8"
            ],
            [
                "34046dde.b1a982"
            ],
            [
                "6cff567f.40b4a8"
            ],
            [
                "e06d236.84368e"
            ]
        ]
    },
    {
        "id": "4b1514ec.ad6dfc",
        "type": "switch",
        "z": "86a3c02f.3051a",
        "name": "double",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_double",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 490,
        "y": 2960,
        "wires": [
            [
                "11459c8a.a33683"
            ],
            [
                "31ddd45e.0b4cac"
            ],
            [
                "1d746c7c.baf564"
            ],
            [
                "a9bf9f0a.82a35"
            ],
            [
                "da8410dc.c4efb"
            ],
            [
                "b7fa2389.cb31c"
            ]
        ]
    },
    {
        "id": "80e4cd35.97686",
        "type": "switch",
        "z": "86a3c02f.3051a",
        "name": "triple",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_triple",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 450,
        "y": 3200,
        "wires": [
            [
                "415d5c59.0555d4"
            ],
            [
                "dcd87f7.c73938"
            ],
            [
                "f47ee88.9eded18"
            ],
            [
                "19d0807.2d2358"
            ],
            [
                "43d9c89a.c27918"
            ],
            [
                "6ae5fa51.d751f4"
            ]
        ]
    },
    {
        "id": "36d6a35d.ddf50c",
        "type": "switch",
        "z": "86a3c02f.3051a",
        "name": "hold",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_hold",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 1150,
        "y": 2940,
        "wires": [
            [
                "12a63878.219638"
            ],
            [
                "14f02eb6.fe9571"
            ],
            [
                "d84facd0.c9282"
            ],
            [
                "7312eb7f.e70bf4"
            ],
            [
                "ea6bbc82.82f17"
            ],
            [
                "7f2493cd.3beccc"
            ]
        ]
    },
    {
        "id": "393ca0b.dbbef6",
        "type": "switch",
        "z": "86a3c02f.3051a",
        "name": "release",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_release",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 1120,
        "y": 3240,
        "wires": [
            [
                "93402c0c.8b53c"
            ],
            [
                "a315f89f.3f4c98"
            ],
            [
                "b30cef06.ff3a3"
            ],
            [
                "50ab7e82.1416f"
            ],
            [
                "7db21d3c.ae48d4"
            ],
            [
                "981da16a.718ae"
            ]
        ]
    },
    {
        "id": "99e8dc82.23388",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bedroom_opple_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 280,
        "y": 2960,
        "wires": [
            [
                "4b1514ec.ad6dfc"
            ]
        ]
    },
    {
        "id": "8b979331.be14b",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bedroom_opple_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 240,
        "y": 3200,
        "wires": [
            [
                "80e4cd35.97686"
            ]
        ]
    },
    {
        "id": "88b9d936.048558",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bedroom_opple_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 940,
        "y": 2940,
        "wires": [
            [
                "36d6a35d.ddf50c"
            ]
        ]
    },
    {
        "id": "af54d559.45e8f8",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bedroom_opple_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 880,
        "y": 3240,
        "wires": [
            [
                "393ca0b.dbbef6"
            ]
        ]
    },
    {
        "id": "6e4f9398.ee8dbc",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "test_alarm",
        "links": [
            "981da16a.718ae",
            "5097dd8.57d3324"
        ],
        "x": 1075,
        "y": 80,
        "wires": [
            [
                "3fb0447a.234cac"
            ]
        ]
    },
    {
        "id": "3fb0447a.234cac",
        "type": "change",
        "z": "86a3c02f.3051a",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1230,
        "y": 80,
        "wires": [
            [
                "49b0602e.96e57"
            ]
        ]
    },
    {
        "id": "d35e8c79.9d01",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "test_sunrise",
        "links": [
            "415d5c59.0555d4",
            "c29913f3.e1294"
        ],
        "x": 535,
        "y": 380,
        "wires": [
            [
                "b37f9998.3759e8"
            ]
        ]
    },
    {
        "id": "bcc52891.957498",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "test_music",
        "links": [
            "7db21d3c.ae48d4",
            "64eebe68.3a324"
        ],
        "x": 815,
        "y": 580,
        "wires": [
            [
                "749d4018.ec617"
            ]
        ]
    },
    {
        "id": "a77b91ff.73656",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Alarm Deactivate",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.alarm_clock_active",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 1190,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "eda71e98.500df",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Snooze Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.alarm_clock_snooze",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1170,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "c9d5c602.f1c548",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Pause Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "media_pause",
        "entityId": "media_player.spotify_phil",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1170,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "24414cbd.4fc394",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Dawn",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\": \"2500\"\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1150,
        "y": 920,
        "wires": [
            [
                "ee43e9b0.2db968"
            ]
        ]
    },
    {
        "id": "ee43e9b0.2db968",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1380,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "29fbf2aa.b63bbe",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Alarm Active",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.alarm_clock_active",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 910,
        "y": 800,
        "wires": [
            [
                "c9d5c602.f1c548",
                "eda71e98.500df",
                "a77b91ff.73656",
                "24414cbd.4fc394"
            ],
            []
        ]
    },
    {
        "id": "43094572.0ec00c",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "Alarm Off",
        "links": [
            "b7fa2389.cb31c",
            "d0e20c4e.45093"
        ],
        "x": 775,
        "y": 800,
        "wires": [
            [
                "29fbf2aa.b63bbe"
            ]
        ]
    },
    {
        "id": "a9ed2923.5e34b8",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "toggle bedtime",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "toggle",
        "entityId": "input_boolean.bedtime",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 280,
        "y": 1180,
        "wires": [
            [
                "388b49ea.253266"
            ]
        ]
    },
    {
        "id": "65c8d81a.0be9d8",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "bedtime",
        "links": [
            "11459c8a.a33683",
            "3e1b51f8.b9e39e",
            "b207c8d0b7426074"
        ],
        "x": 135,
        "y": 1180,
        "wires": [
            [
                "a9ed2923.5e34b8"
            ]
        ]
    },
    {
        "id": "388b49ea.253266",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 480,
        "y": 1180,
        "wires": [
            [
                "553f4611.a4b348",
                "82fa3bdf.190b98"
            ],
            [
                "35aae9c5.aa54a6"
            ]
        ]
    },
    {
        "id": "553f4611.a4b348",
        "type": "subflow:ca5a8b67.211fb8",
        "z": "86a3c02f.3051a",
        "name": "",
        "env": [],
        "x": 740,
        "y": 1080,
        "wires": [
            [
                "896a067c.ebb578"
            ]
        ]
    },
    {
        "id": "82fa3bdf.190b98",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Jen is home",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "device_tracker.janice",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 750,
        "y": 1160,
        "wires": [
            [
                "768bbf95.1f911",
                "66b73133.47373"
            ],
            [
                "c5c9f1ac.25242"
            ]
        ]
    },
    {
        "id": "35aae9c5.aa54a6",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "White",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":268\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 810,
        "y": 1260,
        "wires": [
            [
                "c3586ac0.8a9f38"
            ]
        ]
    },
    {
        "id": "896a067c.ebb578",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 855,
        "y": 1080,
        "wires": []
    },
    {
        "id": "768bbf95.1f911",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Ceiling",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bedroom_ceiling",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1150,
        "y": 1180,
        "wires": [
            []
        ]
    },
    {
        "id": "66b73133.47373",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Sunset Effect",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"effect\": \"Sunset\"\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1030,
        "y": 1060,
        "wires": [
            [
                "c3901d75.869cd",
                "1bb71cc5.7908e3"
            ]
        ]
    },
    {
        "id": "c5c9f1ac.25242",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Red",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness_pct\":20,\n        \"rgb_color\":[255,0,0]\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1010,
        "y": 1220,
        "wires": [
            [
                "c3586ac0.8a9f38"
            ]
        ]
    },
    {
        "id": "c3586ac0.8a9f38",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1220,
        "y": 1260,
        "wires": [
            []
        ]
    },
    {
        "id": "c3901d75.869cd",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedside",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedside",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1200,
        "y": 1020,
        "wires": [
            []
        ]
    },
    {
        "id": "1bb71cc5.7908e3",
        "type": "delay",
        "z": "86a3c02f.3051a",
        "name": "",
        "pauseType": "delay",
        "timeout": "15",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1210,
        "y": 1080,
        "wires": [
            [
                "69dd1164.8b1c7"
            ]
        ]
    },
    {
        "id": "69dd1164.8b1c7",
        "type": "change",
        "z": "86a3c02f.3051a",
        "name": "Delete",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1380,
        "y": 1080,
        "wires": [
            [
                "4172e866.f046e8"
            ]
        ]
    },
    {
        "id": "4172e866.f046e8",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "bedside",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bedside",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1550,
        "y": 1080,
        "wires": [
            []
        ]
    },
    {
        "id": "56b6c0fc.dba4b",
        "type": "comment",
        "z": "86a3c02f.3051a",
        "name": " Bedtime automations",
        "info": "",
        "x": 220,
        "y": 1100,
        "wires": []
    },
    {
        "id": "d9a5db38.3dd488",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "80d3f246.1704d"
        ],
        "x": 635,
        "y": 2560,
        "wires": []
    },
    {
        "id": "e06d236.84368e",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "9e7d566f.c0eeb8"
        ],
        "x": 635,
        "y": 2800,
        "wires": []
    },
    {
        "id": "11459c8a.a33683",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "65c8d81a.0be9d8"
        ],
        "x": 635,
        "y": 2860,
        "wires": []
    },
    {
        "id": "31ddd45e.0b4cac",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "f1d449e0.dca418"
        ],
        "x": 635,
        "y": 2900,
        "wires": []
    },
    {
        "id": "1d746c7c.baf564",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 635,
        "y": 2940,
        "wires": []
    },
    {
        "id": "a9bf9f0a.82a35",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 635,
        "y": 2980,
        "wires": []
    },
    {
        "id": "da8410dc.c4efb",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 635,
        "y": 3020,
        "wires": []
    },
    {
        "id": "b7fa2389.cb31c",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "43094572.0ec00c"
        ],
        "x": 635,
        "y": 3060,
        "wires": []
    },
    {
        "id": "415d5c59.0555d4",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "d35e8c79.9d01"
        ],
        "x": 635,
        "y": 3120,
        "wires": []
    },
    {
        "id": "dcd87f7.c73938",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 635,
        "y": 3160,
        "wires": []
    },
    {
        "id": "f47ee88.9eded18",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 635,
        "y": 3200,
        "wires": []
    },
    {
        "id": "19d0807.2d2358",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 635,
        "y": 3240,
        "wires": []
    },
    {
        "id": "43d9c89a.c27918",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 635,
        "y": 3280,
        "wires": []
    },
    {
        "id": "6ae5fa51.d751f4",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "de1e9a6a.a5e5c8"
        ],
        "x": 635,
        "y": 3320,
        "wires": []
    },
    {
        "id": "12a63878.219638",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 2860,
        "wires": []
    },
    {
        "id": "14f02eb6.fe9571",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 2900,
        "wires": []
    },
    {
        "id": "d84facd0.c9282",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 2940,
        "wires": []
    },
    {
        "id": "7312eb7f.e70bf4",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 2980,
        "wires": []
    },
    {
        "id": "ea6bbc82.82f17",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 3020,
        "wires": []
    },
    {
        "id": "7f2493cd.3beccc",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 3060,
        "wires": []
    },
    {
        "id": "93402c0c.8b53c",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 3160,
        "wires": []
    },
    {
        "id": "a315f89f.3f4c98",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 3200,
        "wires": []
    },
    {
        "id": "b30cef06.ff3a3",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 3240,
        "wires": []
    },
    {
        "id": "50ab7e82.1416f",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [],
        "x": 1295,
        "y": 3280,
        "wires": []
    },
    {
        "id": "7db21d3c.ae48d4",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "bcc52891.957498"
        ],
        "x": 1295,
        "y": 3320,
        "wires": []
    },
    {
        "id": "981da16a.718ae",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "6e4f9398.ee8dbc"
        ],
        "x": 1295,
        "y": 3360,
        "wires": []
    },
    {
        "id": "f1d449e0.dca418",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "sunset",
        "links": [
            "31ddd45e.0b4cac",
            "f818c289.370bc"
        ],
        "x": 975,
        "y": 1120,
        "wires": [
            [
                "66b73133.47373",
                "768bbf95.1f911"
            ]
        ]
    },
    {
        "id": "4a02a736.505628",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedside",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.bedside",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 980,
        "y": 2580,
        "wires": [
            []
        ]
    },
    {
        "id": "4d483b89.148c84",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "AC state",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.bedroom_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 900,
        "y": 2680,
        "wires": [
            [
                "10eb1bc6.e3f804"
            ],
            [
                "52765020.5846b"
            ]
        ]
    },
    {
        "id": "10eb1bc6.e3f804",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "AC On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1070,
        "y": 2660,
        "wires": [
            []
        ]
    },
    {
        "id": "52765020.5846b",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "AC Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1070,
        "y": 2720,
        "wires": [
            []
        ]
    },
    {
        "id": "ecb65bc.88b81a8",
        "type": "change",
        "z": "86a3c02f.3051a",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 2680,
        "wires": [
            [
                "4d483b89.148c84"
            ]
        ]
    },
    {
        "id": "34046dde.b1a982",
        "type": "subflow:ca5a8b67.211fb8",
        "z": "86a3c02f.3051a",
        "name": "",
        "env": [],
        "x": 700,
        "y": 2720,
        "wires": [
            [
                "5e8370.2ac0ac9"
            ]
        ]
    },
    {
        "id": "5e8370.2ac0ac9",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 815,
        "y": 2720,
        "wires": []
    },
    {
        "id": "de1e9a6a.a5e5c8",
        "type": "link in",
        "z": "86a3c02f.3051a",
        "name": "Nap",
        "links": [
            "6ae5fa51.d751f4",
            "8f5463ec.8c14f"
        ],
        "x": 1395,
        "y": 40,
        "wires": [
            [
                "ce1bbf8d.7d482",
                "a766b36e.8aca5"
            ]
        ]
    },
    {
        "id": "ce1bbf8d.7d482",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Lights Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bedroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1710,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "a766b36e.8aca5",
        "type": "stoptimer",
        "z": "86a3c02f.3051a",
        "duration": "20",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 1560,
        "y": 120,
        "wires": [
            [
                "49b0602e.96e57"
            ],
            []
        ]
    },
    {
        "id": "48b65b67.b72c04",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Ceiling Light",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bedroom_ceiling",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 990,
        "y": 2540,
        "wires": [
            []
        ]
    },
    {
        "id": "a4349205.4f416",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Ceiling On?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.bedroom_ceiling",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 820,
        "y": 2560,
        "wires": [
            [
                "48b65b67.b72c04",
                "80409d9f.9ba0c"
            ],
            [
                "4a02a736.505628"
            ]
        ]
    },
    {
        "id": "80409d9f.9ba0c",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Bedside",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedside",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 980,
        "y": 2500,
        "wires": [
            []
        ]
    },
    {
        "id": "cd347e09.63961",
        "type": "subflow:81d9975e.584f98",
        "z": "86a3c02f.3051a",
        "name": "",
        "env": [],
        "x": 1470,
        "y": 380,
        "wires": []
    },
    {
        "id": "c003dc92.b56e2",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.bedroom_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 540,
        "y": 1880,
        "wires": [
            [
                "ade9b26c.b2bd7"
            ],
            []
        ]
    },
    {
        "id": "6cff567f.40b4a8",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "MES Light On?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.mes",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 960,
        "y": 2800,
        "wires": [
            [
                "d6637fc4.1e618"
            ],
            [
                "b96d9208.2a5ff"
            ]
        ]
    },
    {
        "id": "d6637fc4.1e618",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.mes",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1450,
        "y": 2720,
        "wires": [
            []
        ]
    },
    {
        "id": "b96d9208.2a5ff",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 1480,
        "y": 2800,
        "wires": [
            [
                "fe9eb723.223bd8"
            ],
            [
                "13444265.27c98e"
            ]
        ]
    },
    {
        "id": "fe9eb723.223bd8",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Dim",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":102,\n        \"color_temp\":500\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1690,
        "y": 2760,
        "wires": [
            [
                "dfc76330.89044"
            ]
        ]
    },
    {
        "id": "dfc76330.89044",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Light On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.mes",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1860,
        "y": 2800,
        "wires": [
            []
        ]
    },
    {
        "id": "13444265.27c98e",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "Bright",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":255,\n        \"color_temp\":200\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1690,
        "y": 2840,
        "wires": [
            [
                "dfc76330.89044"
            ]
        ]
    },
    {
        "id": "1080cc9bb6e12aa9",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Enter Bed",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bed_scale",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "80",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 100,
        "y": 3500,
        "wires": [
            [
                "69796571e9f03f84"
            ],
            []
        ]
    },
    {
        "id": "2401f3e481de708e",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Exit Bed",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bed_scale",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "10",
        "halt_if_type": "num",
        "halt_if_compare": "lt",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 200,
        "y": 3580,
        "wires": [
            [
                "248b21c2604b15ec"
            ],
            []
        ]
    },
    {
        "id": "b207c8d0b7426074",
        "type": "link out",
        "z": "86a3c02f.3051a",
        "name": "",
        "links": [
            "65c8d81a.0be9d8"
        ],
        "x": 895,
        "y": 3420,
        "wires": []
    },
    {
        "id": "fae5fa453867687f",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "Not already bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 740,
        "y": 3440,
        "wires": [
            [
                "b207c8d0b7426074",
                "409bf29e1c1e5ae0"
            ],
            [
                "bfae7a1bef4eeb26",
                "7b04bdf6fe3a6fb8",
                "75886106291fcd7b"
            ]
        ]
    },
    {
        "id": "caae24a520a41c2d",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "Mes Light",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.mes",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 920,
        "y": 3580,
        "wires": [
            []
        ]
    },
    {
        "id": "bfae7a1bef4eeb26",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.mes",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1030,
        "y": 3480,
        "wires": [
            []
        ]
    },
    {
        "id": "7b04bdf6fe3a6fb8",
        "type": "subflow:ca5a8b67.211fb8",
        "z": "86a3c02f.3051a",
        "name": "",
        "env": [],
        "x": 1000,
        "y": 3540,
        "wires": [
            []
        ]
    },
    {
        "id": "f28d3668.2bb1a8",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "After Bedtime",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.bedtime",
        "state_type": "habool",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 580,
        "y": 2200,
        "wires": [
            [
                "d8f42877.d8c0f8"
            ],
            [
                "dea95ee7.21b3e"
            ]
        ]
    },
    {
        "id": "a3e2d3e11099e6f4",
        "type": "server-state-changed",
        "z": "86a3c02f.3051a",
        "name": "Bedroom Switch",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.bedroom_switch_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "single",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 440,
        "y": 1520,
        "wires": [
            [
                "5b454d26.040844"
            ],
            []
        ]
    },
    {
        "id": "17f076e83fc25e02",
        "type": "subflow:a6ce77f172d194a1",
        "z": "86a3c02f.3051a",
        "name": "",
        "x": 740,
        "y": 3580,
        "wires": [
            [
                "caae24a520a41c2d"
            ],
            []
        ]
    },
    {
        "id": "9ba91a469da6e754",
        "type": "time-range-switch",
        "z": "86a3c02f.3051a",
        "name": "",
        "lat": "-29.81079",
        "lon": "30.93025",
        "startTime": "sunset",
        "endTime": "sunrise",
        "startOffset": 0,
        "endOffset": 0,
        "x": 520,
        "y": 3580,
        "wires": [
            [
                "17f076e83fc25e02"
            ],
            [
                "65188cb459fde90b"
            ]
        ]
    },
    {
        "id": "69796571e9f03f84",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "filter",
        "func": "var weight = flow.get(\"bedweight\")\n\nif (weight > 80)\n    return [null, msg];\n\nflow.set(\"bedweight\", msg.payload);\n\nreturn [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 3480,
        "wires": [
            [
                "4f0185a11b92f68c"
            ],
            []
        ]
    },
    {
        "id": "248b21c2604b15ec",
        "type": "function",
        "z": "86a3c02f.3051a",
        "name": "filter",
        "func": "var weight = flow.get(\"bedweight\")\n\nif (weight < 80)\n    return [null, msg];\n\nflow.set(\"bedweight\", msg.payload);\n\nreturn [msg, null];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 3580,
        "wires": [
            [
                "9ba91a469da6e754"
            ],
            []
        ]
    },
    {
        "id": "409bf29e1c1e5ae0",
        "type": "debug",
        "z": "86a3c02f.3051a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 3360,
        "wires": []
    },
    {
        "id": "75886106291fcd7b",
        "type": "debug",
        "z": "86a3c02f.3051a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 3420,
        "wires": []
    },
    {
        "id": "4f0185a11b92f68c",
        "type": "time-range-switch",
        "z": "86a3c02f.3051a",
        "name": "",
        "lat": "-29.81079",
        "lon": "30.93025",
        "startTime": "sunset",
        "endTime": "sunrise",
        "startOffset": 0,
        "endOffset": 0,
        "x": 460,
        "y": 3460,
        "wires": [
            [
                "fae5fa453867687f"
            ],
            []
        ]
    },
    {
        "id": "65188cb459fde90b",
        "type": "api-call-service",
        "z": "86a3c02f.3051a",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.bedtime",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 780,
        "y": 3660,
        "wires": [
            []
        ]
    },
    {
        "id": "801b6b718dab920c",
        "type": "api-current-state",
        "z": "86a3c02f.3051a",
        "name": "In Bed",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "80",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.bed_scale",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 390,
        "y": 180,
        "wires": [
            [
                "617433c5.87712c"
            ],
            []
        ]
    },
    {
        "id": "bdbee893.050b58",
        "type": "link in",
        "z": "3788fae5.b038d6",
        "name": "Movie",
        "links": [
            "e7759e94.87d78"
        ],
        "x": 175,
        "y": 180,
        "wires": [
            [
                "68580e7b.59bde",
                "6cad72cb.bffa3c",
                "29f06b72.ef1114",
                "3a505a79.5ca2f6",
                "e226dd7c.ae6b4"
            ]
        ]
    },
    {
        "id": "68580e7b.59bde",
        "type": "link out",
        "z": "3788fae5.b038d6",
        "name": "MovieOffLights",
        "links": [
            "8653b724.b6b798"
        ],
        "x": 320,
        "y": 120,
        "wires": []
    },
    {
        "id": "6cad72cb.bffa3c",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "LoungeLight",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "{\"rgb_color\":[0,30,30]}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 370,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "29f06b72.ef1114",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "OutsideLightOff",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 380,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "be57c11c.f8293",
        "type": "mqtt out",
        "z": "3788fae5.b038d6",
        "name": "Publish",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 520,
        "y": 300,
        "wires": []
    },
    {
        "id": "3a505a79.5ca2f6",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "DevicesOn",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"devices_on\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 350,
        "y": 300,
        "wires": [
            [
                "be57c11c.f8293"
            ]
        ]
    },
    {
        "id": "80e1fa55.2dd948",
        "type": "mqtt out",
        "z": "3788fae5.b038d6",
        "name": "Publish",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 520,
        "y": 360,
        "wires": []
    },
    {
        "id": "e226dd7c.ae6b4",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Set Source",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"source_dvd\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 350,
        "y": 360,
        "wires": [
            [
                "80e1fa55.2dd948"
            ]
        ]
    },
    {
        "id": "f2adc0ca.e01d5",
        "type": "link in",
        "z": "3788fae5.b038d6",
        "name": "Pause",
        "links": [
            "ba2848df.750b58"
        ],
        "x": 155,
        "y": 420,
        "wires": [
            [
                "6b3c3077.c736",
                "6cf11b4c.1e6ba4",
                "69c53cd7.421254",
                "33e1c05.760b24",
                "9b895081.0369a",
                "cf96bcfd.6d46d"
            ]
        ]
    },
    {
        "id": "6b3c3077.c736",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "LoungeLight",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "{\"rgb_color\":[80,30,30]}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 350,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "6cf11b4c.1e6ba4",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "OutsideLightOn",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 360,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "4d87dc9e.05eec4",
        "type": "mqtt out",
        "z": "3788fae5.b038d6",
        "name": "Publish",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 520,
        "y": 540,
        "wires": []
    },
    {
        "id": "69c53cd7.421254",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Set Source",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"source_aux\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 350,
        "y": 540,
        "wires": [
            [
                "4d87dc9e.05eec4"
            ]
        ]
    },
    {
        "id": "d0df7b03.3e7558",
        "type": "mqtt out",
        "z": "3788fae5.b038d6",
        "name": "Publish",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 520,
        "y": 600,
        "wires": []
    },
    {
        "id": "33e1c05.760b24",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Pause",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"pause\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 330,
        "y": 600,
        "wires": [
            [
                "d0df7b03.3e7558"
            ]
        ]
    },
    {
        "id": "9b895081.0369a",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "IntervalMusic",
        "func": "msg.payload=\"interval music uri\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 350,
        "y": 660,
        "wires": [
            [
                "bee3b9e6.682758"
            ]
        ]
    },
    {
        "id": "bee3b9e6.682758",
        "type": "link out",
        "z": "3788fae5.b038d6",
        "name": "IntervalMusic",
        "links": [
            "fa2b4fb.f01d7b",
            "99f978d8.77fdd8"
        ],
        "x": 475,
        "y": 660,
        "wires": []
    },
    {
        "id": "a1a2d7a5.e342d8",
        "type": "link out",
        "z": "3788fae5.b038d6",
        "name": "MovieOffLights",
        "links": [
            "8653b724.b6b798"
        ],
        "x": 740,
        "y": 380,
        "wires": []
    },
    {
        "id": "fcc1f3e5.a12e",
        "type": "mqtt out",
        "z": "3788fae5.b038d6",
        "name": "Publish",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 960,
        "y": 560,
        "wires": []
    },
    {
        "id": "2f8776c0.82b32a",
        "type": "mqtt out",
        "z": "3788fae5.b038d6",
        "name": "Publish",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 960,
        "y": 620,
        "wires": []
    },
    {
        "id": "9bcd1e72.0f657",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Play",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"play\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 620,
        "wires": [
            [
                "2f8776c0.82b32a"
            ]
        ]
    },
    {
        "id": "d0f7c7cc.490c18",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "LoungeLight",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "{\"rgb_color\":[0,30,30]}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 790,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "38a48f73.f00b9",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "OutsideLightOff",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.back",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 800,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "69a6479d.ff2198",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Set Source",
        "func": "msg.topic = \"coffee_table/command\"\nmsg.payload = \"source_dvd\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 790,
        "y": 560,
        "wires": [
            [
                "fcc1f3e5.a12e"
            ]
        ]
    },
    {
        "id": "d0d05ed0.1c20d",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Stop Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "media_stop",
        "entityId": "media_player.spotify",
        "data": "{\"source\":\"raspotify\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 790,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "cf96bcfd.6d46d",
        "type": "change",
        "z": "3788fae5.b038d6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "paused",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "fd89f781.574d18",
        "type": "change",
        "z": "3788fae5.b038d6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "paused",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "f38dc16c.16a27",
        "type": "link in",
        "z": "3788fae5.b038d6",
        "name": "Play",
        "links": [
            "f65c5281.8848"
        ],
        "x": 595,
        "y": 440,
        "wires": [
            [
                "a1a2d7a5.e342d8",
                "9bcd1e72.0f657",
                "69a6479d.ff2198",
                "d0d05ed0.1c20d",
                "d0f7c7cc.490c18",
                "38a48f73.f00b9",
                "fd89f781.574d18"
            ]
        ]
    },
    {
        "id": "9d9e89db.f1ba78",
        "type": "mqtt in",
        "z": "3788fae5.b038d6",
        "name": "Button 2",
        "topic": "zigbee2mqtt/0x00158d0001f4183f",
        "qos": "2",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "inputs": 0,
        "x": 244,
        "y": 1464,
        "wires": [
            [
                "18c5f63f.32e9ea"
            ]
        ]
    },
    {
        "id": "9a7eabc4.79b9e8",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "Message",
        "property": "payload.click",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "long",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "double",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 544,
        "y": 1464,
        "wires": [
            [
                "62952589.3e1e6c",
                "b852bbe9.eef808"
            ],
            [
                "e17b482c.30ea08"
            ],
            [
                "3b9215e4.fd290a"
            ]
        ]
    },
    {
        "id": "18c5f63f.32e9ea",
        "type": "json",
        "z": "3788fae5.b038d6",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 394,
        "y": 1464,
        "wires": [
            [
                "9a7eabc4.79b9e8"
            ]
        ]
    },
    {
        "id": "9d4f9b1e.bb0308",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Parse",
        "func": "var brightness = msg.payload\n\nmsg.payload = \n{\n    data:\n    {\n        \"brightness\":brightness,\n        \"color_temp\": \"2500\"\n    }\n};\n\nif (brightness == \"0\")\n    msg.topic = \"reset\"\n    \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1114,
        "y": 1444,
        "wires": [
            [
                "b8d5d3ef.78ae6"
            ]
        ]
    },
    {
        "id": "b48f5aad.7b4cf8",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1414,
        "y": 1444,
        "wires": [
            []
        ]
    },
    {
        "id": "62952589.3e1e6c",
        "type": "state-machine",
        "z": "3788fae5.b038d6",
        "name": "",
        "triggerProperty": "payload.click",
        "triggerPropertyType": "msg",
        "stateProperty": "payload",
        "statePropertyType": "msg",
        "initialDelay": "",
        "persistOnReload": false,
        "outputStateChangeOnly": true,
        "throwException": false,
        "states": [
            "0",
            "40",
            "80",
            "255"
        ],
        "transitions": [
            {
                "name": "single",
                "from": "40",
                "to": "255"
            },
            {
                "name": "single",
                "from": "80",
                "to": "40"
            },
            {
                "name": "single",
                "from": "255",
                "to": "80"
            },
            {
                "name": "single",
                "from": "0",
                "to": "255"
            },
            {
                "name": "reset",
                "from": "*",
                "to": "0"
            }
        ],
        "x": 924,
        "y": 1444,
        "wires": [
            [
                "9d4f9b1e.bb0308"
            ]
        ]
    },
    {
        "id": "b8d5d3ef.78ae6",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "reset",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1274,
        "y": 1444,
        "wires": [
            [
                "b48f5aad.7b4cf8"
            ]
        ]
    },
    {
        "id": "b852bbe9.eef808",
        "type": "stoptimer",
        "z": "3788fae5.b038d6",
        "duration": "15",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 724,
        "y": 1304,
        "wires": [
            [
                "20926755.0d5338"
            ],
            []
        ]
    },
    {
        "id": "20926755.0d5338",
        "type": "change",
        "z": "3788fae5.b038d6",
        "name": "Reset",
        "rules": [
            {
                "t": "set",
                "p": "payload.click",
                "pt": "msg",
                "to": "reset",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 734,
        "y": 1384,
        "wires": [
            [
                "62952589.3e1e6c"
            ]
        ]
    },
    {
        "id": "e17b482c.30ea08",
        "type": "subflow:8ed72877.93bc38",
        "z": "3788fae5.b038d6",
        "name": "",
        "x": 814,
        "y": 1504,
        "wires": []
    },
    {
        "id": "3b9215e4.fd290a",
        "type": "subflow:a436e8cb.527cf8",
        "z": "3788fae5.b038d6",
        "name": "",
        "env": [],
        "x": 780,
        "y": 1580,
        "wires": []
    },
    {
        "id": "d8a70c89.a3675",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Come Home",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "device_tracker.philip",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 550,
        "y": 100,
        "wires": [
            [
                "2930bd67.478ca2"
            ],
            []
        ]
    },
    {
        "id": "2930bd67.478ca2",
        "type": "api-current-state",
        "z": "3788fae5.b038d6",
        "name": "Is it hot?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "24",
        "halt_if_type": "num",
        "halt_if_compare": "gte",
        "entity_id": "sensor.lounge_temperature",
        "state_type": "num",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 720,
        "y": 100,
        "wires": [
            [
                "fe2e314f.b36b7"
            ],
            []
        ]
    },
    {
        "id": "a5194ca9.77f1b",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Turn on AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1050,
        "y": 100,
        "wires": [
            [
                "4136d2ff.36477c"
            ]
        ]
    },
    {
        "id": "4732c6a9.d69ad8",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Back Door",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "binary_sensor.back_door_contact",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 700,
        "y": 260,
        "wires": [
            [
                "32b9728e.406cee",
                "78806e1a.9f417"
            ],
            [
                "32b9728e.406cee"
            ]
        ]
    },
    {
        "id": "32b9728e.406cee",
        "type": "stoptimer",
        "z": "3788fae5.b038d6",
        "duration": "1",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 880,
        "y": 260,
        "wires": [
            [
                "3900a2e7.3a363e"
            ],
            []
        ]
    },
    {
        "id": "78806e1a.9f417",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Previous State",
        "func": "var ac =  flow.get(\"ac_state\");\nflow.set(\"ac_state\", false);\n\nif(true === ac)\n    return [msg, null]\nelse\n    return [null, msg]",
        "outputs": 2,
        "noerr": 0,
        "x": 900,
        "y": 200,
        "wires": [
            [
                "fecbcf7e.977ac"
            ],
            []
        ]
    },
    {
        "id": "3900a2e7.3a363e",
        "type": "api-current-state",
        "z": "3788fae5.b038d6",
        "name": "Still Open",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.back_door_contact",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1060,
        "y": 260,
        "wires": [
            [
                "54e99f26.f0392"
            ],
            []
        ]
    },
    {
        "id": "fecbcf7e.977ac",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Turn on AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1090,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "54e99f26.f0392",
        "type": "api-current-state",
        "z": "3788fae5.b038d6",
        "name": "AC State",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.lounge_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 1220,
        "y": 260,
        "wires": [
            [
                "7f6e93ab.19bf4c"
            ],
            [
                "6178d896.9e0aa8"
            ]
        ]
    },
    {
        "id": "7f6e93ab.19bf4c",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Save State ON",
        "func": "flow.set(\"ac_state\", true);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1420,
        "y": 240,
        "wires": [
            [
                "9b96030b.64f84"
            ]
        ]
    },
    {
        "id": "6178d896.9e0aa8",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Save State OFF",
        "func": "flow.set(\"ac_state\", false);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1420,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "9b96030b.64f84",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Turn off AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1610,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "71220c0b.8b1784",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Right Logic",
        "func": "var state = flow.get(\"light_state\") || \"off\";\n\nswitch(state)\n{\n    case \"low\":\n        flow.set(\"light_state\", \"off\");\n        return[null, msg];\n\n    default:\n    case \"off\":    \n    case \"high\":\n        flow.set(\"light_state\", \"low\");\n        return[msg, null];\n    \n}",
        "outputs": 2,
        "noerr": 0,
        "x": 730,
        "y": 1020,
        "wires": [
            [
                "a03b3143.2e984"
            ],
            [
                "5e064f7d.8b5e8"
            ]
        ]
    },
    {
        "id": "d9f6ef8a.07329",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "lounge",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1350,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "24070940.e6db56",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "reset",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1210,
        "y": 1120,
        "wires": [
            [
                "d9f6ef8a.07329"
            ]
        ]
    },
    {
        "id": "5e064f7d.8b5e8",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Turn off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 880,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "f25a59b5.d8fcb8",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Light turned off",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "light.lounge",
        "entityidfiltertype": "exact",
        "outputinitially": true,
        "state_type": "str",
        "haltifstate": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1280,
        "y": 840,
        "wires": [
            [
                "9021c270.0a3b8"
            ],
            []
        ]
    },
    {
        "id": "9021c270.0a3b8",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Reset Logic",
        "func": "flow.set(\"light_state\", \"off\");",
        "outputs": 2,
        "noerr": 0,
        "x": 1480,
        "y": 840,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "4136d2ff.36477c",
        "type": "delay",
        "z": "3788fae5.b038d6",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1200,
        "y": 100,
        "wires": [
            [
                "36aa2159.fb3dbe"
            ]
        ]
    },
    {
        "id": "36aa2159.fb3dbe",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Turn on AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1350,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "239064ae.f24bcc",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Chill",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "input_boolean.chill_time",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1050,
        "y": 440,
        "wires": [
            [
                "7517beec.7305d",
                "eeb9265b.8b0328",
                "942447ab.53cdf8"
            ],
            []
        ]
    },
    {
        "id": "7517beec.7305d",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Reset bool",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.chill_time",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1240,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "344020c6.5b639",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Play Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "play_media",
        "entityId": "media_player.spotify_phil",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1620,
        "y": 460,
        "wires": [
            [
                "d4ed10ae.6e52"
            ]
        ]
    },
    {
        "id": "942447ab.53cdf8",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Select Source",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "select_source",
        "entityId": "media_player.spotify_phil",
        "data": "{\"source\":\"Onkyo TX-NR575E F3F71F\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1250,
        "y": 460,
        "wires": [
            [
                "17e88970.019397"
            ]
        ]
    },
    {
        "id": "17e88970.019397",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Accoustic Jam",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"media_content_type\":\"playlist\",\n        \"media_content_id\":\"spotify:playlist:705vyINkWYjjQTW1sLxmd0\"\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1430,
        "y": 460,
        "wires": [
            [
                "344020c6.5b639"
            ]
        ]
    },
    {
        "id": "d4ed10ae.6e52",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Shuffle",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "play_media",
        "entityId": "media_player.spotify_phil",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1780,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "eeb9265b.8b0328",
        "type": "subflow:8e0a986b.ca0ef8",
        "z": "3788fae5.b038d6",
        "name": "",
        "env": [],
        "x": 1250,
        "y": 520,
        "wires": []
    },
    {
        "id": "a03b3143.2e984",
        "type": "subflow:8e0a986b.ca0ef8",
        "z": "3788fae5.b038d6",
        "name": "",
        "env": [],
        "x": 900,
        "y": 1000,
        "wires": []
    },
    {
        "id": "fe2e314f.b36b7",
        "type": "api-current-state",
        "z": "3788fae5.b038d6",
        "name": "AC Off?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.lounge_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 880,
        "y": 100,
        "wires": [
            [
                "a5194ca9.77f1b"
            ],
            []
        ]
    },
    {
        "id": "943bd9ac.1e7528",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_6w_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 1740,
        "wires": [
            [
                "50536bbc.9c28b4"
            ]
        ]
    },
    {
        "id": "50536bbc.9c28b4",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "single",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_single",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_single",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 360,
        "y": 1739,
        "wires": [
            [
                "bd94652f006604a7"
            ],
            [
                "da1c4a90.a307f8"
            ],
            [
                "b691cd12.1dba8"
            ],
            [
                "808171cb.a2b83"
            ],
            [
                "1a8df36a.c0853d"
            ],
            [
                "f002aa51.fc94e8"
            ]
        ]
    },
    {
        "id": "2b5f97df.433038",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "double",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_double",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_double",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 400,
        "y": 1999,
        "wires": [
            [
                "1324cc5dbbcc320e"
            ],
            [],
            [
                "f9bb6ea1.137d1"
            ],
            [],
            [],
            []
        ]
    },
    {
        "id": "2a56f0a3.8a0ba",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "triple",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_triple",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_triple",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 360,
        "y": 2239,
        "wires": [
            [],
            [],
            [
                "bca89b02.f81978"
            ],
            [],
            [],
            []
        ]
    },
    {
        "id": "ff2ff3fc.4df82",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "hold",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_hold",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_hold",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 1490,
        "y": 1980,
        "wires": [
            [],
            [],
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "162d8587.93ab2a",
        "type": "switch",
        "z": "3788fae5.b038d6",
        "name": "release",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button_1_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_2_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_3_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_4_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_5_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "button_6_release",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 1030,
        "y": 2279,
        "wires": [
            [],
            [],
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "294d3581.7521ba",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_6w_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 180,
        "y": 1999,
        "wires": [
            [
                "2b5f97df.433038"
            ]
        ]
    },
    {
        "id": "adfbfd25.88a93",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_6w_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 140,
        "y": 2239,
        "wires": [
            [
                "2a56f0a3.8a0ba"
            ]
        ]
    },
    {
        "id": "7dbd25f2.99a11c",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_6w_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1270,
        "y": 1980,
        "wires": [
            [
                "ff2ff3fc.4df82"
            ]
        ]
    },
    {
        "id": "4774932f.1cd2ec",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Opple",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_6w_action",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 780,
        "y": 2279,
        "wires": [
            [
                "162d8587.93ab2a"
            ]
        ]
    },
    {
        "id": "3c0ef2bc.95f4fe",
        "type": "api-current-state",
        "z": "3788fae5.b038d6",
        "name": "AC state",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.lounge_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 810,
        "y": 1719,
        "wires": [
            [
                "39deda02.78b4e6"
            ],
            [
                "7a52e05.e26382"
            ]
        ]
    },
    {
        "id": "39deda02.78b4e6",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "AC On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 980,
        "y": 1699,
        "wires": [
            []
        ]
    },
    {
        "id": "7a52e05.e26382",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "AC Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.lounge_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 980,
        "y": 1759,
        "wires": [
            []
        ]
    },
    {
        "id": "b691cd12.1dba8",
        "type": "change",
        "z": "3788fae5.b038d6",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 1720,
        "wires": [
            [
                "3c0ef2bc.95f4fe"
            ]
        ]
    },
    {
        "id": "7e66be70.aed95",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 830,
        "y": 1640,
        "wires": [
            []
        ]
    },
    {
        "id": "da1c4a90.a307f8",
        "type": "link out",
        "z": "3788fae5.b038d6",
        "name": "Lounge Warm",
        "links": [
            "3b3b9b24.b88264"
        ],
        "x": 535,
        "y": 1680,
        "wires": []
    },
    {
        "id": "3b3b9b24.b88264",
        "type": "link in",
        "z": "3788fae5.b038d6",
        "name": "Lounge Warm",
        "links": [
            "da1c4a90.a307f8"
        ],
        "x": 595,
        "y": 1060,
        "wires": [
            [
                "71220c0b.8b1784"
            ]
        ]
    },
    {
        "id": "f002aa51.fc94e8",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Toggle Receiver",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "media_player",
        "service": "toggle",
        "entityId": "media_player.receiver",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 600,
        "y": 1840,
        "wires": [
            []
        ]
    },
    {
        "id": "1a8df36a.c0853d",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Toggle TV",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "media_player",
        "service": "toggle",
        "entityId": "media_player.samsung_ua43mu7000",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 580,
        "y": 1800,
        "wires": [
            []
        ]
    },
    {
        "id": "f9bb6ea1.137d1",
        "type": "change",
        "z": "3788fae5.b038d6",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 2080,
        "wires": [
            [
                "23256a6e.a637d6"
            ]
        ]
    },
    {
        "id": "23256a6e.a637d6",
        "type": "api-current-state",
        "z": "3788fae5.b038d6",
        "name": "AC state",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.bedroom_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 580,
        "y": 2120,
        "wires": [
            [
                "acf054ed.2f8a68"
            ],
            [
                "9102b03e.1e904"
            ]
        ]
    },
    {
        "id": "acf054ed.2f8a68",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "AC On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 730,
        "y": 2080,
        "wires": [
            []
        ]
    },
    {
        "id": "9102b03e.1e904",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "AC Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 710,
        "y": 2120,
        "wires": [
            []
        ]
    },
    {
        "id": "bca89b02.f81978",
        "type": "change",
        "z": "3788fae5.b038d6",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 2400,
        "wires": [
            [
                "e304779d.799038"
            ]
        ]
    },
    {
        "id": "e304779d.799038",
        "type": "api-current-state",
        "z": "3788fae5.b038d6",
        "name": "AC state",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "climate.study_ac",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 540,
        "y": 2440,
        "wires": [
            [
                "1c87fa87.39ebe5"
            ],
            [
                "54f78957.93ff88"
            ]
        ]
    },
    {
        "id": "1c87fa87.39ebe5",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "AC On",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 710,
        "y": 2400,
        "wires": [
            []
        ]
    },
    {
        "id": "54f78957.93ff88",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "AC Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "climate",
        "service": "turn_off",
        "entityId": "climate.study_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 690,
        "y": 2440,
        "wires": [
            []
        ]
    },
    {
        "id": "808171cb.a2b83",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Play/Pause",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "media_player",
        "service": "media_play_pause",
        "entityId": "media_player.samsung_ua43mu7000",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 590,
        "y": 1760,
        "wires": [
            []
        ]
    },
    {
        "id": "bd94652f006604a7",
        "type": "subflow:a6ce77f172d194a1",
        "z": "3788fae5.b038d6",
        "name": "",
        "x": 600,
        "y": 1640,
        "wires": [
            [],
            [
                "7e66be70.aed95"
            ]
        ]
    },
    {
        "id": "1324cc5dbbcc320e",
        "type": "function",
        "z": "3788fae5.b038d6",
        "name": "Left Logic",
        "func": "var state = flow.get(\"light_state\") || \"off\";\n\nswitch(state)\n{\n    case \"high\":\n        flow.set(\"light_state\", \"off\");\n        return[null, msg];\n\n    default:\n    case \"off\":    \n    case \"low\":\n        flow.set(\"light_state\", \"high\");\n        return[msg, null];\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 660,
        "y": 1980,
        "wires": [
            [
                "b7ef4049d7e417a5"
            ],
            [
                "06f7d7a9c998d933"
            ]
        ]
    },
    {
        "id": "06f7d7a9c998d933",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Turn off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 820,
        "y": 2020,
        "wires": [
            []
        ]
    },
    {
        "id": "b7ef4049d7e417a5",
        "type": "subflow:8b2696b9.77c108",
        "z": "3788fae5.b038d6",
        "name": "",
        "env": [],
        "x": 840,
        "y": 1960,
        "wires": []
    },
    {
        "id": "0f93ad4e01bfe94b",
        "type": "subflow:a6ce77f172d194a1",
        "z": "3788fae5.b038d6",
        "name": "",
        "x": 750,
        "y": 860,
        "wires": [
            [],
            [
                "bbb2c1b889bafeb1"
            ]
        ]
    },
    {
        "id": "bbb2c1b889bafeb1",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Lights",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 930,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "f8748cd90b558b92",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Switch Left",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_switch_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "left",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 530,
        "y": 860,
        "wires": [
            [
                "0f93ad4e01bfe94b"
            ],
            []
        ]
    },
    {
        "id": "1ba5dc4a1807df14",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Switch Both",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_switch_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "both",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 530,
        "y": 940,
        "wires": [
            [
                "cda8a8d665017646"
            ],
            []
        ]
    },
    {
        "id": "b04ab459ca05db4e",
        "type": "server-state-changed",
        "z": "3788fae5.b038d6",
        "name": "Lounge Switch Right",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.lounge_switch_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "right",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 510,
        "y": 1020,
        "wires": [
            [
                "71220c0b.8b1784"
            ],
            []
        ]
    },
    {
        "id": "cda8a8d665017646",
        "type": "api-call-service",
        "z": "3788fae5.b038d6",
        "name": "Toggle",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 730,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "fca6720f.a32c3",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "Peripheral Lights Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.sonoff_kitchen, light.passage, light.entrance, light.lab",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 260,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "8653b724.b6b798",
        "type": "link in",
        "z": "b50f3595.0e3a28",
        "name": "PeripheralLightsOff",
        "links": [
            "68580e7b.59bde",
            "a208e1db.bc2bb",
            "a1a2d7a5.e342d8"
        ],
        "x": 115,
        "y": 80,
        "wires": [
            [
                "fca6720f.a32c3"
            ]
        ]
    },
    {
        "id": "55a6be5f.50e59",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "All Lights Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "group.all_lights",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 230,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "14ab918f.a9369e",
        "type": "link in",
        "z": "b50f3595.0e3a28",
        "name": "AllLightsOff",
        "links": [],
        "x": 115,
        "y": 140,
        "wires": [
            [
                "55a6be5f.50e59"
            ]
        ]
    },
    {
        "id": "1c301ebb.5df3b1",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "Inside Lights Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "group.inside_lights",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 240,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "e4edf7d9.080b48",
        "type": "link in",
        "z": "b50f3595.0e3a28",
        "name": "InsideLightsOff",
        "links": [],
        "x": 115,
        "y": 200,
        "wires": [
            [
                "1c301ebb.5df3b1"
            ]
        ]
    },
    {
        "id": "929ef857.188298",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "Bedtime Lights Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "group.lights_bedtime",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 250,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "1b91702b.f09e6",
        "type": "link in",
        "z": "b50f3595.0e3a28",
        "name": "BedtimeLightsOff",
        "links": [],
        "x": 115,
        "y": 260,
        "wires": [
            [
                "929ef857.188298"
            ]
        ]
    },
    {
        "id": "9f45a6cfe8b92453",
        "type": "function",
        "z": "b50f3595.0e3a28",
        "name": "Clear sleep",
        "func": "global.set(\"sleeptime\", false)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 950,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "e560a63bef1abdd9",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "Bedside",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.bedside",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 880,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "99f0bd8b23f78bc1",
        "type": "function",
        "z": "b50f3595.0e3a28",
        "name": "get sleep",
        "func": "var sleep_time = global.get(\"sleeptime\");\n\nif(false === sleep_time)\n    return [null, msg];\nelse\n    return [msg, null];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 360,
        "wires": [
            [
                "1f101adfb6ef9a5e"
            ],
            [
                "113ab932c251aba7"
            ]
        ]
    },
    {
        "id": "a30f29338d8e9f8e",
        "type": "function",
        "z": "b50f3595.0e3a28",
        "name": "Set sleep",
        "func": "global.set(\"sleeptime\", true)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "1f101adfb6ef9a5e",
        "type": "debug",
        "z": "b50f3595.0e3a28",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1120,
        "y": 340,
        "wires": []
    },
    {
        "id": "113ab932c251aba7",
        "type": "debug",
        "z": "b50f3595.0e3a28",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1120,
        "y": 380,
        "wires": []
    },
    {
        "id": "fc5f60e50bc3a3d8",
        "type": "inject",
        "z": "b50f3595.0e3a28",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 710,
        "y": 360,
        "wires": [
            [
                "99f0bd8b23f78bc1"
            ]
        ]
    },
    {
        "id": "4ce7567d82d02533",
        "type": "inject",
        "z": "b50f3595.0e3a28",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 780,
        "y": 700,
        "wires": [
            [
                "9f45a6cfe8b92453"
            ]
        ]
    },
    {
        "id": "868b9f0e22e18a81",
        "type": "subflow:a6ce77f172d194a1",
        "z": "b50f3595.0e3a28",
        "name": "",
        "env": [],
        "x": 520,
        "y": 560,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "1413ab5cba038627",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.study",
        "data": "",
        "dataType": "jsonata",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 730,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "9baad8add8928da5",
        "type": "inject",
        "z": "b50f3595.0e3a28",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 320,
        "y": 560,
        "wires": [
            [
                "868b9f0e22e18a81",
                "dd85128a7c6c7d95"
            ]
        ]
    },
    {
        "id": "dd85128a7c6c7d95",
        "type": "function",
        "z": "b50f3595.0e3a28",
        "name": "Night Light",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"brightness\":100,\n        \"color_temp\": 500\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 620,
        "wires": [
            [
                "1413ab5cba038627"
            ]
        ]
    },
    {
        "id": "d438f56cca41dad5",
        "type": "server-state-changed",
        "z": "b50f3595.0e3a28",
        "name": "PIR Bathroom",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.bathroom_pir_occupancy",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 370,
        "y": 1080,
        "wires": [
            [
                "5a9bdbe05c38ee2d",
                "010c7b127fc623de"
            ],
            []
        ]
    },
    {
        "id": "5a9bdbe05c38ee2d",
        "type": "api-current-state",
        "z": "b50f3595.0e3a28",
        "name": "sun",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 550,
        "y": 1040,
        "wires": [
            [
                "e4c19626ed876b0b"
            ],
            []
        ]
    },
    {
        "id": "010c7b127fc623de",
        "type": "stoptimer",
        "z": "b50f3595.0e3a28",
        "duration": "30",
        "units": "Minute",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 580,
        "y": 1120,
        "wires": [
            [
                "820c625af8cf58f4"
            ],
            []
        ]
    },
    {
        "id": "e4c19626ed876b0b",
        "type": "subflow:a6ce77f172d194a1",
        "z": "b50f3595.0e3a28",
        "name": "",
        "x": 720,
        "y": 1040,
        "wires": [
            [],
            [
                "0be092f1ff65b4b8"
            ]
        ]
    },
    {
        "id": "820c625af8cf58f4",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "Bathroom Light Off",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "turn_off",
        "entityId": "light.bathroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 770,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "0be092f1ff65b4b8",
        "type": "api-call-service",
        "z": "b50f3595.0e3a28",
        "name": "Bathroom Light",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "light",
        "service": "toggle",
        "entityId": "light.bathroom",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 920,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "52759888.916928",
        "type": "api-call-service",
        "z": "ef54a0c2.e259d",
        "name": "Select Source",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "select_source",
        "entityId": "media_player.spotify",
        "data": "{\"source\":\"DESKTOP-P765FDU\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 580,
        "y": 240,
        "wires": [
            [
                "f1ef43ac.57113"
            ]
        ]
    },
    {
        "id": "594b1dc9.7baaf4",
        "type": "api-call-service",
        "z": "ef54a0c2.e259d",
        "name": "Play Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "play_media",
        "entityId": "media_player.spotify",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 890,
        "y": 240,
        "wires": [
            [
                "345c013b.a4fdbe"
            ]
        ]
    },
    {
        "id": "ff1531c4.2fb2d",
        "type": "change",
        "z": "ef54a0c2.e259d",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 240,
        "wires": [
            [
                "52759888.916928"
            ]
        ]
    },
    {
        "id": "fa2b4fb.f01d7b",
        "type": "link in",
        "z": "ef54a0c2.e259d",
        "name": "SpotifyPlayPlaylist",
        "links": [
            "bee3b9e6.682758",
            "433622ba.a574ac",
            "8ebc3823.28c588",
            "616f1977.d61988"
        ],
        "x": 115,
        "y": 240,
        "wires": [
            [
                "ec05ddd9.e58c6"
            ]
        ]
    },
    {
        "id": "f1ef43ac.57113",
        "type": "function",
        "z": "ef54a0c2.e259d",
        "name": "Format",
        "func": "var uri = flow.get(\"uri\")\n\nmsg.payload = \n{\n    data:\n    {\n        \"media_content_type\":\"playlist\",\n        \"media_content_id\":uri\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 740,
        "y": 240,
        "wires": [
            [
                "594b1dc9.7baaf4"
            ]
        ]
    },
    {
        "id": "345c013b.a4fdbe",
        "type": "link out",
        "z": "ef54a0c2.e259d",
        "name": "SpotifyReturn",
        "links": [
            "99a3797d.d57128"
        ],
        "x": 1015,
        "y": 240,
        "wires": []
    },
    {
        "id": "ec05ddd9.e58c6",
        "type": "function",
        "z": "ef54a0c2.e259d",
        "name": "Save URI",
        "func": "flow.set(\"uri\", msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 220,
        "y": 240,
        "wires": [
            [
                "ff1531c4.2fb2d"
            ]
        ]
    },
    {
        "id": "2721a371.68b63c",
        "type": "subflow:8efb2399.f1af9",
        "z": "ef54a0c2.e259d",
        "name": "Play On GHM",
        "env": [],
        "x": 230,
        "y": 480,
        "wires": []
    },
    {
        "id": "b0082697.274b38",
        "type": "api-call-service",
        "z": "ef54a0c2.e259d",
        "name": "Select Source",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "select_source",
        "entityId": "media_player.spotify",
        "data": "{\"source\":\"DESKTOP-P765FDU\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 500,
        "y": 540,
        "wires": [
            [
                "3a9da6fb.a2677a"
            ]
        ]
    },
    {
        "id": "f7fb213a.c8af1",
        "type": "api-call-service",
        "z": "ef54a0c2.e259d",
        "name": "Play Music",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "play_media",
        "entityId": "media_player.spotify",
        "data": "{\"media_content_type\":\"playlist\",\"media_content_id\":\"spotify:playlist:37i9dQZF1DWYrlaUEYy4Vg\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 870,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "3a9da6fb.a2677a",
        "type": "function",
        "z": "ef54a0c2.e259d",
        "name": "John Mayer",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"media_content_type\":\"playlist\",\n        \"media_content_id\":\"spotify:playlist:37i9dQZF1DWYrlaUEYy4Vg\"\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 540,
        "wires": [
            [
                "f7fb213a.c8af1",
                "6003dd5b.6a7464"
            ]
        ]
    },
    {
        "id": "6003dd5b.6a7464",
        "type": "debug",
        "z": "ef54a0c2.e259d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 870,
        "y": 620,
        "wires": []
    },
    {
        "id": "9096b173.59172",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 260,
        "y": 560,
        "wires": [
            [
                "b0082697.274b38"
            ]
        ]
    },
    {
        "id": "f9978cbe.2de58",
        "type": "spotify",
        "z": "ef54a0c2.e259d",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "getMyDevices",
        "x": 350,
        "y": 340,
        "wires": [
            [
                "47093f16.49e58"
            ]
        ]
    },
    {
        "id": "3456a225.cc296e",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Devices",
        "payloadType": "str",
        "x": 190,
        "y": 340,
        "wires": [
            [
                "f9978cbe.2de58"
            ]
        ]
    },
    {
        "id": "47093f16.49e58",
        "type": "debug",
        "z": "ef54a0c2.e259d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 510,
        "y": 340,
        "wires": []
    },
    {
        "id": "a17917a4.abed38",
        "type": "spotify",
        "z": "ef54a0c2.e259d",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "getUserPlaylists",
        "x": 350,
        "y": 400,
        "wires": [
            [
                "59e2dd4b.62e0c4"
            ]
        ]
    },
    {
        "id": "5dc5d578.0d57cc",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Playlists",
        "payloadType": "str",
        "x": 200,
        "y": 400,
        "wires": [
            [
                "a17917a4.abed38"
            ]
        ]
    },
    {
        "id": "59e2dd4b.62e0c4",
        "type": "debug",
        "z": "ef54a0c2.e259d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 530,
        "y": 400,
        "wires": []
    },
    {
        "id": "9e84bbab.f55708",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 520,
        "y": 480,
        "wires": [
            [
                "3a9da6fb.a2677a"
            ]
        ]
    },
    {
        "id": "bdf4bd0d.46605",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 720,
        "y": 460,
        "wires": [
            [
                "f7fb213a.c8af1"
            ]
        ]
    },
    {
        "id": "f38d4829.a2e8f8",
        "type": "api-call-service",
        "z": "ef54a0c2.e259d",
        "name": "Select Source",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "media_player",
        "service": "select_source",
        "entityId": "media_player.spotify",
        "data": "{\"source\":\"Librespot@Jukebox\"}",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 580,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "4781246c.8cfadc",
        "type": "spotify",
        "z": "ef54a0c2.e259d",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "getMyCurrentPlayingTrack",
        "x": 390,
        "y": 780,
        "wires": [
            [
                "b626988c.df8b88"
            ]
        ]
    },
    {
        "id": "a3cc4e62.9707a",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Devices",
        "payloadType": "str",
        "x": 230,
        "y": 780,
        "wires": [
            [
                "4781246c.8cfadc"
            ]
        ]
    },
    {
        "id": "f9f87d8.95a018",
        "type": "debug",
        "z": "ef54a0c2.e259d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 950,
        "y": 780,
        "wires": []
    },
    {
        "id": "b626988c.df8b88",
        "type": "function",
        "z": "ef54a0c2.e259d",
        "name": "Filter Image URL",
        "func": "msg.url = msg.payload.item.album.images[0].url\n\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 570,
        "y": 780,
        "wires": [
            [
                "f9f87d8.95a018",
                "e781411e.17d3"
            ]
        ]
    },
    {
        "id": "e781411e.17d3",
        "type": "http request",
        "z": "ef54a0c2.e259d",
        "name": "",
        "method": "GET",
        "ret": "bin",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 770,
        "y": 840,
        "wires": [
            [
                "fc8077f7.fe9988"
            ]
        ]
    },
    {
        "id": "fc8077f7.fe9988",
        "type": "file",
        "z": "ef54a0c2.e259d",
        "name": "save image",
        "filename": "/share/album.jfif",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 990,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "9c951cb.a9ac2e",
        "type": "http in",
        "z": "ef54a0c2.e259d",
        "name": "",
        "url": "/album.html",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 170,
        "y": 980,
        "wires": [
            [
                "6359ebf.27cb314"
            ]
        ]
    },
    {
        "id": "6359ebf.27cb314",
        "type": "file in",
        "z": "ef54a0c2.e259d",
        "name": "",
        "filename": "/share/album.html",
        "format": "",
        "x": 430,
        "y": 980,
        "wires": [
            [
                "9965632d.99f1e"
            ]
        ]
    },
    {
        "id": "9965632d.99f1e",
        "type": "change",
        "z": "ef54a0c2.e259d",
        "name": "Set Headers",
        "rules": [
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "headers.content-type",
                "pt": "msg",
                "to": "text/html",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 980,
        "wires": [
            [
                "e6dd72f3.34a46"
            ]
        ]
    },
    {
        "id": "e6dd72f3.34a46",
        "type": "http response",
        "z": "ef54a0c2.e259d",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 810,
        "y": 980,
        "wires": []
    },
    {
        "id": "f3f887d.c5db578",
        "type": "spotify",
        "z": "ef54a0c2.e259d",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "getAlbum",
        "x": 450,
        "y": 80,
        "wires": [
            [
                "678b4110.9e302"
            ]
        ]
    },
    {
        "id": "e0b66320.f432d",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Now Playing",
        "payloadType": "str",
        "x": 290,
        "y": 80,
        "wires": [
            [
                "f3f887d.c5db578"
            ]
        ]
    },
    {
        "id": "678b4110.9e302",
        "type": "debug",
        "z": "ef54a0c2.e259d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 590,
        "y": 80,
        "wires": []
    },
    {
        "id": "10d5e987.80f0b6",
        "type": "spotify",
        "z": "ef54a0c2.e259d",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "transferMyPlayback",
        "x": 1450,
        "y": 360,
        "wires": [
            [
                "416d2109.4960c"
            ]
        ]
    },
    {
        "id": "c3d79db1.4751f",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "Src",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 950,
        "y": 360,
        "wires": [
            [
                "fe62dd65.a7d1e"
            ]
        ]
    },
    {
        "id": "416d2109.4960c",
        "type": "debug",
        "z": "ef54a0c2.e259d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1650,
        "y": 360,
        "wires": []
    },
    {
        "id": "fe62dd65.a7d1e",
        "type": "function",
        "z": "ef54a0c2.e259d",
        "name": "Onkyo TX-NR575E F3F71F",
        "func": "msg.params = [\n    { \n        deviceIds: ['Onkyo TX-NR575E F3F71F'], /* deviceIds */\n        // deviceIds: ['DESKTOP-AGH6GO8'], /* deviceIds */ \n        play: true /* Options */\n        \n    }\n];\n\n\n\n// msg.params = [ {deviceIds: [\"DESKTOP-AGH6GO8\"], play: 'true'} ];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1160,
        "y": 360,
        "wires": [
            [
                "10d5e987.80f0b6"
            ]
        ]
    },
    {
        "id": "75aa678e.6ec998",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "Src",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 950,
        "y": 420,
        "wires": [
            [
                "8c930b2.91ec6f8"
            ]
        ]
    },
    {
        "id": "8c930b2.91ec6f8",
        "type": "function",
        "z": "ef54a0c2.e259d",
        "name": "ArtistAlbums",
        "func": "msg.params = [\n    '43ZHCT0cAZBISjO8DG9PnE', /* Artist ID */\n    { limit: 10, offset: 20 } /* Options */\n];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1110,
        "y": 420,
        "wires": [
            [
                "180f012e.1091ff"
            ]
        ]
    },
    {
        "id": "180f012e.1091ff",
        "type": "spotify",
        "z": "ef54a0c2.e259d",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "getArtistAlbums",
        "x": 1290,
        "y": 420,
        "wires": [
            [
                "d8870bf6.32c308"
            ]
        ]
    },
    {
        "id": "d8870bf6.32c308",
        "type": "debug",
        "z": "ef54a0c2.e259d",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1490,
        "y": 420,
        "wires": []
    },
    {
        "id": "8d1a2c4a.c6fe6",
        "type": "eiscp-out",
        "z": "ef54a0c2.e259d",
        "name": "",
        "controller": "7bee2da5.7b1c14",
        "x": 1690,
        "y": 600,
        "wires": []
    },
    {
        "id": "c9045597.6aca38",
        "type": "function",
        "z": "ef54a0c2.e259d",
        "name": "Onkyo TX-NR575E F3F71F",
        "func": "msg.payload = \"input-selector:net\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1460,
        "y": 600,
        "wires": [
            [
                "8d1a2c4a.c6fe6"
            ]
        ]
    },
    {
        "id": "e54b1c9c.a4b31",
        "type": "inject",
        "z": "ef54a0c2.e259d",
        "name": "Src",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1250,
        "y": 600,
        "wires": [
            [
                "c9045597.6aca38"
            ]
        ]
    },
    {
        "id": "5f47c1e.369284",
        "type": "api-current-state",
        "z": "5e97ea24.516424",
        "name": "Did it rain?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "0.1",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.dark_sky_precip_intensity",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 430,
        "y": 500,
        "wires": [
            [
                "9b0c4919.432c68"
            ],
            [
                "5650274e.3a1738"
            ]
        ]
    },
    {
        "id": "83c823a.f8046e",
        "type": "api-current-state",
        "z": "5e97ea24.516424",
        "name": "Max temp",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "0",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.dark_sky_forecast_daytime_high_temperature_0d",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 440,
        "y": 580,
        "wires": [
            [
                "9885bb2b.020218"
            ],
            []
        ]
    },
    {
        "id": "9885bb2b.020218",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Water Time",
        "func": "msg.max_temp = msg.payload\nvar seconds = (0.5 * msg.payload) * 60\nvar pulse = 0;\n\nif(seconds <= 11)\n{\n    pulse = seconds * 10;\n}\nelse\n{\n    pulse = seconds + 100;\n}\nmsg.topic = \"sonoff_garden/cmnd/PulseTime\"\nmsg.payload = pulse\n\nmsg.delay = (seconds + 60) * 1000\nmsg.seconds = seconds\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 630,
        "y": 580,
        "wires": [
            [
                "c0a2e16.268822",
                "bedb8077.e3b2",
                "6ce2a0d7.53834",
                "48ccf6bc.6f7a98"
            ]
        ]
    },
    {
        "id": "bedb8077.e3b2",
        "type": "mqtt out",
        "z": "5e97ea24.516424",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1146,
        "y": 580,
        "wires": []
    },
    {
        "id": "5650274e.3a1738",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Prepare text",
        "func": "msg.rainfall = msg.payload\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 630,
        "y": 500,
        "wires": [
            [
                "83c823a.f8046e"
            ]
        ]
    },
    {
        "id": "c0a2e16.268822",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Prepare Text",
        "func": "msg.topic = \"garden\"\nmsg.payload = \"PM Water Time: \" + ((msg.payload - 100) / 60);\nmsg.payload += \" minutes\\n\";\nmsg.payload += \"Rain Today: \" + msg.rainfall;\nmsg.payload += \" mm\\n\";\nmsg.payload += \"Max Temp: \" + msg.max_temp;\nmsg.payload += \"C\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 640,
        "wires": [
            [
                "3a7c0926.309d16"
            ]
        ]
    },
    {
        "id": "e24fae3.91ca85",
        "type": "inject",
        "z": "5e97ea24.516424",
        "name": "8pm",
        "repeat": "",
        "crontab": "00 20 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 500,
        "wires": [
            [
                "5f47c1e.369284"
            ]
        ]
    },
    {
        "id": "9b0c4919.432c68",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Prepare Text",
        "func": "msg.topic = \"garden\"\nvar rainfall = msg.payload;\nmsg.payload = \"No water tonight, it rained.\"\nmsg.payload += \"Rain Today: \" + rainfall;\nmsg.payload += \" mm\\n\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 630,
        "y": 460,
        "wires": [
            [
                "e5039bb6.86f6d8"
            ]
        ]
    },
    {
        "id": "e5039bb6.86f6d8",
        "type": "link out",
        "z": "5e97ea24.516424",
        "name": "",
        "links": [
            "bde211f0.94d9c"
        ],
        "x": 755,
        "y": 460,
        "wires": []
    },
    {
        "id": "3a7c0926.309d16",
        "type": "link out",
        "z": "5e97ea24.516424",
        "name": "",
        "links": [
            "bde211f0.94d9c"
        ],
        "x": 975,
        "y": 640,
        "wires": []
    },
    {
        "id": "d9b9e2ee.667f6",
        "type": "api-current-state",
        "z": "5e97ea24.516424",
        "name": "Rain Chance",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "0",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.dark_sky_forecast_precip_probability_0d",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload.rain_chance",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 410,
        "y": 100,
        "wires": [
            [
                "dd09b04.2d0a35"
            ],
            [
                "dd09b04.2d0a35"
            ]
        ]
    },
    {
        "id": "dd09b04.2d0a35",
        "type": "api-current-state",
        "z": "5e97ea24.516424",
        "name": "Intensity",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "0.25",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.dark_sky_forecast_daily_max_precip_intensity_0d",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload.rain_intensity",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 420,
        "y": 180,
        "wires": [
            [
                "25ed69a.ace5796"
            ],
            [
                "25ed69a.ace5796"
            ]
        ]
    },
    {
        "id": "25ed69a.ace5796",
        "type": "api-current-state",
        "z": "5e97ea24.516424",
        "name": "Max temp",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "0",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.dark_sky_forecast_daytime_high_temperature_0d",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload.max_temp",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 420,
        "y": 260,
        "wires": [
            [
                "b0bcfb6f.5f8148"
            ],
            [
                "b0bcfb6f.5f8148"
            ]
        ]
    },
    {
        "id": "d78eef7f.7e334",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Prep",
        "func": "var payload;\n\nvar rain_intensity = 0;\nvar rain_chance = 0;\nvar max_temp = 0;\nvar water_seconds = 0;\n\npayload = {rain_intensity, rain_chance, max_temp, water_seconds};\n\nmsg.payload = payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 250,
        "y": 100,
        "wires": [
            [
                "d9b9e2ee.667f6"
            ]
        ]
    },
    {
        "id": "18bc4228.2b5abe",
        "type": "inject",
        "z": "5e97ea24.516424",
        "name": "5am",
        "repeat": "",
        "crontab": "00 05 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 100,
        "wires": [
            [
                "d78eef7f.7e334"
            ]
        ]
    },
    {
        "id": "b0bcfb6f.5f8148",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Water Time",
        "func": "if((msg.payload.rain_chance > 50) & (msg.payload.rain_intensity > 0.25))\n{\n    return [msg, null];\n}\n\nmsg.payload.water_seconds = ((0.75 * msg.payload.max_temp) + 0) * 60\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "x": 670,
        "y": 180,
        "wires": [
            [
                "dd29a7a8.79c0c8"
            ],
            [
                "e8aa62c4.2a31d",
                "b16d386e.234a88"
            ]
        ]
    },
    {
        "id": "dd29a7a8.79c0c8",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Prepare Text",
        "func": "msg.topic = \"garden\"\nvar content = \"Expected rain: \" + msg.payload.rain_intensity;\ncontent += \" mm/h\\n\";\ncontent += \"Chance: \" + msg.payload.rain_chance;\ncontent += \"%\\n\";\ncontent += \"So no water this morning\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 890,
        "y": 140,
        "wires": [
            [
                "bbbb66d0.130c98"
            ]
        ]
    },
    {
        "id": "bbbb66d0.130c98",
        "type": "link out",
        "z": "5e97ea24.516424",
        "name": "",
        "links": [
            "bde211f0.94d9c"
        ],
        "x": 1055,
        "y": 140,
        "wires": []
    },
    {
        "id": "e8aa62c4.2a31d",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Seconds to Pulses",
        "func": "var seconds = msg.payload.water_seconds;\nvar pulse = 0;\n\nif(seconds <= 11)\n{\n    pulse = seconds * 10;\n}\nelse\n{\n    pulse = seconds + 100;\n}\n\nmsg.topic = \"sonoff_garden/cmnd/PulseTime\"\nmsg.payload = pulse\nmsg.delay = (seconds + 60) * 1000\nmsg.seconds = seconds\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 910,
        "y": 240,
        "wires": [
            [
                "6e7e7229.cce99c",
                "969fb0ca.2fa5b",
                "6f12e6d4.0e07d8"
            ]
        ]
    },
    {
        "id": "6e7e7229.cce99c",
        "type": "mqtt out",
        "z": "5e97ea24.516424",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1390,
        "y": 240,
        "wires": []
    },
    {
        "id": "b16d386e.234a88",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Prepare Text",
        "func": "msg.topic = \"garden\"\nvar content = \"AM Water Time: \" + ((msg.payload.water_seconds) / 60);\ncontent += \" minutes\\n\";\ncontent += \"Expected rain: \" + msg.payload.rain_intensity;\ncontent += \" mm/h\\n\";\ncontent += \"Chance: \" + msg.payload.rain_chance;\ncontent += \"%\\n\";\ncontent += \"Max Temp: \" + msg.payload.max_temp;\ncontent += \"C\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 890,
        "y": 200,
        "wires": [
            [
                "3d88c4d8.4b121c"
            ]
        ]
    },
    {
        "id": "3d88c4d8.4b121c",
        "type": "link out",
        "z": "5e97ea24.516424",
        "name": "",
        "links": [
            "bde211f0.94d9c"
        ],
        "x": 1055,
        "y": 200,
        "wires": []
    },
    {
        "id": "923cc35a.0165f",
        "type": "server-state-changed",
        "z": "5e97ea24.516424",
        "name": "Manual trigger",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "input_boolean.garden_test",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 466,
        "y": 1020,
        "wires": [
            [
                "cf3f50a7.7d179",
                "ef9cf33f.921aa"
            ],
            []
        ]
    },
    {
        "id": "cf3f50a7.7d179",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Water Time",
        "func": "var seconds = 30\nvar pulse = 0;\n\nif(seconds <= 11)\n{\n    pulse = seconds * 10;\n}\nelse\n{\n    pulse = seconds + 100;\n}\nmsg.topic = \"sonoff_garden/cmnd/PulseTime\"\nmsg.payload = pulse\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 666,
        "y": 980,
        "wires": [
            [
                "aef54f7f.a4bcf"
            ]
        ]
    },
    {
        "id": "aef54f7f.a4bcf",
        "type": "mqtt out",
        "z": "5e97ea24.516424",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 866,
        "y": 980,
        "wires": []
    },
    {
        "id": "ef9cf33f.921aa",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 656,
        "y": 1040,
        "wires": [
            [
                "6b4d9d14.377144"
            ]
        ]
    },
    {
        "id": "67c1e6ae.80e358",
        "type": "mqtt out",
        "z": "5e97ea24.516424",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1046,
        "y": 1040,
        "wires": []
    },
    {
        "id": "6b4d9d14.377144",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Power",
        "func": "msg.topic = \"sonoff_garden/cmnd/Power\"\nmsg.payload = \"1\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 826,
        "y": 1040,
        "wires": [
            [
                "b5c8d8bd.f19a28",
                "67c1e6ae.80e358"
            ]
        ]
    },
    {
        "id": "b5c8d8bd.f19a28",
        "type": "api-call-service",
        "z": "5e97ea24.516424",
        "name": "Turn off bool",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "input_boolean",
        "service": "turn_off",
        "entityId": "input_boolean.garden_test",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1016,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "1c8fee3.7a81212",
        "type": "mqtt out",
        "z": "5e97ea24.516424",
        "name": "",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "2eafe4c0.b7da5c",
        "x": 686,
        "y": 1220,
        "wires": []
    },
    {
        "id": "1131064d.e21e5a",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Water Time",
        "func": "var seconds = 60\nvar pulse = 0\n\nif(seconds <= 11)\n{\n    pulse = seconds * 10;\n}\nelse\n{\n    pulse = seconds + 100;\n}\nmsg.topic = \"sonoff_entrance/cmnd/PulseTime\"\nmsg.payload = pulse\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 506,
        "y": 1220,
        "wires": [
            [
                "1c8fee3.7a81212",
                "827a5de.844f4a"
            ]
        ]
    },
    {
        "id": "63b32a88.a14424",
        "type": "inject",
        "z": "5e97ea24.516424",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 276,
        "y": 1220,
        "wires": [
            [
                "1131064d.e21e5a"
            ]
        ]
    },
    {
        "id": "827a5de.844f4a",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 696,
        "y": 1300,
        "wires": [
            [
                "67bd8809.f97438"
            ]
        ]
    },
    {
        "id": "6b2a84ab.03693c",
        "type": "mqtt out",
        "z": "5e97ea24.516424",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1026,
        "y": 1300,
        "wires": []
    },
    {
        "id": "67bd8809.f97438",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Power",
        "func": "msg.topic = \"sonoff_entrance/cmnd/Power\"\nmsg.payload = 1\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 866,
        "y": 1300,
        "wires": [
            [
                "6b2a84ab.03693c"
            ]
        ]
    },
    {
        "id": "6ce2a0d7.53834",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 836,
        "y": 540,
        "wires": [
            [
                "f599842.58fa478"
            ]
        ]
    },
    {
        "id": "f599842.58fa478",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Power",
        "func": "msg.topic = \"sonoff_garden/cmnd/Power\"\nmsg.payload = \"1\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 986,
        "y": 540,
        "wires": [
            [
                "bedb8077.e3b2"
            ]
        ]
    },
    {
        "id": "969fb0ca.2fa5b",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1120,
        "y": 300,
        "wires": [
            [
                "85d49bdd.570708"
            ]
        ]
    },
    {
        "id": "85d49bdd.570708",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "Power",
        "func": "msg.topic = \"sonoff_garden/cmnd/Power\"\nmsg.payload = \"1\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1250,
        "y": 300,
        "wires": [
            [
                "6e7e7229.cce99c"
            ]
        ]
    },
    {
        "id": "6f12e6d4.0e07d8",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delayv",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1120,
        "y": 380,
        "wires": [
            [
                "7a8c2275.de509c"
            ]
        ]
    },
    {
        "id": "7a8c2275.de509c",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "extract delay",
        "func": "msg.delay = msg.seconds * 1000\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1290,
        "y": 380,
        "wires": [
            [
                "f5f98afa.e3e548"
            ]
        ]
    },
    {
        "id": "f5f98afa.e3e548",
        "type": "api-call-service",
        "z": "5e97ea24.516424",
        "name": "Water On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "switch",
        "service": "turn_on",
        "entityId": "switch.front_garden_irrigation",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1460,
        "y": 380,
        "wires": [
            [
                "ee747518.3b34e8"
            ]
        ]
    },
    {
        "id": "ee747518.3b34e8",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delayv",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1620,
        "y": 380,
        "wires": [
            [
                "a1f2f568.3b3f48"
            ]
        ]
    },
    {
        "id": "a1f2f568.3b3f48",
        "type": "api-call-service",
        "z": "5e97ea24.516424",
        "name": "Water On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "switch",
        "service": "turn_off",
        "entityId": "switch.front_garden_irrigation",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1780,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "48ccf6bc.6f7a98",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delayv",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 920,
        "y": 480,
        "wires": [
            [
                "6990fc0a.de8284"
            ]
        ]
    },
    {
        "id": "6990fc0a.de8284",
        "type": "function",
        "z": "5e97ea24.516424",
        "name": "extract delay",
        "func": "msg.delay = msg.seconds * 1000\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1090,
        "y": 480,
        "wires": [
            [
                "56ca6eef.d61f6"
            ]
        ]
    },
    {
        "id": "56ca6eef.d61f6",
        "type": "api-call-service",
        "z": "5e97ea24.516424",
        "name": "Water On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "switch",
        "service": "turn_on",
        "entityId": "switch.front_garden_irrigation",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1260,
        "y": 480,
        "wires": [
            [
                "59e3eace.18eb34"
            ]
        ]
    },
    {
        "id": "59e3eace.18eb34",
        "type": "delay",
        "z": "5e97ea24.516424",
        "name": "",
        "pauseType": "delayv",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1420,
        "y": 480,
        "wires": [
            [
                "d24745bb.0b44e8"
            ]
        ]
    },
    {
        "id": "d24745bb.0b44e8",
        "type": "api-call-service",
        "z": "5e97ea24.516424",
        "name": "Water On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "switch",
        "service": "turn_off",
        "entityId": "switch.front_garden_irrigation",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1580,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "cbe0832e.f82a",
        "type": "cast-to-client",
        "z": "fa310ecb.c84eb",
        "name": "",
        "url": "",
        "contentType": "",
        "message": "",
        "language": "en",
        "ip": "",
        "port": "",
        "volume": "100",
        "x": 730,
        "y": 420,
        "wires": [
            [
                "8016a89c.b02d68"
            ]
        ],
        "icon": "node-red-contrib-cast/home.png"
    },
    {
        "id": "ae14cd86.e1a92",
        "type": "inject",
        "z": "fa310ecb.c84eb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 340,
        "y": 420,
        "wires": [
            [
                "601a200c.7c9ec"
            ]
        ]
    },
    {
        "id": "601a200c.7c9ec",
        "type": "change",
        "z": "fa310ecb.c84eb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ip",
                "pt": "msg",
                "to": "192.168.1.27",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "message",
                "pt": "msg",
                "to": "Testing 1 2 3. ",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "language",
                "pt": "msg",
                "to": "En-gb",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 420,
        "wires": [
            [
                "cbe0832e.f82a"
            ]
        ]
    },
    {
        "id": "8016a89c.b02d68",
        "type": "debug",
        "z": "fa310ecb.c84eb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 890,
        "y": 420,
        "wires": []
    },
    {
        "id": "3da2ffbc.1e6b1",
        "type": "comment",
        "z": "fa310ecb.c84eb",
        "name": "say a text",
        "info": "",
        "x": 300,
        "y": 380,
        "wires": []
    },
    {
        "id": "5cc51160.65fdd",
        "type": "spotify",
        "z": "fa310ecb.c84eb",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "getMyDevices",
        "x": 450,
        "y": 580,
        "wires": [
            [
                "e4c54319.69dcf"
            ]
        ]
    },
    {
        "id": "34a73767.208898",
        "type": "inject",
        "z": "fa310ecb.c84eb",
        "name": "",
        "props": [],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 290,
        "y": 580,
        "wires": [
            [
                "5cc51160.65fdd",
                "b597ff23.29d"
            ]
        ]
    },
    {
        "id": "e4c54319.69dcf",
        "type": "debug",
        "z": "fa310ecb.c84eb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 620,
        "wires": []
    },
    {
        "id": "b597ff23.29d",
        "type": "spotify",
        "z": "fa310ecb.c84eb",
        "name": "Spotify",
        "auth": "43bf985d.fa0f08",
        "api": "getUserPlaylists",
        "x": 450,
        "y": 640,
        "wires": [
            [
                "e4c54319.69dcf"
            ]
        ]
    },
    {
        "id": "2812674d.817bc8",
        "type": "function",
        "z": "fa310ecb.c84eb",
        "name": "John Mayer",
        "func": "msg.payload=\"spotify:playlist:37i9dQZF1DWYrlaUEYy4Vg\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 400,
        "y": 500,
        "wires": [
            [
                "9ddaee69.14da5"
            ]
        ]
    },
    {
        "id": "b3a79b0b.db0ed8",
        "type": "inject",
        "z": "fa310ecb.c84eb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 220,
        "y": 500,
        "wires": [
            [
                "2812674d.817bc8"
            ]
        ]
    },
    {
        "id": "9ddaee69.14da5",
        "type": "subflow:8efb2399.f1af9",
        "z": "fa310ecb.c84eb",
        "name": "",
        "env": [],
        "x": 600,
        "y": 500,
        "wires": []
    },
    {
        "id": "2c447000.ed44",
        "type": "link out",
        "z": "fa310ecb.c84eb",
        "name": "",
        "links": [
            "8e6ec212.65191"
        ],
        "x": 1015,
        "y": 740,
        "wires": []
    },
    {
        "id": "e2f4c507.c56d18",
        "type": "http request",
        "z": "fa310ecb.c84eb",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "https://www.diyelectronics.co.za/store/198-3d-printers?orderby=price&orderway=asc",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 330,
        "y": 740,
        "wires": [
            [
                "c590b0ad.0f799"
            ]
        ]
    },
    {
        "id": "c590b0ad.0f799",
        "type": "html",
        "z": "fa310ecb.c84eb",
        "name": "",
        "property": "",
        "outproperty": "",
        "tag": ".product-count",
        "ret": "html",
        "as": "single",
        "x": 500,
        "y": 740,
        "wires": [
            [
                "356484fd.cb0f7c"
            ]
        ]
    },
    {
        "id": "356484fd.cb0f7c",
        "type": "string",
        "z": "fa310ecb.c84eb",
        "name": "",
        "methods": [
            {
                "name": "strip",
                "params": [
                    {
                        "type": "str",
                        "value": "Showing 1 - 24 of "
                    }
                ]
            },
            {
                "name": "strip",
                "params": [
                    {
                        "type": "str",
                        "value": " items"
                    }
                ]
            },
            {
                "name": "toInteger",
                "params": []
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 650,
        "y": 740,
        "wires": [
            [
                "47fd65e.950779c"
            ]
        ]
    },
    {
        "id": "47fd65e.950779c",
        "type": "switch",
        "z": "fa310ecb.c84eb",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "36",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 770,
        "y": 740,
        "wires": [
            [
                "704ed9eb.260878"
            ]
        ]
    },
    {
        "id": "704ed9eb.260878",
        "type": "function",
        "z": "fa310ecb.c84eb",
        "name": "Prepare Text",
        "func": "msg.topic = \"test\"\nvar content = \"Products added!\\n\"\ncontent += msg.payload;\ncontent += \" products now in stock.\";\ncontent += \"https://www.diyelectronics.co.za/store/198-3d-printers?orderby=price&orderway=asc\"\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 910,
        "y": 740,
        "wires": [
            [
                "2c447000.ed44"
            ]
        ]
    },
    {
        "id": "8a3e49e7.4daba8",
        "type": "link out",
        "z": "fa310ecb.c84eb",
        "name": "",
        "links": [
            "8e6ec212.65191"
        ],
        "x": 575,
        "y": 860,
        "wires": []
    },
    {
        "id": "a49f86eb.5994e8",
        "type": "inject",
        "z": "fa310ecb.c84eb",
        "name": "make request",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "a5429b18.214428",
        "type": "http request",
        "z": "fa310ecb.c84eb",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "https://www.diyelectronics.co.za/store/198-3d-printers?orderby=price&orderway=asc",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 330,
        "y": 800,
        "wires": [
            [
                "1ec3c50b.2c54bb"
            ]
        ]
    },
    {
        "id": "1ec3c50b.2c54bb",
        "type": "html",
        "z": "fa310ecb.c84eb",
        "name": "",
        "property": "",
        "outproperty": "",
        "tag": ".product-container",
        "ret": "html",
        "as": "multi",
        "x": 510,
        "y": 800,
        "wires": [
            [
                "7bbd19a8.39fe08"
            ]
        ]
    },
    {
        "id": "7bbd19a8.39fe08",
        "type": "function",
        "z": "fa310ecb.c84eb",
        "name": "filter",
        "func": "if(msg.payload.includes(\"Giveaway\"))\n    return msg;\n\n\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 800,
        "wires": [
            [
                "83bdd7b4.04aa68"
            ]
        ]
    },
    {
        "id": "83bdd7b4.04aa68",
        "type": "html",
        "z": "fa310ecb.c84eb",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": ".product-image-container",
        "ret": "html",
        "as": "multi",
        "x": 850,
        "y": 800,
        "wires": [
            [
                "ff9bc552.2ccba8"
            ]
        ]
    },
    {
        "id": "ff9bc552.2ccba8",
        "type": "string",
        "z": "fa310ecb.c84eb",
        "name": "",
        "methods": [
            {
                "name": "decodeHTMLEntities",
                "params": []
            },
            {
                "name": "strip",
                "params": [
                    {
                        "type": "str",
                        "value": "<a class=\"product_img_link\" href=\""
                    }
                ]
            },
            {
                "name": "split",
                "params": [
                    {
                        "type": "str",
                        "value": "\""
                    },
                    {
                        "type": "num",
                        "value": "2"
                    }
                ]
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 170,
        "y": 860,
        "wires": [
            [
                "1375878c.989168"
            ]
        ]
    },
    {
        "id": "ab7ed81f.e392c8",
        "type": "function",
        "z": "fa310ecb.c84eb",
        "name": "Prepare Text",
        "func": "msg.topic = \"Giveaway\"\nvar content = \"Product added!\\n\"\ncontent += msg.payload[0];\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 470,
        "y": 860,
        "wires": [
            [
                "8a3e49e7.4daba8"
            ]
        ]
    },
    {
        "id": "1375878c.989168",
        "type": "function",
        "z": "fa310ecb.c84eb",
        "name": "filter2",
        "func": "if(msg.payload[0].includes(\"2743\"))\n    return null;\n\nif(msg.payload[0].includes(\"2750\"))\n    return null;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 310,
        "y": 860,
        "wires": [
            [
                "ab7ed81f.e392c8"
            ]
        ]
    },
    {
        "id": "dbd5310b.88731",
        "type": "mqtt in",
        "z": "fa310ecb.c84eb",
        "name": "zm",
        "topic": "zoneminder/#",
        "qos": "0",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "inputs": 0,
        "x": 320,
        "y": 1060,
        "wires": [
            [
                "834916f4.ab9f48"
            ]
        ]
    },
    {
        "id": "834916f4.ab9f48",
        "type": "debug",
        "z": "fa310ecb.c84eb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 500,
        "y": 1060,
        "wires": []
    },
    {
        "id": "35140da4b8ad2d2e",
        "type": "api-call-service",
        "z": "fa310ecb.c84eb",
        "name": "Spotcast",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "spotcast",
        "service": "start",
        "entityId": "bitbrain-za",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 920,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "b83a8247df5db669",
        "type": "function",
        "z": "fa310ecb.c84eb",
        "name": "Load Playlist",
        "func": "msg.payload = \n{\n    data:\n    {\n        \"device_name\":\"Bedroom speaker\",\n        \"uri\":\"spotify:playlist:37i9dQZF1DX1rVvRgjX59F\",\n        \"random_song\": true\n    }\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 730,
        "y": 220,
        "wires": [
            [
                "35140da4b8ad2d2e"
            ]
        ]
    },
    {
        "id": "77872eab86b8b17a",
        "type": "inject",
        "z": "fa310ecb.c84eb",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 560,
        "y": 220,
        "wires": [
            [
                "b83a8247df5db669"
            ]
        ]
    },
    {
        "id": "57797689.55f7e8",
        "type": "link in",
        "z": "796da880.c06928",
        "name": "Message Home",
        "links": [
            "543bd5c9.d60d2c",
            "f8882e97.4f3ab",
            "21ff3a8b.1ea676",
            "1a04512e.a436ff",
            "16b47f9.1d2b48",
            "11ad200e.773aa",
            "1e436d78.92e373",
            "d37eeef6.6df4",
            "14ea7344.24e0ed",
            "62f59b1d.7c9e04",
            "428c547c.274afc",
            "2af8a48.5976f5c",
            "91c5ac20.3ed99",
            "506ca35e.f976cc",
            "896a067c.ebb578",
            "5e8370.2ac0ac9",
            "5014606e.ce97a",
            "6a3feee7.e3f45",
            "e1e2b20ff0985cbf"
        ],
        "x": 175,
        "y": 60,
        "wires": [
            [
                "1543dca2.13e693"
            ]
        ]
    },
    {
        "id": "e83933ef.2b28a",
        "type": "link in",
        "z": "796da880.c06928",
        "name": "Message Battery",
        "links": [
            "a8224a9c.8de248"
        ],
        "x": 175,
        "y": 100,
        "wires": [
            [
                "692b408b.b8027"
            ]
        ]
    },
    {
        "id": "bde211f0.94d9c",
        "type": "link in",
        "z": "796da880.c06928",
        "name": "Messsage Garden",
        "links": [
            "249f4117.3329de",
            "3a7c0926.309d16",
            "c678cc7c.9e512",
            "e5039bb6.86f6d8",
            "146cf9e5.0f3a66",
            "bbbb66d0.130c98",
            "df720f01.a53be",
            "3d88c4d8.4b121c"
        ],
        "x": 175,
        "y": 140,
        "wires": [
            [
                "d189275e.c214e8"
            ]
        ]
    },
    {
        "id": "8e6ec212.65191",
        "type": "link in",
        "z": "796da880.c06928",
        "name": "Messsage Test",
        "links": [
            "1cc30d5e.422973",
            "2c447000.ed44",
            "8a3e49e7.4daba8"
        ],
        "x": 175,
        "y": 180,
        "wires": [
            [
                "99d5ec89.b6916"
            ]
        ]
    },
    {
        "id": "1543dca2.13e693",
        "type": "telegrambot-notify",
        "z": "796da880.c06928",
        "name": "Home",
        "bot": "b2774519.2ee368",
        "chatId": "-257391012",
        "message": "",
        "parseMode": "",
        "x": 290,
        "y": 60,
        "wires": []
    },
    {
        "id": "692b408b.b8027",
        "type": "telegrambot-notify",
        "z": "796da880.c06928",
        "name": "Batteries",
        "bot": "cf16b2fa.ceee4",
        "chatId": "-257391012",
        "message": "",
        "parseMode": "",
        "x": 300,
        "y": 100,
        "wires": []
    },
    {
        "id": "d189275e.c214e8",
        "type": "telegrambot-notify",
        "z": "796da880.c06928",
        "name": "Garden",
        "bot": "997ea59b.693238",
        "chatId": "-257391012",
        "message": "",
        "parseMode": "",
        "x": 300,
        "y": 140,
        "wires": []
    },
    {
        "id": "99d5ec89.b6916",
        "type": "telegrambot-notify",
        "z": "796da880.c06928",
        "name": "Test",
        "bot": "b5dd546c.68b1b8",
        "chatId": "-257391012",
        "message": "",
        "parseMode": "",
        "x": 290,
        "y": 180,
        "wires": []
    },
    {
        "id": "aaa103ac.4c91b",
        "type": "telegrambot-notify",
        "z": "796da880.c06928",
        "name": "Printer",
        "bot": "e51ac803.94beb8",
        "chatId": "532693134",
        "message": "",
        "parseMode": "",
        "x": 290,
        "y": 220,
        "wires": []
    },
    {
        "id": "a615dd4.e6e812",
        "type": "link in",
        "z": "796da880.c06928",
        "name": "Messsage Printer",
        "links": [
            "a42b90bc.5a004",
            "de506372.76d52",
            "7809560.651a7ac",
            "617c65e3.f1f6cc",
            "9475194a25f87f9a",
            "d72b794507f2b988"
        ],
        "x": 175,
        "y": 220,
        "wires": [
            [
                "aaa103ac.4c91b"
            ]
        ]
    },
    {
        "id": "449752dc.7a7b9c",
        "type": "switch",
        "z": "dfa48b6f.2ff088",
        "name": "Message",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "left",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "both",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "right",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 420,
        "y": 1200,
        "wires": [
            [
                "1c133f10.23a2c1"
            ],
            [
                "bfb2175a780ebedf"
            ],
            [
                "d98453431b9c5412"
            ]
        ]
    },
    {
        "id": "94871f17.da95b",
        "type": "server-state-changed",
        "z": "dfa48b6f.2ff088",
        "name": "Button",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.printer_switch_click",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 1,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 280,
        "y": 1200,
        "wires": [
            [
                "449752dc.7a7b9c"
            ]
        ]
    },
    {
        "id": "8d7e5c57.6ef06",
        "type": "subflow:ecfae70d.6fd868",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "env": [
            {
                "name": "api_key",
                "value": "FE551620784F47DC962EE9D3FE2F44F8",
                "type": "str"
            },
            {
                "name": "ip",
                "value": "192.168.1.18",
                "type": "str"
            }
        ],
        "x": 960,
        "y": 1160,
        "wires": []
    },
    {
        "id": "1c133f10.23a2c1",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Toggle Light",
        "func": "msg.light = \"toggle\"\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 650,
        "y": 1140,
        "wires": [
            [
                "8d7e5c57.6ef06"
            ]
        ]
    },
    {
        "id": "169f40f4.cb8fff",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Toggle Power",
        "func": "msg.printer = \"toggle\"\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 800,
        "y": 1260,
        "wires": [
            [
                "8d7e5c57.6ef06"
            ]
        ]
    },
    {
        "id": "3e130315.31da7c",
        "type": "inject",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 08 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 720,
        "wires": [
            [
                "7fea3afe.8deee4"
            ]
        ]
    },
    {
        "id": "7fea3afe.8deee4",
        "type": "api-current-state",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "50",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.filament_climate_humidity",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 570,
        "y": 720,
        "wires": [
            [
                "b2b75a68.f59268"
            ],
            []
        ]
    },
    {
        "id": "b2b75a68.f59268",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Prepare Text",
        "func": "msg.topic = \"Printer\"\nvar content = \"Time to replace the filament\\n\";\ncontent +=  \"Current humidity level: \"+ msg.payload + \"%\\n\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 850,
        "y": 720,
        "wires": [
            [
                "a42b90bc.5a004"
            ]
        ]
    },
    {
        "id": "a42b90bc.5a004",
        "type": "link out",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "links": [
            "a615dd4.e6e812"
        ],
        "x": 955,
        "y": 720,
        "wires": []
    },
    {
        "id": "39257c66.86ce74",
        "type": "http request",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "192.168.1.19/rr_status?type=003",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1130,
        "y": 520,
        "wires": [
            [
                "54da9b84.2a3884",
                "447af0fe4f834cf9"
            ]
        ]
    },
    {
        "id": "c91f9c79.7c412",
        "type": "inject",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payloadType": "date",
        "x": 810,
        "y": 520,
        "wires": [
            [
                "39257c66.86ce74"
            ]
        ]
    },
    {
        "id": "54da9b84.2a3884",
        "type": "json",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1290,
        "y": 480,
        "wires": [
            [
                "92f45edd.0538a"
            ]
        ]
    },
    {
        "id": "92f45edd.0538a",
        "type": "switch",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "I",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "C",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "B",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "P",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "D",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "S",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "R",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "H",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "F",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "T",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 10,
        "x": 1490,
        "y": 480,
        "wires": [
            [],
            [],
            [],
            [
                "3f01a9192e5fd9e0"
            ],
            [],
            [],
            [],
            [
                "55096194.460f9"
            ],
            [],
            []
        ]
    },
    {
        "id": "a657f27d.46e17",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Stopped",
        "func": "msg.topic = \"Printer\"\nvar content = \"Job has been paused\\n\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 580,
        "y": 380,
        "wires": [
            [
                "de506372.76d52"
            ]
        ]
    },
    {
        "id": "de506372.76d52",
        "type": "link out",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "links": [
            "a615dd4.e6e812"
        ],
        "x": 735,
        "y": 380,
        "wires": []
    },
    {
        "id": "55096194.460f9",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Halted",
        "func": "msg.topic = \"Printer\"\nvar content = \"Printer has halted\\n\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1630,
        "y": 560,
        "wires": [
            [
                "7809560.651a7ac"
            ]
        ]
    },
    {
        "id": "7809560.651a7ac",
        "type": "link out",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "links": [
            "a615dd4.e6e812"
        ],
        "x": 1815,
        "y": 560,
        "wires": []
    },
    {
        "id": "bf3156de.febfb8",
        "type": "server-state-changed",
        "z": "dfa48b6f.2ff088",
        "name": "Print Status",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "binary_sensor.octoprint_printing",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": true,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 250,
        "y": 140,
        "wires": [
            [
                "217864df.61a3fc"
            ],
            []
        ]
    },
    {
        "id": "217864df.61a3fc",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Job Done",
        "func": "msg.topic = \"CR10s\"\nvar content = \"CR10s job complete\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 140,
        "wires": [
            [
                "617c65e3.f1f6cc"
            ]
        ]
    },
    {
        "id": "617c65e3.f1f6cc",
        "type": "link out",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "links": [
            "a615dd4.e6e812"
        ],
        "x": 535,
        "y": 140,
        "wires": []
    },
    {
        "id": "3ef9ab35.01be64",
        "type": "server-state-changed",
        "z": "dfa48b6f.2ff088",
        "name": "Snail Done",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "input_boolean.print_finished",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 260,
        "y": 200,
        "wires": [
            [
                "4c73cfca.23c7"
            ],
            []
        ]
    },
    {
        "id": "4c73cfca.23c7",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Job Done",
        "func": "msg.topic = \"Snail\"\nvar content = \"Snail job complete\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 200,
        "wires": [
            [
                "617c65e3.f1f6cc"
            ]
        ]
    },
    {
        "id": "c4c25a04.c6c528",
        "type": "server-state-changed",
        "z": "dfa48b6f.2ff088",
        "name": "Duet Paused",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.duet_status",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "S",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 370,
        "y": 380,
        "wires": [
            [
                "a657f27d.46e17"
            ],
            []
        ]
    },
    {
        "id": "bfb2175a780ebedf",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Toggle Power",
        "func": "msg.printer = \"toggle\"\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 660,
        "y": 1200,
        "wires": [
            [
                "8d7e5c57.6ef06"
            ]
        ]
    },
    {
        "id": "d98453431b9c5412",
        "type": "api-current-state",
        "z": "dfa48b6f.2ff088",
        "name": "printing?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "Printing",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sensor.octoprint_current_state",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 600,
        "y": 1260,
        "wires": [
            [
                "169f40f4.cb8fff"
            ],
            []
        ]
    },
    {
        "id": "3f01a9192e5fd9e0",
        "type": "http request",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "192.168.1.19/rr_status?type=003",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1990,
        "y": 460,
        "wires": [
            [
                "a93e72a21fc55af1"
            ]
        ]
    },
    {
        "id": "2abfb9bef0afb2d9",
        "type": "switch",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "property": "payload.status",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "I",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "C",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "B",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "P",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "D",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "S",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "R",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "H",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "F",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "T",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 10,
        "x": 1850,
        "y": 720,
        "wires": [
            [
                "42a229c974fd4db3"
            ],
            [],
            [],
            [
                "447af0fe4f834cf9",
                "f5e39dabec155c01"
            ],
            [],
            [
                "f48414669df83d26"
            ],
            [],
            [
                "f48414669df83d26"
            ],
            [],
            []
        ]
    },
    {
        "id": "447af0fe4f834cf9",
        "type": "stoptimer",
        "z": "dfa48b6f.2ff088",
        "duration": "30",
        "units": "Second",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 1230,
        "y": 640,
        "wires": [
            [
                "39257c66.86ce74"
            ],
            []
        ]
    },
    {
        "id": "f5e39dabec155c01",
        "type": "stoptimer",
        "z": "dfa48b6f.2ff088",
        "duration": "3",
        "units": "Second",
        "payloadtype": "num",
        "payloadval": "0",
        "name": "",
        "x": 2060,
        "y": 700,
        "wires": [
            [
                "3f01a9192e5fd9e0"
            ],
            []
        ]
    },
    {
        "id": "f48414669df83d26",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Halted",
        "func": "msg.topic = \"Printer\"\nvar content = \"Printer has halted\\n\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2030,
        "y": 740,
        "wires": [
            [
                "9475194a25f87f9a"
            ]
        ]
    },
    {
        "id": "9475194a25f87f9a",
        "type": "link out",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "links": [
            "a615dd4.e6e812"
        ],
        "x": 2155,
        "y": 740,
        "wires": []
    },
    {
        "id": "42a229c974fd4db3",
        "type": "function",
        "z": "dfa48b6f.2ff088",
        "name": "Done",
        "func": "msg.topic = \"Printer\"\nvar content = \"Snail has finished\\n\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2010,
        "y": 640,
        "wires": [
            [
                "d72b794507f2b988"
            ]
        ]
    },
    {
        "id": "d72b794507f2b988",
        "type": "link out",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "links": [
            "a615dd4.e6e812"
        ],
        "x": 2175,
        "y": 600,
        "wires": []
    },
    {
        "id": "a93e72a21fc55af1",
        "type": "json",
        "z": "dfa48b6f.2ff088",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2150,
        "y": 460,
        "wires": [
            [
                "2abfb9bef0afb2d9"
            ]
        ]
    },
    {
        "id": "2e2298f5.0bdfc8",
        "type": "inject",
        "z": "2c8f60c4.cfd28",
        "name": "Every Second",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 280,
        "wires": [
            [
                "4f14763c.99f148"
            ]
        ]
    },
    {
        "id": "7cc24544.b8b70c",
        "type": "rbe",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 470,
        "y": 160,
        "wires": [
            [
                "e4ab0d4b.18e32"
            ]
        ]
    },
    {
        "id": "4f14763c.99f148",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Get Hour",
        "func": "function gethour() {\n var date = new Date();\n var hour = (\"0\"+date.getHours()).substr(-2);\n return hour;\n}\n\nvar hour = gethour();\n\nreturn { payload : hour };",
        "outputs": 1,
        "noerr": 0,
        "x": 340,
        "y": 160,
        "wires": [
            [
                "7cc24544.b8b70c"
            ]
        ]
    },
    {
        "id": "c1338771.c073c8",
        "type": "api-current-state",
        "z": "2c8f60c4.cfd28",
        "name": "Low Traffic",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "20",
        "halt_if_type": "num",
        "halt_if_compare": "lte",
        "entity_id": "sensor.archer_ax50_kib_s_received",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 650,
        "y": 300,
        "wires": [
            [
                "e4ab0d4b.18e32"
            ],
            []
        ]
    },
    {
        "id": "3de22929.0a41c6",
        "type": "api-call-service",
        "z": "2c8f60c4.cfd28",
        "name": "Speedtest",
        "server": "7d575fd3.be153",
        "version": 3,
        "debugenabled": false,
        "service_domain": "speedtestdotnet",
        "service": "speedtest",
        "entityId": "",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": true,
        "outputProperties": [],
        "queue": "none",
        "x": 1000,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "b7d1ff1.6f93",
        "type": "inject",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 500,
        "y": 300,
        "wires": [
            [
                "c1338771.c073c8"
            ]
        ]
    },
    {
        "id": "e4ab0d4b.18e32",
        "type": "change",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 220,
        "wires": [
            [
                "3de22929.0a41c6"
            ]
        ]
    },
    {
        "id": "dfb2a236.1596a",
        "type": "api-current-state",
        "z": "2c8f60c4.cfd28",
        "name": "Dark",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1070,
        "y": 600,
        "wires": [
            [
                "8e5b61bb.7c69a",
                "e7ff89ec.ff32a8"
            ],
            [
                "61c1c44c.1822cc"
            ]
        ]
    },
    {
        "id": "61c1c44c.1822cc",
        "type": "link out",
        "z": "2c8f60c4.cfd28",
        "name": "Before Dark",
        "links": [
            "cc0540e5.20ee3"
        ],
        "x": 1215,
        "y": 660,
        "wires": []
    },
    {
        "id": "cc0540e5.20ee3",
        "type": "link in",
        "z": "2c8f60c4.cfd28",
        "name": "All Off",
        "links": [
            "61c1c44c.1822cc",
            "7edcb02a.bbdd7"
        ],
        "x": 255,
        "y": 420,
        "wires": [
            [
                "bb4c6e2d.562c3"
            ]
        ]
    },
    {
        "id": "bb4c6e2d.562c3",
        "type": "ha-get-entities",
        "z": "2c8f60c4.cfd28",
        "name": "Lights",
        "server": "7d575fd3.be153",
        "version": 0,
        "rules": [
            {
                "property": "entity_id",
                "logic": "starts_with",
                "value": "light.",
                "valueType": "str"
            }
        ],
        "output_type": "split",
        "output_empty_results": false,
        "output_location_type": "msg",
        "output_location": "payload",
        "output_results_count": 1,
        "x": 370,
        "y": 420,
        "wires": [
            [
                "59221ead.cb53c"
            ]
        ]
    },
    {
        "id": "b4fc4d87.b5b53",
        "type": "inject",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "date"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "59221ead.cb53c",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Command",
        "func": "var id = msg.payload.entity_id\n\nmsg.payload = \n{\n    domain : \"light\",\n    service : \"turn_off\",\n    data:\n    {    \n        entity_id: id\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 550,
        "y": 420,
        "wires": [
            [
                "974d70f5.8f5cd"
            ]
        ]
    },
    {
        "id": "974d70f5.8f5cd",
        "type": "api-call-service",
        "z": "2c8f60c4.cfd28",
        "name": "Service",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "",
        "service": "",
        "entityId": "",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 740,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "c4935a16.341358",
        "type": "comment",
        "z": "2c8f60c4.cfd28",
        "name": "All Off",
        "info": "",
        "x": 350,
        "y": 480,
        "wires": []
    },
    {
        "id": "8e5b61bb.7c69a",
        "type": "time-range-switch",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "lat": "-29.81323",
        "lon": "30.84077",
        "startTime": "sunset",
        "endTime": "22:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1280,
        "y": 600,
        "wires": [
            [
                "c6660ddb.e12d"
            ],
            [
                "7edcb02a.bbdd7"
            ]
        ]
    },
    {
        "id": "7edcb02a.bbdd7",
        "type": "link out",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "links": [
            "cc0540e5.20ee3"
        ],
        "x": 1445,
        "y": 640,
        "wires": []
    },
    {
        "id": "61f23dea.af8604",
        "type": "comment",
        "z": "2c8f60c4.cfd28",
        "name": "Loadshedding",
        "info": "",
        "x": 130,
        "y": 360,
        "wires": []
    },
    {
        "id": "4252a0a7.8b0f7",
        "type": "api-call-service",
        "z": "2c8f60c4.cfd28",
        "name": "Bedroom AC",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "climate",
        "service": "turn_on",
        "entityId": "climate.bedroom_ac",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1650,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "99fa4bf4.b5d8d8",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Semaphore ON",
        "func": "flow.set(\"ls\", true);\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "x": 700,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "659e5777.1fd198",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Semaphore Check",
        "func": "var ls =  flow.get(\"ls\");\n\nif(true === ls)\n{\n    flow.set(\"ls\", false);\n    return [msg, null]\n}\n\nreturn [null, msg]\n\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 710,
        "y": 620,
        "wires": [
            [
                "c4bc121a.cdd2e",
                "5453db89.88e4b4"
            ],
            []
        ]
    },
    {
        "id": "c4bc121a.cdd2e",
        "type": "delay",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "pauseType": "delay",
        "timeout": "30",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 920,
        "y": 560,
        "wires": [
            [
                "dfb2a236.1596a"
            ]
        ]
    },
    {
        "id": "78d9c352.fd07bc",
        "type": "server-state-changed",
        "z": "2c8f60c4.cfd28",
        "name": "Booted",
        "server": "7d575fd3.be153",
        "version": 3,
        "entityidfilter": "input_boolean.booted",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "habool",
        "haltifstate": "true",
        "halt_if_type": "bool",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 1010,
        "y": 420,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "c6660ddb.e12d",
        "type": "ha-get-entities",
        "z": "2c8f60c4.cfd28",
        "name": "Lights",
        "server": "7d575fd3.be153",
        "version": 0,
        "rules": [
            {
                "property": "entity_id",
                "logic": "starts_with",
                "value": "light.",
                "valueType": "str"
            }
        ],
        "output_type": "split",
        "output_empty_results": false,
        "output_location_type": "msg",
        "output_location": "payload",
        "output_results_count": 1,
        "x": 1470,
        "y": 540,
        "wires": [
            [
                "79d01230.f750fc"
            ]
        ]
    },
    {
        "id": "79d01230.f750fc",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Command",
        "func": "var id = msg.payload.entity_id\n\nif(msg.payload.entity_id.includes(\"lounge\"))\n    return;\n\nmsg.payload = \n{\n    domain : \"light\",\n    service : \"turn_off\",\n    data:\n    {    \n        entity_id: id\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1650,
        "y": 540,
        "wires": [
            [
                "da3b50cb.3fe67"
            ]
        ]
    },
    {
        "id": "da3b50cb.3fe67",
        "type": "api-call-service",
        "z": "2c8f60c4.cfd28",
        "name": "Service",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "",
        "service": "",
        "entityId": "",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "data"
            }
        ],
        "queue": "none",
        "x": 1840,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "cd1978ff.a45b78",
        "type": "inject",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 340,
        "y": 840,
        "wires": [
            [
                "ba01652f.6715d8"
            ]
        ]
    },
    {
        "id": "f1e852ca.fbc2d",
        "type": "mqtt out",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 687,
        "y": 842,
        "wires": []
    },
    {
        "id": "ba01652f.6715d8",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Netmap",
        "func": "msg.topic = \"zigbee2mqtt/bridge/networkmap\"\nmsg.payload = \"graphviz\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 507,
        "y": 842,
        "wires": [
            [
                "f1e852ca.fbc2d"
            ]
        ]
    },
    {
        "id": "7a436731.338728",
        "type": "mqtt in",
        "z": "2c8f60c4.cfd28",
        "name": "Network map",
        "topic": "zigbee2mqtt/bridge/networkmap/graphviz",
        "qos": "0",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "inputs": 0,
        "x": 350,
        "y": 920,
        "wires": [
            [
                "3ebc16d5.616d2a"
            ]
        ]
    },
    {
        "id": "3ebc16d5.616d2a",
        "type": "debug",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 940,
        "wires": []
    },
    {
        "id": "d27f2891.073388",
        "type": "server-state-changed",
        "z": "2c8f60c4.cfd28",
        "name": "On Battery",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.server_status",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "On Battery",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": false,
        "ignoreCurrentStateUnavailable": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 460,
        "y": 580,
        "wires": [
            [
                "99fa4bf4.b5d8d8"
            ],
            [
                "659e5777.1fd198"
            ]
        ]
    },
    {
        "id": "5453db89.88e4b4",
        "type": "delay",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "pauseType": "delay",
        "timeout": "10",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 920,
        "y": 600,
        "wires": [
            [
                "dfb2a236.1596a"
            ]
        ]
    },
    {
        "id": "e7ff89ec.ff32a8",
        "type": "time-range-switch",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "lat": "-29.81323",
        "lon": "30.84077",
        "startTime": "21:30",
        "endTime": "06:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1270,
        "y": 480,
        "wires": [
            [
                "33305d0e.d4c802"
            ],
            []
        ]
    },
    {
        "id": "33305d0e.d4c802",
        "type": "api-current-state",
        "z": "2c8f60c4.cfd28",
        "name": "<20C",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "21",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.bedroom_climate_temperature",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 1470,
        "y": 440,
        "wires": [
            [
                "4252a0a7.8b0f7"
            ],
            []
        ]
    },
    {
        "id": "4b23b8f0.a26c58",
        "type": "server-state-changed",
        "z": "2c8f60c4.cfd28",
        "name": "Battery Health",
        "server": "7d575fd3.be153",
        "version": 3,
        "exposeToHomeAssistant": false,
        "haConfig": [
            {
                "property": "name",
                "value": ""
            },
            {
                "property": "icon",
                "value": ""
            }
        ],
        "entityidfilter": "sensor.server_battery_charge",
        "entityidfiltertype": "exact",
        "outputinitially": false,
        "state_type": "str",
        "haltifstate": "40",
        "halt_if_type": "num",
        "halt_if_compare": "lt",
        "outputs": 2,
        "output_only_on_state_change": true,
        "for": 0,
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 380,
        "y": 720,
        "wires": [
            [
                "a23032d1.5e926"
            ],
            []
        ]
    },
    {
        "id": "a23032d1.5e926",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Alert",
        "func": "msg.topic = \"UPS\"\nvar content = \"UPS battery getting low\";\nmsg.payload = content;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 550,
        "y": 720,
        "wires": [
            [
                "a8224a9c.8de248"
            ]
        ]
    },
    {
        "id": "a8224a9c.8de248",
        "type": "link out",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "links": [
            "e83933ef.2b28a"
        ],
        "x": 655,
        "y": 720,
        "wires": []
    },
    {
        "id": "b7afc907.294bd8",
        "type": "json",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1648,
        "y": 821,
        "wires": [
            [
                "6c00cc9e.f55374",
                "84fd3c87.4fd8f"
            ]
        ]
    },
    {
        "id": "87700227.d2475",
        "type": "inject",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1358,
        "y": 821,
        "wires": [
            [
                "b9e8a464.3b0178"
            ]
        ]
    },
    {
        "id": "b9e8a464.3b0178",
        "type": "exec",
        "z": "2c8f60c4.cfd28",
        "command": "curl -X POST http://192.168.1.2/cgi-bin/luci/rpc/auth --data '{\"id\": 1,\"method\": \"login\",\"params\": [\"root\", \"secret_password\"]}'",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Auth",
        "x": 1508,
        "y": 821,
        "wires": [
            [
                "b7afc907.294bd8"
            ],
            [],
            []
        ]
    },
    {
        "id": "6c00cc9e.f55374",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "func": "flow.set(\"token\", msg.payload.result);\nmsg.payload = \"curl -X POST http://192.168.1.2/cgi-bin/luci/rpc/uci?auth=\"\nmsg.payload += flow.get(token);\nmsg.payload += \" --data '{\\\"id\\\": \\\"1\\\",\\\"method\\\": \\\"get\\\",\\\"params\\\": [\\\"luci\\\", \\\"sauth\\\", \\\"sessiontime\\\"]}'\"\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1798,
        "y": 821,
        "wires": [
            [
                "1f657942.a00417",
                "ff3b978d.7d74a8"
            ]
        ]
    },
    {
        "id": "1f657942.a00417",
        "type": "exec",
        "z": "2c8f60c4.cfd28",
        "command": "",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Session",
        "x": 1978,
        "y": 821,
        "wires": [
            [
                "7e4ccb55.5fe074"
            ],
            [],
            []
        ]
    },
    {
        "id": "7e4ccb55.5fe074",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "func": "msg.payload = \"curl -X POST http://192.168.1.2/cgi-bin/luci/rpc/sys?auth=\";\nmsg.payload += flow.get(\"token\");\nmsg.payload +=  \"--data '{\\\"id\\\":\\\"1\\\",\\\"method\\\":\\\"exec\\\",\\\"params\\\": [\\\"echo 'hello world'\\\"]}'\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2178,
        "y": 821,
        "wires": [
            [
                "7aefdbb3.246d44"
            ]
        ]
    },
    {
        "id": "7aefdbb3.246d44",
        "type": "exec",
        "z": "2c8f60c4.cfd28",
        "command": "",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Echo",
        "x": 2368,
        "y": 821,
        "wires": [
            [
                "bd78efcf.9c838"
            ],
            [],
            []
        ]
    },
    {
        "id": "bd78efcf.9c838",
        "type": "debug",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2528,
        "y": 821,
        "wires": []
    },
    {
        "id": "84fd3c87.4fd8f",
        "type": "debug",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1828,
        "y": 741,
        "wires": []
    },
    {
        "id": "ff3b978d.7d74a8",
        "type": "debug",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2028,
        "y": 761,
        "wires": []
    },
    {
        "id": "a15472a8e9437f90",
        "type": "function",
        "z": "2c8f60c4.cfd28",
        "name": "Notice",
        "func": "var count = 0\n\nvar message = \"Batteries:\\n\"\n\nfor(i = 0 ; i < msg.payload.length; i++)\n{\n    if(msg.payload[i].state < 90)\n    {\n        message += \"\\n\" + msg.payload[i].attributes.friendly_name;\n        message += \": \" + msg.payload[i].state + \"%\";\n        count++;\n    }\n}\n\nif(count === 0)\n    return null;\n\nmsg.topic = \"boss\"\nmsg.payload = message\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 650,
        "y": 1120,
        "wires": [
            [
                "e1e2b20ff0985cbf"
            ]
        ]
    },
    {
        "id": "e1e2b20ff0985cbf",
        "type": "link out",
        "z": "2c8f60c4.cfd28",
        "name": "",
        "links": [
            "57797689.55f7e8"
        ],
        "x": 755,
        "y": 1120,
        "wires": []
    },
    {
        "id": "81582b29.b2e13",
        "type": "ha-get-entities",
        "z": "2c8f60c4.cfd28",
        "name": "Low Batteries",
        "server": "7d575fd3.be153",
        "version": 0,
        "rules": [
            {
                "property": "attributes.device_class",
                "logic": "is",
                "value": "battery",
                "valueType": "str"
            },
            {
                "property": "attributes.battery",
                "logic": "lt",
                "value": "33",
                "valueType": "num"
            },
            {
                "property": "entity_id",
                "logic": "is_not",
                "value": "sensor.bedroom_opple_battery",
                "valueType": "str"
            }
        ],
        "output_type": "array",
        "output_empty_results": false,
        "output_location_type": "msg",
        "output_location": "payload",
        "output_results_count": 1,
        "x": 501,
        "y": 1120,
        "wires": [
            [
                "a15472a8e9437f90"
            ]
        ]
    },
    {
        "id": "e73142bce38e1741",
        "type": "inject",
        "z": "2c8f60c4.cfd28",
        "name": "10am",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 10 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "batteries",
        "payloadType": "date",
        "x": 330,
        "y": 1120,
        "wires": [
            [
                "81582b29.b2e13"
            ]
        ]
    },
    {
        "id": "a27e91a053b82922",
        "type": "comment",
        "z": "2c8f60c4.cfd28",
        "name": "Low battery alert",
        "info": "",
        "x": 340,
        "y": 1080,
        "wires": []
    },
    {
        "id": "c6877162.564ce",
        "type": "mqtt in",
        "z": "f2e45804.48caf8",
        "name": "Motion",
        "topic": "motion/camera/#",
        "qos": "0",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "inputs": 0,
        "x": 190,
        "y": 360,
        "wires": [
            [
                "56fcb6e8.b743c8"
            ]
        ]
    },
    {
        "id": "270aea55.fd47c6",
        "type": "switch",
        "z": "f2e45804.48caf8",
        "name": "Location",
        "property": "payload.location",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "front",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 500,
        "y": 300,
        "wires": [
            [
                "135b97df.aea318"
            ]
        ]
    },
    {
        "id": "135b97df.aea318",
        "type": "switch",
        "z": "f2e45804.48caf8",
        "name": "",
        "property": "payload.state",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 700,
        "y": 260,
        "wires": [
            [
                "3592a31.589395c"
            ],
            []
        ]
    },
    {
        "id": "a9952ed6.0a207",
        "type": "api-call-service",
        "z": "f2e45804.48caf8",
        "name": "Light On",
        "server": "7d575fd3.be153",
        "version": 3,
        "service_domain": "light",
        "service": "turn_on",
        "entityId": "light.lounge",
        "data": "",
        "dataType": "json",
        "mergecontext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1040,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "962539b7.6d97b8",
        "type": "api-current-state",
        "z": "f2e45804.48caf8",
        "name": "!Home?",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "home",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "device_tracker.philip",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [],
        "x": 500,
        "y": 480,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "56fcb6e8.b743c8",
        "type": "function",
        "z": "f2e45804.48caf8",
        "name": "Parse",
        "func": "var topic = msg.topic.split(\"/\")\nvar state = (msg.payload == \"ON\")\n\nmsg.payload = {}\nmsg.payload.location =  topic[2]\nmsg.payload.state = state\n\nnode.send([msg, null])\n\nvar str = \"Motion \"\nif(state)\n    str += \"detected \"\nelse\n    str += \"ended \"\n    \nstr += \"in the \" + msg.payload.location\n\nmsg.topic = \"motion\"\nmsg.payload = str\n\nreturn [null, msg]",
        "outputs": 2,
        "noerr": 0,
        "x": 330,
        "y": 360,
        "wires": [
            [
                "270aea55.fd47c6"
            ],
            [
                "962539b7.6d97b8"
            ]
        ]
    },
    {
        "id": "3592a31.589395c",
        "type": "api-current-state",
        "z": "f2e45804.48caf8",
        "name": "Dark",
        "server": "7d575fd3.be153",
        "version": 2,
        "outputs": 2,
        "halt_if": "above_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "x": 890,
        "y": 220,
        "wires": [
            [
                "a9952ed6.0a207"
            ],
            []
        ]
    },
    {
        "id": "4cda00a7.9af18",
        "type": "http request",
        "z": "b2e43c1e.1d392",
        "name": "Get stage from Eskom API",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://loadshedding.eskom.co.za/LoadShedding/GetStatus?_=1578576949822",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 320,
        "y": 100,
        "wires": [
            [
                "ba72eeb8.2359a"
            ]
        ]
    },
    {
        "id": "ba72eeb8.2359a",
        "type": "function",
        "z": "b2e43c1e.1d392",
        "name": "Save stage",
        "func": "var response = msg.payload;\nif (isNaN(response)) return null; // abort\n\nvar stage = parseInt(response, 10) - 1; // 1 = \"no loadshedding\", 2 = stage 1, ...\nif (stage < 0 || stage > 8) return null;\nflow.set('stage', stage);\nmsg.payload = stage;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 550,
        "y": 100,
        "wires": [
            [
                "b4c1b58a.cf8278",
                "f9a7cd0e.acd0a"
            ]
        ]
    },
    {
        "id": "b4c1b58a.cf8278",
        "type": "debug",
        "z": "b2e43c1e.1d392",
        "name": "Stage",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 710,
        "y": 40,
        "wires": []
    },
    {
        "id": "f9a7cd0e.acd0a",
        "type": "rbe",
        "z": "b2e43c1e.1d392",
        "name": "Detect change",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 740,
        "y": 160,
        "wires": [
            [
                "5f09d41b165f62bf"
            ]
        ]
    },
    {
        "id": "473332ec7861f9e2",
        "type": "function",
        "z": "b2e43c1e.1d392",
        "name": "Schedule",
        "func": "var schedule = [\n    {\n        \"day\": \"Mon\",\n        \"1\":\"18:00\",\n        \"2\":\"00:00\",\n        \"4\":\"10:00\",\n        \"6\":\"14:00\",\n        \"8\":[\"04:00\", \"22:00\"]\n    },\n    {\n        \"day\":\"Tue\",\n        \"2\":\"20:00\",\n        \"3\":\"04:00\",\n        \"5\":\"12:00\",\n        \"7\":\"16:00\"\n    },\n    {\n        \"day\":\"Wed\",\n        \"1\":\"10:00\",\n        \"4\":[\"00:00\", \"18:00\"],\n        \"6\":\"06:00\",\n    },\n    {\n        \"day\":\"Thu\",\n        \"1\":\"00:00\",\n        \"2\":\"16:00\",\n        \"5\":\"08:00\",\n        \"7\":\"20:00\"\n    },\n    {\n        \"day\":\"Fri\",\n        \"1\":\"14:00\",\n        \"4\":[\"02:00\", \"06:00\"],\n        \"6\":\"16:00\"\n    },\n    {\n        \"day\":\"Sat\",\n        \"1\":\"00:00\",\n        \"2\":\"08:00\",\n        \"5\":\"16:00\",\n        \"7\":[\"04:00\", \"12:00\"]\n    },\n    {\n        \"day\":\"Sun\",\n        \"1\":\"04:00\",\n        \"2\":\"12:00\",\n        \"5\":\"20:00\",\n        \"7\":[\"00:00\", \"08:00\"]\n    },\n    \n    ];\n\nmsg.schedule = schedule;\nlet today = schedule.find(x => x.day === msg.day);\nmsg.payload = today;\n\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 300,
        "wires": [
            [
                "ffcdc33bd59c7bbe"
            ]
        ]
    },
    {
        "id": "8c2d5b6f3f28ed38",
        "type": "inject",
        "z": "b2e43c1e.1d392",
        "name": "trigger",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 340,
        "wires": [
            [
                "5f09d41b165f62bf"
            ]
        ]
    },
    {
        "id": "c857076a62f44e77",
        "type": "debug",
        "z": "b2e43c1e.1d392",
        "name": "Loadshedding",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1740,
        "y": 440,
        "wires": []
    },
    {
        "id": "4e1174c67341a441",
        "type": "moment",
        "z": "b2e43c1e.1d392",
        "name": "Get day",
        "topic": "",
        "input": "",
        "inputType": "msg",
        "inTz": "Africa/Johannesburg",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "ddd",
        "locale": "C",
        "output": "day",
        "outputType": "msg",
        "outTz": "Africa/Johannesburg",
        "x": 480,
        "y": 300,
        "wires": [
            [
                "b33ad92216907eaf"
            ]
        ]
    },
    {
        "id": "5f09d41b165f62bf",
        "type": "change",
        "z": "b2e43c1e.1d392",
        "name": "Get stage",
        "rules": [
            {
                "t": "set",
                "p": "stage",
                "pt": "msg",
                "to": "stage",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 300,
        "wires": [
            [
                "4e1174c67341a441"
            ]
        ]
    },
    {
        "id": "ffcdc33bd59c7bbe",
        "type": "function",
        "z": "b2e43c1e.1d392",
        "name": "Filter",
        "func": "let today = msg.payload;\nvar schedule = [];\ndelete today.day;\n\nDate.prototype.addHours= function(h){\n    var copiedDate = new Date(this.getTime());\n    copiedDate.setHours(copiedDate.getHours()+h);\n    return copiedDate;\n}\n\nfor (const key in today) \n{\n    if (key <= msg.stage)\n    {\n        if(Array.isArray(today[key]))\n        {\n            today[key].forEach(function(time) \n            {\n                schedule.push(time);\n            });\n        }\n        else\n        {\n            schedule.push(today[key]);\n        }\n    }\n        \n}\nschedule.sort();\nmsg.payload = schedule;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 300,
        "wires": [
            [
                "2a4f33494eeaf51e"
            ]
        ]
    },
    {
        "id": "b33ad92216907eaf",
        "type": "function",
        "z": "b2e43c1e.1d392",
        "name": "Test",
        "func": "msg.day = \"Tue\";\nmsg.stage = \"8\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 630,
        "y": 380,
        "wires": [
            [
                "473332ec7861f9e2"
            ]
        ]
    },
    {
        "id": "0f60f98ed28532c4",
        "type": "moment",
        "z": "b2e43c1e.1d392",
        "name": "Format",
        "topic": "",
        "input": "",
        "inputType": "msg",
        "inTz": "Africa/Johannesburg",
        "adjAmount": "0",
        "adjType": "seconds",
        "adjDir": "add",
        "format": "YYYY-MM-DD HH:mm",
        "locale": "C",
        "output": "",
        "outputType": "msg",
        "outTz": "Africa/Johannesburg",
        "x": 1100,
        "y": 300,
        "wires": [
            [
                "874ecb51a605aac0"
            ]
        ]
    },
    {
        "id": "2a4f33494eeaf51e",
        "type": "split",
        "z": "b2e43c1e.1d392",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 950,
        "y": 300,
        "wires": [
            [
                "0f60f98ed28532c4"
            ]
        ]
    },
    {
        "id": "874ecb51a605aac0",
        "type": "join",
        "z": "b2e43c1e.1d392",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": "false",
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "x": 1230,
        "y": 300,
        "wires": [
            [
                "5d67e4a8fd737a7c"
            ]
        ]
    },
    {
        "id": "5d67e4a8fd737a7c",
        "type": "change",
        "z": "b2e43c1e.1d392",
        "name": "Copy",
        "rules": [
            {
                "t": "set",
                "p": "start",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 300,
        "wires": [
            [
                "06615a941b023710"
            ]
        ]
    },
    {
        "id": "06615a941b023710",
        "type": "split",
        "z": "b2e43c1e.1d392",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 950,
        "y": 360,
        "wires": [
            [
                "49f7e0daf0559f3f"
            ]
        ]
    },
    {
        "id": "49f7e0daf0559f3f",
        "type": "moment",
        "z": "b2e43c1e.1d392",
        "name": "+2 Hours",
        "topic": "",
        "input": "",
        "inputType": "msg",
        "inTz": "Africa/Johannesburg",
        "adjAmount": "2",
        "adjType": "hours",
        "adjDir": "add",
        "format": "YYYY-MM-DD HH:mm",
        "locale": "C",
        "output": "",
        "outputType": "msg",
        "outTz": "Africa/Johannesburg",
        "x": 1100,
        "y": 360,
        "wires": [
            [
                "27bb15db58c1c330"
            ]
        ]
    },
    {
        "id": "27bb15db58c1c330",
        "type": "join",
        "z": "b2e43c1e.1d392",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": "false",
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "x": 1230,
        "y": 360,
        "wires": [
            [
                "233d20241ef25c88"
            ]
        ]
    },
    {
        "id": "233d20241ef25c88",
        "type": "change",
        "z": "b2e43c1e.1d392",
        "name": "Copy",
        "rules": [
            {
                "t": "set",
                "p": "end",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 360,
        "wires": [
            [
                "50c66b8f66695ee4"
            ]
        ]
    },
    {
        "id": "50c66b8f66695ee4",
        "type": "function",
        "z": "b2e43c1e.1d392",
        "name": "Join start and end",
        "func": "var schedule = [];\n\nfor(var i = 0; i < msg.start.length; i++)\n{\n    schedule.push(new Array(msg.start[i], msg.end[i]));\n}\n\nmsg.payload = schedule;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1030,
        "y": 420,
        "wires": [
            [
                "08da3355394ae01b"
            ]
        ]
    },
    {
        "id": "08da3355394ae01b",
        "type": "split",
        "z": "b2e43c1e.1d392",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1210,
        "y": 420,
        "wires": [
            [
                "7fc8a00c64aa0231"
            ]
        ]
    },
    {
        "id": "7fc8a00c64aa0231",
        "type": "function",
        "z": "b2e43c1e.1d392",
        "name": "format",
        "func": "msg.__config = {\n    startTime: msg.payload[0],\n    endTime: msg.payload[0],\n    startOffset: 0,\n    endOffset: +120,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1350,
        "y": 420,
        "wires": [
            [
                "1aa104ca304d839a"
            ]
        ]
    },
    {
        "id": "1aa104ca304d839a",
        "type": "time-range-switch",
        "z": "b2e43c1e.1d392",
        "name": "",
        "lat": "",
        "lon": "",
        "startTime": "07:28",
        "endTime": "goldenHour",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1500,
        "y": 520,
        "wires": [
            [
                "c857076a62f44e77"
            ],
            [
                "72a3f84f64afe343"
            ]
        ]
    },
    {
        "id": "72a3f84f64afe343",
        "type": "debug",
        "z": "b2e43c1e.1d392",
        "name": "Not Loadshedding",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1750,
        "y": 560,
        "wires": []
    },
    {
        "id": "5a01cd6c5e3465f1",
        "type": "inject",
        "z": "b2e43c1e.1d392",
        "name": "trigger",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "600",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 100,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "0c0cf925f264beaa",
        "type": "inject",
        "z": "b2e43c1e.1d392",
        "name": "trigger",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 90,
        "y": 60,
        "wires": [
            [
                "4cda00a7.9af18"
            ]
        ]
    },
    {
        "id": "37eeb882c1e0154e",
        "type": "udp out",
        "z": "838c179aeb2a8be9",
        "name": "Discovery",
        "addr": "255.255.255.255",
        "iface": "",
        "port": "10500",
        "ipv": "udp4",
        "outport": "",
        "base64": false,
        "multicast": "broad",
        "x": 280,
        "y": 60,
        "wires": []
    },
    {
        "id": "27d017873077917d",
        "type": "udp in",
        "z": "838c179aeb2a8be9",
        "name": "",
        "iface": "",
        "port": "10500",
        "ipv": "udp4",
        "multicast": "false",
        "group": "",
        "datatype": "buffer",
        "x": 540,
        "y": 60,
        "wires": [
            [
                "a1b5d81c9f9c6e23",
                "80fdb257ea384ca9"
            ]
        ]
    },
    {
        "id": "567cfdab505bb87d",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 90,
        "y": 60,
        "wires": [
            [
                "37eeb882c1e0154e"
            ]
        ]
    },
    {
        "id": "f63353acb5807af5",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "Dummy",
        "func": "msg.payload=\"1,hostname=RB25F-00068E101063,macAddr=00-06-8E-10-10-63,ipAddr=192.168.1.155,netmask=255.255.255.0,gateway=192.168.1.1,dns1=169.1.1.1,dns2=169.1.1.2,ipStatic=0,gwStatic=0,nmStatic=0,productName=ewc,version=1.06,groupName=,deviceType=0,hostPortNo=10002,safeIP=0,termToContPort=10008,hostToContPort=10002,productId=21,productIssue=1.5.1.39,serialNo=IP37190246WO2000481,crc=F768\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 160,
        "wires": [
            [
                "113237e3bde36ced"
            ]
        ]
    },
    {
        "id": "afeb33dd3e690485",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 160,
        "wires": [
            [
                "f63353acb5807af5"
            ]
        ]
    },
    {
        "id": "113237e3bde36ced",
        "type": "string",
        "z": "838c179aeb2a8be9",
        "name": "Format",
        "methods": [
            {
                "name": "replaceAll",
                "params": [
                    {
                        "type": "str",
                        "value": "="
                    },
                    {
                        "type": "str",
                        "value": ":"
                    }
                ]
            },
            {
                "name": "chompLeft",
                "params": [
                    {
                        "type": "str",
                        "value": "1,"
                    }
                ]
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 480,
        "y": 160,
        "wires": [
            [
                "59b38a9750e237e6"
            ]
        ]
    },
    {
        "id": "59b38a9750e237e6",
        "type": "string",
        "z": "838c179aeb2a8be9",
        "name": "split",
        "methods": [
            {
                "name": "split",
                "params": [
                    {
                        "type": "str",
                        "value": ","
                    },
                    {
                        "type": "num",
                        "value": "1000"
                    }
                ]
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 650,
        "y": 160,
        "wires": [
            [
                "e406c482e75c3f29"
            ]
        ]
    },
    {
        "id": "9baf34d75cfa23a6",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1010,
        "y": 160,
        "wires": []
    },
    {
        "id": "e406c482e75c3f29",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "JSON",
        "func": "obj = {};\nvar res;\n\nmsg.payload.forEach(function(item) {\n    res = item.split(\":\");\n    obj[res[0]] = res[1];\n})\nmsg.payload = obj;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 160,
        "wires": [
            [
                "9baf34d75cfa23a6"
            ]
        ]
    },
    {
        "id": "a1b5d81c9f9c6e23",
        "type": "subflow:aacfc38c8117669a",
        "z": "838c179aeb2a8be9",
        "name": "Parse 25B Discovery",
        "x": 770,
        "y": 60,
        "wires": [
            [
                "076e1cf7ac27b9d1"
            ]
        ]
    },
    {
        "id": "57112b84457f0f0e",
        "type": "ssh-client-v2",
        "z": "838c179aeb2a8be9",
        "debug": true,
        "ssh": "",
        "hostname": "192.168.1.155",
        "name": "25B",
        "x": 410,
        "y": 340,
        "wires": [
            [
                "8ea7e42ec7640ef7"
            ]
        ]
    },
    {
        "id": "a7be06b908e5b0c1",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 110,
        "y": 340,
        "wires": [
            [
                "c16f4605f5dfd96d"
            ]
        ]
    },
    {
        "id": "c16f4605f5dfd96d",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "test",
        "func": "msg.payload = \"reboot\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 260,
        "y": 340,
        "wires": [
            [
                "57112b84457f0f0e"
            ]
        ]
    },
    {
        "id": "8ea7e42ec7640ef7",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 340,
        "wires": []
    },
    {
        "id": "fbb4ebf58ee61706",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "",
        "func": "let mac = \"00:06:8e:10:10:63\";\n\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nmsg.payload=\"{ \\\n  \\\"correlationId\\\":\\\"b448b1c3-d2aa-4773-a0c0-cf3c3f8e64cc\\\", \\\n  \\\"replyTo\\\":\\\"m2m/\"+mac+\"/response\\\", \\\n  \\\"command\\\": \\\"configuration/lookup\\\", \\\n  \\\"version\\\": { \\\n    \\\"major\\\": 0, \\\n    \\\"minor\\\": 1 \\\n  }, \\\n  \\\"key\\\": { \\\n    \\\"name\\\": \\\"READER_MODE_AUTHENTICATION\\\" \\\n  } \\\n}\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 440,
        "wires": [
            [
                "477e2de1c85a1c4d"
            ]
        ]
    },
    {
        "id": "477e2de1c85a1c4d",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 510,
        "y": 440,
        "wires": []
    },
    {
        "id": "988adca9579b5155",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 120,
        "y": 440,
        "wires": [
            [
                "fbb4ebf58ee61706"
            ]
        ]
    },
    {
        "id": "6fadba26b70a49a7",
        "type": "mqtt in",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "m2m/00:06:8e:10:10:63/response",
        "qos": "2",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 170,
        "y": 720,
        "wires": [
            [
                "9d878cb2390775b7"
            ]
        ]
    },
    {
        "id": "138f05041b5bba01",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 680,
        "wires": []
    },
    {
        "id": "9d878cb2390775b7",
        "type": "json",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 370,
        "y": 720,
        "wires": [
            [
                "7447c6d4ec8df5f6",
                "868557a4d4dbf185"
            ]
        ]
    },
    {
        "id": "7447c6d4ec8df5f6",
        "type": "switch",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload.attributes.value",
        "propertyType": "msg",
        "rules": [
            {
                "t": "hask",
                "v": "modeName",
                "vt": "str"
            },
            {
                "t": "hask",
                "v": "systemModeName",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 510,
        "y": 720,
        "wires": [
            [
                "138f05041b5bba01"
            ],
            [
                "eba1b6791b64e04f"
            ]
        ]
    },
    {
        "id": "eba1b6791b64e04f",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 760,
        "wires": []
    },
    {
        "id": "0770dad77990ae44",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "",
        "func": "let mac = \"00:06:8e:10:10:63\";\n\nmsg.topic=\"m2m/\"+mac+\"/request\";\n\nmsg.payload=\"{ \\\n  \\\"correlationId\\\":\\\"b448b1c3-d2aa-4773-a0c0-cf3c3f8e64cc\\\", \\\n  \\\"replyTo\\\":\\\"m2m/\"+mac+\"/response\\\", \\\n  \\\"command\\\": \\\"configuration/lookup\\\", \\\n  \\\"version\\\": { \\\n    \\\"major\\\": 0, \\\n    \\\"minor\\\": 1 \\\n  }, \\\n  \\\"key\\\": { \\\n    \\\"name\\\": \\\"READER_MODE_AUTHENTICATION\\\" \\\n  } \\\n}\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 520,
        "wires": [
            [
                "f3e1c0856c25433d"
            ]
        ]
    },
    {
        "id": "f3e1c0856c25433d",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 500,
        "y": 520,
        "wires": []
    },
    {
        "id": "e03b6e57224a16b6",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 110,
        "y": 520,
        "wires": [
            [
                "0770dad77990ae44"
            ]
        ]
    },
    {
        "id": "fd816f445ab37312",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 750,
        "y": 1100,
        "wires": []
    },
    {
        "id": "abeffcfda6e6eac0",
        "type": "subflow:e5bb55137891a2c8",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "key",
                "value": "READER_MODE_AUTHENTICATION",
                "type": "str"
            }
        ],
        "x": 580,
        "y": 1620,
        "wires": [
            [
                "03e52896ba165961",
                "2aa6f182e7417083"
            ]
        ],
        "info": "# Preps a configuration/lookup message\n\n## Input\n\n### key\n\nOne of the following\n\n - mqtt\n - SYSTEM_CONFIGURATION\n - READER_MODE_AUTHENTICATION\n - FINGERPRINT_SENSOR\n - READER_SETTINGS\n - GLOBAL_M2M_TOPIC\n - SERVICES\n - LOCKDOWN\n - HOSTCONTROL\n - properties\n - version\n\n## mac\n\nThe mac address of the unit as a string"
    },
    {
        "id": "738612d80dd0b523",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "lookup",
        "func": "msg.payload = {}\nmsg.payload.mac=\"00:06:8e:10:10:63\";\nmsg.payload.key = \"READER_MODE_AUTHENTICATION\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 1620,
        "wires": [
            [
                "abeffcfda6e6eac0"
            ]
        ]
    },
    {
        "id": "a434072227f0f489",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 1620,
        "wires": [
            [
                "738612d80dd0b523"
            ]
        ]
    },
    {
        "id": "03e52896ba165961",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 780,
        "y": 1620,
        "wires": []
    },
    {
        "id": "35df0e6e26b22654",
        "type": "subflow:ef28203219c5f3e6",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "key",
                "value": "mqtt",
                "type": "str"
            },
            {
                "name": "value",
                "value": "{\"modeName\":[\"ONE_TO_ONE_TEMPLATE_ON_CARD\"]}",
                "type": "json"
            }
        ],
        "x": 490,
        "y": 920,
        "wires": [
            [
                "18ea8357890b6b52"
            ]
        ]
    },
    {
        "id": "3f42fdeb9da1270c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 980,
        "wires": [
            [
                "c1f8de55827b8039",
                "35df0e6e26b22654"
            ]
        ]
    },
    {
        "id": "18ea8357890b6b52",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 920,
        "wires": []
    },
    {
        "id": "c1f8de55827b8039",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "lookup",
        "func": "var payload = {}\n\npayload.mac=\"00:06:8e:10:10:63\";\npayload.key = \"READER_MODE_AUTHENTICATION\";\npayload.value = {modeName:[\"ONE_TO_ONE_TEMPLATE_ON_DEVICE\"]};\n\nmsg.payload = payload;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 920,
        "wires": [
            [
                "35df0e6e26b22654"
            ]
        ]
    },
    {
        "id": "09020f2878fa6df2",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 1100,
        "wires": [
            [
                "f747da34992b6d9a"
            ]
        ]
    },
    {
        "id": "f747da34992b6d9a",
        "type": "subflow:ada279a395cd9594",
        "z": "838c179aeb2a8be9",
        "name": "Finger Only",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "mode",
                "value": "ONE_TO_N",
                "type": "str"
            },
            {
                "name": "Mode",
                "value": "ONE_TO_N",
                "type": "str"
            }
        ],
        "x": 460,
        "y": 1100,
        "wires": [
            [
                "fd816f445ab37312"
            ]
        ]
    },
    {
        "id": "083875e9cc59a265",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 260,
        "y": 1220,
        "wires": [
            [
                "9b49f19c1e181ab5"
            ]
        ]
    },
    {
        "id": "d7da13bdb3c39dd2",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 670,
        "y": 1220,
        "wires": []
    },
    {
        "id": "619146fe832b9313",
        "type": "subflow:27041614d0046a67",
        "z": "838c179aeb2a8be9",
        "name": "Cap R Index",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "id",
                "value": "3",
                "type": "num"
            },
            {
                "name": "finger",
                "value": "RIGHT_INDEX_FINGER",
                "type": "str"
            }
        ],
        "x": 1230,
        "y": 780,
        "wires": [
            [
                "72a8847f352ed588"
            ]
        ]
    },
    {
        "id": "9b49f19c1e181ab5",
        "type": "subflow:52270a6ff896cf61",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "database",
                "value": "PACS",
                "type": "str"
            }
        ],
        "x": 470,
        "y": 1220,
        "wires": [
            [
                "d7da13bdb3c39dd2"
            ]
        ]
    },
    {
        "id": "9895c3892f3ba2a1",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1060,
        "y": 780,
        "wires": [
            [
                "619146fe832b9313"
            ]
        ]
    },
    {
        "id": "72a8847f352ed588",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1390,
        "y": 780,
        "wires": []
    },
    {
        "id": "868557a4d4dbf185",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 620,
        "wires": []
    },
    {
        "id": "f45452ee19d22b09",
        "type": "subflow:3dbcea1231ae029d",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            }
        ],
        "x": 420,
        "y": 1700,
        "wires": [
            [
                "36aa7ec5669ff809"
            ]
        ]
    },
    {
        "id": "dc5e1fac57962e42",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 1700,
        "wires": [
            [
                "f45452ee19d22b09"
            ]
        ]
    },
    {
        "id": "36aa7ec5669ff809",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 600,
        "y": 1700,
        "wires": []
    },
    {
        "id": "bfbf2dfa0cbbea32",
        "type": "mqtt in",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "m2m/00:06:8e:10:10:63/response/uploader",
        "qos": "2",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 320,
        "y": 1460,
        "wires": [
            [
                "3fd0e25fb3583f9a"
            ]
        ]
    },
    {
        "id": "3fd0e25fb3583f9a",
        "type": "json",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 550,
        "y": 1440,
        "wires": [
            [
                "df36037e527aa8f6",
                "79656abfec0393f8"
            ]
        ]
    },
    {
        "id": "df36037e527aa8f6",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "focus",
        "func": "if (!msg.payload.hasOwnProperty('attributes'))\n{\n    return [null, msg];\n}\n\nids = [];\n\nmsg.payload.attributes.events.forEach(element => {\n  ids.push(element.id);\n});\n\nmsg.payload = {ids:ids}\n\nreturn [msg, null];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 1460,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "05cad0dbb1b63013",
        "type": "subflow:eae3302d5c488f43",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            }
        ],
        "x": 890,
        "y": 1460,
        "wires": [
            [
                "ff62c654e4496405"
            ]
        ]
    },
    {
        "id": "ff62c654e4496405",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1050,
        "y": 1460,
        "wires": []
    },
    {
        "id": "ecdee12cb2d8ad43",
        "type": "subflow:a7b7c383c56a3f2d",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            }
        ],
        "x": 430,
        "y": 1800,
        "wires": [
            [
                "90bf92a81fb4eb52"
            ]
        ]
    },
    {
        "id": "eb874f75194bf310",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 1800,
        "wires": [
            [
                "ecdee12cb2d8ad43"
            ]
        ]
    },
    {
        "id": "90bf92a81fb4eb52",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 610,
        "y": 1800,
        "wires": []
    },
    {
        "id": "79656abfec0393f8",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 1380,
        "wires": []
    },
    {
        "id": "2aa6f182e7417083",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 790,
        "y": 1540,
        "wires": []
    },
    {
        "id": "31e3f7d97ef56b5a",
        "type": "mqtt in",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "m2m/00:06:8e:10:10:63/response/template",
        "qos": "2",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1140,
        "y": 840,
        "wires": [
            []
        ]
    },
    {
        "id": "e1c805f5855c5bf1",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1710,
        "y": 860,
        "wires": []
    },
    {
        "id": "28467b708402fb00",
        "type": "mqtt in",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "m2m/00:06:8e:10:10:63/event",
        "qos": "2",
        "datatype": "auto",
        "broker": "2eafe4c0.b7da5c",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1040,
        "y": 560,
        "wires": [
            [
                "58c8037a0321b80f"
            ]
        ]
    },
    {
        "id": "58c8037a0321b80f",
        "type": "json",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1250,
        "y": 560,
        "wires": [
            [
                "ed35affc9575a88d"
            ]
        ]
    },
    {
        "id": "bf41a6409d4525d7",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1730,
        "y": 460,
        "wires": []
    },
    {
        "id": "fe3ff0d5eace2832",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 500,
        "wires": []
    },
    {
        "id": "ed35affc9575a88d",
        "type": "switch",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload.subSystem",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "sensor",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "connection",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "firmware_update",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "capture_image",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "IDENTIFICATION",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 1410,
        "y": 560,
        "wires": [
            [
                "f303171fe43aa66e"
            ],
            [
                "fe3ff0d5eace2832"
            ],
            [
                "ed1cf26613a2472b"
            ],
            [
                "9346462ae8736237"
            ],
            [
                "14256d0cd3277cc6"
            ],
            [
                "abff91d7fbdb8de5"
            ]
        ]
    },
    {
        "id": "abff91d7fbdb8de5",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 660,
        "wires": []
    },
    {
        "id": "f303171fe43aa66e",
        "type": "switch",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload.event.sensor",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "liftFinger",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "captured",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "capturing",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 1570,
        "y": 440,
        "wires": [
            [],
            [],
            [],
            [
                "bf41a6409d4525d7"
            ]
        ]
    },
    {
        "id": "ed1cf26613a2472b",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 540,
        "wires": []
    },
    {
        "id": "9346462ae8736237",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 580,
        "wires": []
    },
    {
        "id": "4739019bb3c6bb0f",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "{ \"id\":1, \"mac\":\"00-00\"}",
        "childpath": "templates",
        "propertyType": "str",
        "method": "get",
        "newchildpath": "",
        "x": 1210,
        "y": 1060,
        "wires": [
            [
                "cde791d7ee9cf862"
            ]
        ]
    },
    {
        "id": "ed95f2eaa0141a9c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1000,
        "y": 1060,
        "wires": [
            [
                "4739019bb3c6bb0f"
            ]
        ]
    },
    {
        "id": "99bd77c143fd2c67",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "format db",
        "func": "\nlet host = msg.payload.hostname;\nmsg.childpath = \"devices/\" + host;\ndelete msg.payload.crc;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1180,
        "y": 100,
        "wires": [
            [
                "024df2a3c69b97a2"
            ]
        ]
    },
    {
        "id": "076e1cf7ac27b9d1",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1190,
        "y": 60,
        "wires": []
    },
    {
        "id": "024df2a3c69b97a2",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "",
        "childpath": "childpath",
        "propertyType": "msg",
        "method": "set",
        "newchildpath": "",
        "x": 1370,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "80fdb257ea384ca9",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 100,
        "wires": []
    },
    {
        "id": "712d2e5edcd7a07c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "Dummy",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[49,44,104,111,115,116,110,97,109,101,61,82,66,50,53,70,45,48,48,48,54,56,69,49,48,49,48,54,51,44,109,97,99,65,100,100,114,61,48,48,45,48,54,45,56,69,45,49,48,45,49,48,45,54,51,44,105,112,65,100,100,114,61,49,57,50,46,49,54,56,46,49,46,49,53,53,44,110,101,116,109,97,115,107,61,50,53,53,46,50,53,53,46,50,53,53,46,48,44,103,97,116,101,119,97,121,61,49,57,50,46,49,54,56,46,49,46,49,44,100,110,115,49,61,49,54,57,46,49,46,49,46,49,44,100,110,115,50,61,49,54,57,46,49,46,49,46,50,44,105,112,83,116,97,116,105,99,61,48,44,103,119,83,116,97,116,105,99,61,48,44,110,109,83,116,97,116,105,99,61,48,44,112,114,111,100,117,99,116,78,97,109,101,61,101,119,99,44,118,101,114,115,105,111,110,61,49,46,48,54,44,103,114,111,117,112,78,97,109,101,61,44,100,101,118,105,99,101,84,121,112,101,61,48,44,104,111,115,116,80,111,114,116,78,111,61,49,48,48,48,50,44,115,97,102,101,73,80,61,48,44,116,101,114,109,84,111,67,111,110,116,80,111,114,116,61,49,48,48,48,56,44,104,111,115,116,84,111,67,111,110,116,80,111,114,116,61,49,48,48,48,50,44,112,114,111,100,117,99,116,73,100,61,50,49,44,112,114,111,100,117,99,116,73,115,115,117,101,61,49,46,53,46,49,46,51,57,44,115,101,114,105,97,108,78,111,61,73,80,51,55,49,57,48,50,52,54,87,79,50,48,48,48,52,56,49,44,99,114,99,61,70,55,54,56,13]",
        "payloadType": "bin",
        "x": 550,
        "y": 100,
        "wires": [
            [
                "a1b5d81c9f9c6e23"
            ]
        ]
    },
    {
        "id": "53ed3a2a4ea2157d",
        "type": "json",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1410,
        "y": 840,
        "wires": [
            [
                "c2e4d1de542cc825"
            ]
        ]
    },
    {
        "id": "c2e4d1de542cc825",
        "type": "switch",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload.attributes",
        "propertyType": "msg",
        "rules": [
            {
                "t": "hask",
                "v": "template",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1550,
        "y": 840,
        "wires": [
            [
                "08de5bca6e8ddfe3"
            ],
            [
                "e1c805f5855c5bf1"
            ]
        ]
    },
    {
        "id": "1012a9feb183f551",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "",
        "childpath": "childpath",
        "propertyType": "msg",
        "method": "push",
        "newchildpath": "",
        "x": 1850,
        "y": 800,
        "wires": [
            [
                "38ed689c1b302087"
            ]
        ]
    },
    {
        "id": "08de5bca6e8ddfe3",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "format db",
        "func": "\nlet finger = global.get(\"capture_finger\");\nlet id = global.get(\"capture_id\");\nlet template = msg.payload.attributes.template;\n\nmsg.childpath = \"templates\";\nmsg.payload = {};\nmsg.payload.finger = finger;\nmsg.payload.id = id;\nmsg.payload.template = template;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1700,
        "y": 800,
        "wires": [
            [
                "1012a9feb183f551"
            ]
        ]
    },
    {
        "id": "38ed689c1b302087",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2030,
        "y": 800,
        "wires": []
    },
    {
        "id": "9f955349b463738f",
        "type": "subflow:27041614d0046a67",
        "z": "838c179aeb2a8be9",
        "name": "Cap R Thumb",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "id",
                "value": "4",
                "type": "num"
            },
            {
                "name": "finger",
                "value": "RIGHT_THUMB",
                "type": "str"
            }
        ],
        "x": 1240,
        "y": 740,
        "wires": [
            [
                "a6c3b49d9eb84338"
            ]
        ]
    },
    {
        "id": "d7d5d783c7e5bd1c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1060,
        "y": 740,
        "wires": [
            [
                "9f955349b463738f"
            ]
        ]
    },
    {
        "id": "a6c3b49d9eb84338",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1390,
        "y": 740,
        "wires": []
    },
    {
        "id": "5151b601128c525f",
        "type": "subflow:4cb55b245fd49718",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            }
        ],
        "x": 1560,
        "y": 1060,
        "wires": [
            [],
            [
                "5a094240176c809c"
            ]
        ]
    },
    {
        "id": "cde791d7ee9cf862",
        "type": "split",
        "z": "838c179aeb2a8be9",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1370,
        "y": 1060,
        "wires": [
            [
                "5151b601128c525f"
            ]
        ]
    },
    {
        "id": "74de64a13a03877c",
        "type": "subflow:ada279a395cd9594",
        "z": "838c179aeb2a8be9",
        "name": "Card Only",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "mode",
                "value": "CARD_ONLY",
                "type": "str"
            },
            {
                "name": "Mode",
                "value": "ONE_TO_N",
                "type": "str"
            }
        ],
        "x": 440,
        "y": 1160,
        "wires": [
            [
                "8b23312eca0fda51"
            ]
        ]
    },
    {
        "id": "d400fbc64e8a236c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 230,
        "y": 1160,
        "wires": [
            [
                "74de64a13a03877c"
            ]
        ]
    },
    {
        "id": "8b23312eca0fda51",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 740,
        "y": 1160,
        "wires": []
    },
    {
        "id": "d294ff4a8a533237",
        "type": "subflow:5fd2a5bb3c38e382",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            }
        ],
        "x": 1490,
        "y": 1440,
        "wires": [
            [
                "db06e6308f92bce7"
            ]
        ]
    },
    {
        "id": "c61b99ea52d5045b",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1300,
        "y": 1440,
        "wires": [
            [
                "d294ff4a8a533237"
            ]
        ]
    },
    {
        "id": "db06e6308f92bce7",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1670,
        "y": 1440,
        "wires": []
    },
    {
        "id": "3094a32f797a5756",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "{ \"id\":1, \"mac\":\"00-00\"}",
        "childpath": "templates",
        "propertyType": "str",
        "method": "get",
        "newchildpath": "",
        "x": 1210,
        "y": 1220,
        "wires": [
            [
                "aad25e8a25f6ec90"
            ]
        ]
    },
    {
        "id": "aa89552e67f74001",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1040,
        "y": 1220,
        "wires": [
            [
                "3094a32f797a5756"
            ]
        ]
    },
    {
        "id": "3f7aa6bbefe42d79",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1510,
        "y": 1220,
        "wires": []
    },
    {
        "id": "aad25e8a25f6ec90",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "collect Ids",
        "func": "ids = [];\n\nmsg.payload.forEach(element => {\n  ids.push(element.id);\n});\n\nmsg.payload = {ids:ids}\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1380,
        "y": 1220,
        "wires": [
            [
                "3f7aa6bbefe42d79"
            ]
        ]
    },
    {
        "id": "fff495d2b15bc336",
        "type": "subflow:fbc8c94e94125ace",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "name",
                "value": "Janice",
                "type": "str"
            },
            {
                "name": "surname",
                "value": "Sewlall",
                "type": "str"
            },
            {
                "name": "id",
                "value": "3",
                "type": "num"
            },
            {
                "name": "Name",
                "value": "Philip",
                "type": "str"
            },
            {
                "name": "Surname",
                "value": "Barlow",
                "type": "str"
            }
        ],
        "x": 1470,
        "y": 1560,
        "wires": [
            [
                "ead6027fb56a3c54"
            ]
        ]
    },
    {
        "id": "ead6027fb56a3c54",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "",
        "childpath": "users",
        "propertyType": "str",
        "method": "push",
        "newchildpath": "",
        "x": 1630,
        "y": 1560,
        "wires": [
            []
        ]
    },
    {
        "id": "69e779ed23910f12",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "{ \"id\":1, \"mac\":\"00-00\"}",
        "childpath": "users",
        "propertyType": "str",
        "method": "get",
        "newchildpath": "",
        "x": 1190,
        "y": 1560,
        "wires": [
            [
                "5e5a8959df7a6aa6"
            ]
        ]
    },
    {
        "id": "42b60bd8239c2469",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1040,
        "y": 1560,
        "wires": [
            [
                "69e779ed23910f12"
            ]
        ]
    },
    {
        "id": "5e5a8959df7a6aa6",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "next id",
        "func": "ids = [];\n\nObject.keys(msg.payload).forEach(function(key) {\n    \n  ids.push(msg.payload[key].id);\n\n});\n\nlet next = Math.max(...ids) + 1;\n\nmsg.payload = {id:next};\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1330,
        "y": 1560,
        "wires": [
            [
                "fff495d2b15bc336"
            ]
        ]
    },
    {
        "id": "9314d34e0ac91bc6",
        "type": "subflow:2dc484a32dc07a73",
        "z": "838c179aeb2a8be9",
        "name": "",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            }
        ],
        "x": 1430,
        "y": 1820,
        "wires": [
            [
                "a4fe4d76bb790ecc"
            ],
            [
                "4af484d5ba3b6b2d"
            ]
        ]
    },
    {
        "id": "5eb547a8a3f6c800",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "{ \"id\":1, \"mac\":\"00-00\"}",
        "childpath": "users",
        "propertyType": "str",
        "method": "get",
        "newchildpath": "",
        "x": 1110,
        "y": 1820,
        "wires": [
            [
                "d16976cc4ce6cb7b"
            ]
        ]
    },
    {
        "id": "9e544ce03c272c18",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 960,
        "y": 1820,
        "wires": [
            [
                "5eb547a8a3f6c800"
            ]
        ]
    },
    {
        "id": "d16976cc4ce6cb7b",
        "type": "split",
        "z": "838c179aeb2a8be9",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1270,
        "y": 1820,
        "wires": [
            [
                "9314d34e0ac91bc6"
            ]
        ]
    },
    {
        "id": "1968e6dbd47f76e0",
        "type": "comment",
        "z": "838c179aeb2a8be9",
        "name": "Sync Users",
        "info": "",
        "x": 990,
        "y": 1880,
        "wires": []
    },
    {
        "id": "a4fe4d76bb790ecc",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1590,
        "y": 1800,
        "wires": []
    },
    {
        "id": "61f66ce5839a10f3",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1730,
        "y": 1880,
        "wires": []
    },
    {
        "id": "4af484d5ba3b6b2d",
        "type": "delay",
        "z": "838c179aeb2a8be9",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1600,
        "y": 1880,
        "wires": [
            [
                "61f66ce5839a10f3"
            ]
        ]
    },
    {
        "id": "5a094240176c809c",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1750,
        "y": 1080,
        "wires": []
    },
    {
        "id": "6fd588d66d7ddf46",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "{ \"id\":1, \"mac\":\"00-00\"}",
        "childpath": "users",
        "propertyType": "str",
        "method": "get",
        "newchildpath": "",
        "x": 1790,
        "y": 620,
        "wires": [
            [
                "a480d60c364c7fbb"
            ]
        ]
    },
    {
        "id": "14256d0cd3277cc6",
        "type": "change",
        "z": "838c179aeb2a8be9",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ident",
                "pt": "msg",
                "to": "payload.event",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1610,
        "y": 620,
        "wires": [
            [
                "6fd588d66d7ddf46"
            ]
        ]
    },
    {
        "id": "a480d60c364c7fbb",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "check users",
        "func": "let match = Number(msg.ident.userId);\nvar user = {};\nlet found = false;\n\nObject.keys(msg.payload).forEach(function(key) {\n    \n  if(msg.payload[key].id == match)\n  {\n      user = msg.payload[key];\n      found = true;\n  }\n});\n\nif(found)\n{\n    msg.payload = user;\n}\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1970,
        "y": 620,
        "wires": [
            [
                "25c23db4eed042d9"
            ]
        ]
    },
    {
        "id": "25c23db4eed042d9",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2150,
        "y": 620,
        "wires": []
    },
    {
        "id": "30c5db54962abef5",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 500,
        "y": 2020,
        "wires": [
            [
                "c1b3b4be308da32a"
            ]
        ]
    },
    {
        "id": "c1b3b4be308da32a",
        "type": "subflow:4d21ef95f85fa8fe",
        "z": "838c179aeb2a8be9",
        "name": "Schedule",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "start date",
                "value": "",
                "type": "str"
            },
            {
                "name": "end date",
                "value": "",
                "type": "str"
            }
        ],
        "x": 660,
        "y": 2020,
        "wires": [
            [
                "6c706a4714bce86b"
            ]
        ]
    },
    {
        "id": "6c706a4714bce86b",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 830,
        "y": 2020,
        "wires": []
    },
    {
        "id": "1d62db1f3a8a26d2",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 320,
        "y": 2180,
        "wires": [
            [
                "968e1826ee322b91"
            ]
        ]
    },
    {
        "id": "6a7960e08181fa86",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "",
        "childpath": "childpath",
        "propertyType": "msg",
        "method": "update",
        "newchildpath": "",
        "x": 1210,
        "y": 2580,
        "wires": [
            []
        ]
    },
    {
        "id": "b2189c30b3bab567",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 520,
        "y": 2580,
        "wires": [
            [
                "6e02a1c128e2a2d1"
            ]
        ]
    },
    {
        "id": "5184757121528203",
        "type": "addFirebase",
        "z": "838c179aeb2a8be9",
        "firebaseCertificate": "9f763d6f05105379",
        "client_email": "",
        "private_key": "",
        "data": "{ \"name\":\"bob\"}",
        "childpath": "childpath",
        "propertyType": "msg",
        "method": "get",
        "newchildpath": "",
        "x": 830,
        "y": 2580,
        "wires": [
            [
                "a70f033353d53ef5"
            ]
        ]
    },
    {
        "id": "a70f033353d53ef5",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "check users",
        "func": "let found = false;\nObject.keys(msg.payload).forEach(function(key) {\n    \n  if(msg.payload[key].id == msg.target.id)\n  {\n      msg.childpath = msg.childpath +\"/\" + key;\n      msg.payload = msg.payload[key];\n      msg.payload.patch = msg.patch_data;\n      found = true;\n      \n  }\n});\n\nif(found)\n    return [msg, null];\n\nreturn [null, msg];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 2580,
        "wires": [
            [
                "6a7960e08181fa86"
            ],
            []
        ]
    },
    {
        "id": "30b28a90992ec2b8",
        "type": "comment",
        "z": "838c179aeb2a8be9",
        "name": "Modify Record Example",
        "info": "",
        "x": 660,
        "y": 2540,
        "wires": []
    },
    {
        "id": "6e02a1c128e2a2d1",
        "type": "function",
        "z": "838c179aeb2a8be9",
        "name": "setup",
        "func": "msg.childpath = \"tests/test2\"\nmsg.target = \n{\n    id:4,\n}\nmsg.patch_data = \"patchData\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 2580,
        "wires": [
            [
                "5184757121528203"
            ]
        ]
    },
    {
        "id": "0734f0418708fc25",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"device\":\"RB25F-00068E101063\"}",
        "payloadType": "json",
        "x": 1050,
        "y": 2920,
        "wires": [
            [
                "34298ae276200b95"
            ]
        ]
    },
    {
        "id": "34298ae276200b95",
        "type": "subflow:38e6f5c55d11c778",
        "z": "838c179aeb2a8be9",
        "name": "",
        "x": 1220,
        "y": 2920,
        "wires": [
            [
                "b93cbd23e49ce345"
            ],
            [
                "b93cbd23e49ce345"
            ]
        ]
    },
    {
        "id": "b93cbd23e49ce345",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1430,
        "y": 2920,
        "wires": []
    },
    {
        "id": "968e1826ee322b91",
        "type": "subflow:9839085e54c4764c",
        "z": "838c179aeb2a8be9",
        "name": "",
        "x": 480,
        "y": 2180,
        "wires": [
            [
                "0b9b0b34a2e40684"
            ],
            [
                "c08a5d21a2bccfb4"
            ]
        ]
    },
    {
        "id": "0b9b0b34a2e40684",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 2160,
        "wires": []
    },
    {
        "id": "c08a5d21a2bccfb4",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 2200,
        "wires": []
    },
    {
        "id": "4523d09081271291",
        "type": "subflow:01e46596931945f1",
        "z": "838c179aeb2a8be9",
        "name": "",
        "x": 1270,
        "y": 2300,
        "wires": [
            [
                "d9b4d3e93aedb2d0"
            ]
        ]
    },
    {
        "id": "582ab541a914963c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1120,
        "y": 2300,
        "wires": [
            [
                "4523d09081271291"
            ]
        ]
    },
    {
        "id": "8d6b84c7c774f1d0",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "open",
        "props": [
            {
                "p": "payload",
                "v": "OPEN",
                "vt": "str"
            },
            {
                "p": "topic",
                "v": "control",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "OPEN",
        "payloadType": "str",
        "x": 630,
        "y": 2980,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "913c2d02667ae97d",
        "type": "q-gate",
        "z": "838c179aeb2a8be9",
        "name": "q-gate demo",
        "controlTopic": "control",
        "defaultState": "open",
        "openCmd": "open",
        "closeCmd": "close",
        "toggleCmd": "toggle",
        "queueCmd": "queue",
        "defaultCmd": "default",
        "triggerCmd": "trigger",
        "flushCmd": "flush",
        "resetCmd": "reset",
        "peekCmd": "peek",
        "dropCmd": "drop",
        "statusCmd": "status",
        "maxQueueLength": "0",
        "keepNewest": false,
        "qToggle": false,
        "persist": false,
        "x": 870,
        "y": 3200,
        "wires": [
            [
                "4698fa7ce782c6b5"
            ]
        ]
    },
    {
        "id": "b86dea43d4a93b55",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "input",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "date"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 590,
        "y": 3200,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "97581c569781f5cc",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "toggle",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "toggle",
        "payloadType": "str",
        "x": 630,
        "y": 3060,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "163818cd1493bca7",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "close",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "close",
        "payloadType": "str",
        "x": 630,
        "y": 3020,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "b8a55ec9c5c1ddd9",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "default",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "default",
        "payloadType": "str",
        "x": 630,
        "y": 3100,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "0b65da14b5cf252b",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "queue",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "queue",
        "payloadType": "str",
        "x": 630,
        "y": 3260,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "827bf8901a3ba10d",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "flush",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "flush",
        "payloadType": "str",
        "x": 630,
        "y": 3340,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "9bef5f414f7b7ce3",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "trigger",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "trigger",
        "payloadType": "str",
        "x": 630,
        "y": 3300,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "7f6fc69efa078d1e",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "reset",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "reset",
        "payloadType": "str",
        "x": 630,
        "y": 3380,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "67e52fe392bbd72c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "peek",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "peek",
        "payloadType": "str",
        "x": 630,
        "y": 3420,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "9a1fa4bcee7f677b",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "drop",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "drop",
        "payloadType": "str",
        "x": 630,
        "y": 3460,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "5522e34031d7992f",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "status",
        "props": [
            {
                "p": "payload",
                "v": "status",
                "vt": "str"
            },
            {
                "p": "topic",
                "v": "control",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "control",
        "payload": "status",
        "payloadType": "str",
        "x": 630,
        "y": 3140,
        "wires": [
            [
                "913c2d02667ae97d"
            ]
        ]
    },
    {
        "id": "4698fa7ce782c6b5",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "output",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 3200,
        "wires": []
    },
    {
        "id": "d9b4d3e93aedb2d0",
        "type": "mqtt out",
        "z": "838c179aeb2a8be9",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2eafe4c0.b7da5c",
        "x": 1410,
        "y": 2300,
        "wires": []
    },
    {
        "id": "f0d0fe83d5e84b44",
        "type": "subflow:ada279a395cd9594",
        "z": "838c179aeb2a8be9",
        "name": "Finger Only",
        "env": [
            {
                "name": "mac",
                "value": "00:06:8e:10:10:63",
                "type": "str"
            },
            {
                "name": "mode",
                "value": "ONE_TO_N",
                "type": "str"
            },
            {
                "name": "Mode",
                "value": "ONE_TO_N",
                "type": "str"
            }
        ],
        "x": 550,
        "y": 1040,
        "wires": [
            [
                "f0a1eb69b369a462"
            ]
        ]
    },
    {
        "id": "21ba5c36a6aaafed",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 330,
        "y": 1040,
        "wires": [
            [
                "f0d0fe83d5e84b44"
            ]
        ]
    },
    {
        "id": "7adad6ac3ea0274c",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 830,
        "y": 980,
        "wires": []
    },
    {
        "id": "f0a1eb69b369a462",
        "type": "json",
        "z": "838c179aeb2a8be9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 690,
        "y": 980,
        "wires": [
            [
                "7adad6ac3ea0274c"
            ]
        ]
    },
    {
        "id": "a515ad678b3cd35c",
        "type": "inject",
        "z": "838c179aeb2a8be9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "x": 110,
        "y": 240,
        "wires": [
            [
                "95d35857694b3549"
            ]
        ]
    },
    {
        "id": "95d35857694b3549",
        "type": "tcp request",
        "z": "838c179aeb2a8be9",
        "server": "192.168.1.155",
        "port": "10500",
        "out": "time",
        "ret": "buffer",
        "splitc": "0",
        "name": "",
        "x": 620,
        "y": 240,
        "wires": [
            [
                "38fdd2e06f56e5b7"
            ]
        ]
    },
    {
        "id": "38fdd2e06f56e5b7",
        "type": "debug",
        "z": "838c179aeb2a8be9",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 850,
        "y": 240,
        "wires": []
    }
]